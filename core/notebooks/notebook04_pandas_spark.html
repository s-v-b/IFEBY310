<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US" xml:lang="en-US"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.42">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Data preprocessing and visualisation of a credit scoring dataset – IFEBY310 - Spring 2025</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script><script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-2f5df379a58b258e96c21c0638c20c03.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-dark-b53751a350365c71b6c909e95f209ed1.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap-65bb2660d2added026bc737f6d61009c.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../../site_libs/bootstrap/bootstrap-dark-7b2e65690087d8706f18962bbef010b2.min.css" rel="prefetch" append-hash="true" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>

<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>


<meta property="og:title" content="Data preprocessing and visualisation of a credit scoring dataset – IFEBY310 - Spring 2025">
<meta property="og:description" content="Homepage for course IFEBY310 - Big Data Technologies, Master MIDS Spring 2025.">
<meta property="og:site_name" content="IFEBY310 - Spring 2025">
</head>

<body class="nav-sidebar docked">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item">Data preprocessing and visualisation of a credit scoring dataset</li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-center sidebar-header">
      <a href="../../index.html" class="sidebar-logo-link">
      <img src="../../images/UniversiteParisCite_logo_horizontal_couleur_RVB.png" alt="" class="sidebar-logo py-0 d-lg-inline d-none">
      </a>
      <div class="sidebar-tools-main tools-wide">
    <a href="https://github.com/s-v-b/IFEBY310" title="GitHub organization" class="quarto-navigation-tool px-1" aria-label="GitHub organization"><i class="bi bi-github"></i></a>
    <div class="dropdown">
      <a href="" title="Moodle" id="quarto-navigation-tool-dropdown-0" class="quarto-navigation-tool dropdown-toggle px-1" data-bs-toggle="dropdown" aria-expanded="false" role="link" aria-label="Moodle"><i class="bi bi-person-fill"></i></a>
      <ul class="dropdown-menu" aria-labelledby="quarto-navigation-tool-dropdown-0">
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://moodle.u-paris.fr/course/view.php?id=28534">
            Discussion forum
            </a>
          </li>
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://moodle.u-paris.fr/course/view.php?id=28534">
            Dépot
            </a>
          </li>
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://moodle.u-paris.fr/course/view.php?id=28534">
            Notes
            </a>
          </li>
      </ul>
    </div>
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="false">
 <span class="menu-text">Information</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Glimpse</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../cours-syllabus.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Syllabus</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../course-team.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Team</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="false">
 <span class="menu-text">Support</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../computing-access.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Computing resources</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../computing-virtualenv.qmd" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Virtual environments</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../computing-jupyter.qmd" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Jupyter</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../quarto-format.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Quarto</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../computing-docker.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Docker</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../slides-listings.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Slides</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../notebooks-listings.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Notebooks</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../projects-listings.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Homeworks</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../weeks-listings.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Journal</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#your-job" id="toc-your-job" class="nav-link active" data-scroll-target="#your-job">Your job</a></li>
  <li><a href="#a-quick-and-easy-but-actually-bad-import" id="toc-a-quick-and-easy-but-actually-bad-import" class="nav-link" data-scroll-target="#a-quick-and-easy-but-actually-bad-import">A quick and easy (but actually bad) import</a>
  <ul class="collapse">
  <li><a href="#lets-assess-what-we-did" id="toc-lets-assess-what-we-did" class="nav-link" data-scroll-target="#lets-assess-what-we-did">Let’s assess what we did</a></li>
  </ul></li>
  <li><a href="#a-closer-look-at-the-import-problems" id="toc-a-closer-look-at-the-import-problems" class="nav-link" data-scroll-target="#a-closer-look-at-the-import-problems">A closer look at the import problems</a>
  <ul class="collapse">
  <li><a href="#the-last-three-columns-are-weird-and-empty" id="toc-the-last-three-columns-are-weird-and-empty" class="nav-link" data-scroll-target="#the-last-three-columns-are-weird-and-empty">The last three columns are weird and empty</a></li>
  <li><a href="#dates-are-actually-str" id="toc-dates-are-actually-str" class="nav-link" data-scroll-target="#dates-are-actually-str">Dates are actually <code>str</code></a></li>
  <li><a href="#there-is-a-lot-of-missing-values" id="toc-there-is-a-lot-of-missing-values" class="nav-link" data-scroll-target="#there-is-a-lot-of-missing-values">There is a lot of missing values</a></li>
  <li><a href="#categorial-features-are-str" id="toc-categorial-features-are-str" class="nav-link" data-scroll-target="#categorial-features-are-str">Categorial features are <code>str</code></a></li>
  <li><a href="#the-annual-net-income-is-imported-as-a-string" id="toc-the-annual-net-income-is-imported-as-a-string" class="nav-link" data-scroll-target="#the-annual-net-income-is-imported-as-a-string">The annual net income is imported as a string</a></li>
  </ul></li>
  <li><a href="#a-correct-import-of-the-data" id="toc-a-correct-import-of-the-data" class="nav-link" data-scroll-target="#a-correct-import-of-the-data">A correct import of the data</a>
  <ul class="collapse">
  <li><a href="#comment-on-file-formats" id="toc-comment-on-file-formats" class="nav-link" data-scroll-target="#comment-on-file-formats">Comment on file formats</a></li>
  <li><a href="#the-net-income-columns-is-very-weird" id="toc-the-net-income-columns-is-very-weird" class="nav-link" data-scroll-target="#the-net-income-columns-is-very-weird">The net income columns is very weird</a></li>
  </ul></li>
  <li><a href="#some-data-visualization-with-pandas-seaborn" id="toc-some-data-visualization-with-pandas-seaborn" class="nav-link" data-scroll-target="#some-data-visualization-with-pandas-seaborn">Some data visualization with <code>pandas</code> + <code>seaborn</code></a></li>
  <li><a href="#final-preparation-of-the-dataset" id="toc-final-preparation-of-the-dataset" class="nav-link" data-scroll-target="#final-preparation-of-the-dataset">Final preparation of the dataset</a>
  <ul class="collapse">
  <li><a href="#creation-of-the-features-matrix" id="toc-creation-of-the-features-matrix" class="nav-link" data-scroll-target="#creation-of-the-features-matrix">Creation of the features matrix</a></li>
  <li><a href="#final-features-matrix" id="toc-final-features-matrix" class="nav-link" data-scroll-target="#final-features-matrix">Final features matrix</a></li>
  <li><a href="#lets-save-the-data-using-pickle" id="toc-lets-save-the-data-using-pickle" class="nav-link" data-scroll-target="#lets-save-the-data-using-pickle">Let’s save the data using <code>pickle</code></a></li>
  </ul></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.com/s-v-b/IFEBY310/edit/main/core/notebooks/notebook04_pandas_spark.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/s-v-b/IFEBY310/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">Data preprocessing and visualisation of a credit scoring dataset</h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button" data-quarto-source-url="https://github.com/s-v-b/IFEBY310/blob/main/core/notebooks/notebook04_pandas_spark.qmd">View Source</a></li></ul></div></div>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>We’ll work on a dataset <code>gro.csv</code> for <strong>credit scoring</strong> that was proposed some years ago as a data challenge on some data challenge website. It is a realistic and somewhat messy dataset that contains a lot of missing values, several types of features (dates, categories, continuous features), so that serious data cleaning and formating is required. This dataset contains the following columns:</p>
<table class="caption-top table">
<colgroup>
<col style="width: 62%">
<col style="width: 37%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Column name</th>
<th style="text-align: left;">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">BirthDate</td>
<td style="text-align: left;">Date of birth of the client</td>
</tr>
<tr class="even">
<td style="text-align: left;">Customer_Open_Date</td>
<td style="text-align: left;">Creation date of the client’s first account at the bank&nbsp;</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Customer_Type</td>
<td style="text-align: left;">Type of client (existing / new)</td>
</tr>
<tr class="even">
<td style="text-align: left;">Educational_Level</td>
<td style="text-align: left;">Highest diploma</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Id_Customer</td>
<td style="text-align: left;">Id of the client</td>
</tr>
<tr class="even">
<td style="text-align: left;">Marital_Status</td>
<td style="text-align: left;">Family situation</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Nb_Of_Products</td>
<td style="text-align: left;">Number of products held by the client</td>
</tr>
<tr class="even">
<td style="text-align: left;">Net_Annual_Income</td>
<td style="text-align: left;">Annual revenue</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Number_Of_Dependant</td>
<td style="text-align: left;">Number of dependents</td>
</tr>
<tr class="even">
<td style="text-align: left;">P_Client</td>
<td style="text-align: left;">Non-disclosed feature</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Prod_Category</td>
<td style="text-align: left;">Product category</td>
</tr>
<tr class="even">
<td style="text-align: left;">Prod_Closed_Date</td>
<td style="text-align: left;">Closing date of the last product</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Prod_Decision_Date</td>
<td style="text-align: left;">Decision date of the last agreement for a financing product</td>
</tr>
<tr class="even">
<td style="text-align: left;">Prod_Sub_Category</td>
<td style="text-align: left;">Sub-category of the product</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Source</td>
<td style="text-align: left;">Financing source (Branch or Sales)</td>
</tr>
<tr class="even">
<td style="text-align: left;">Type_Of_Residence</td>
<td style="text-align: left;">Residential situation</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Y</td>
<td style="text-align: left;">Credit was granted (yes / no)</td>
</tr>
<tr class="even">
<td style="text-align: left;">Years_At_Business</td>
<td style="text-align: left;">Number of year at the current job position</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Years_At_Residence</td>
<td style="text-align: left;">Number of year at the current housing</td>
</tr>
</tbody>
</table>
<section id="your-job" class="level1">
<h1>Your job</h1>
<p>Read the <code>gro.csv</code> dataset and work on it using <code>pandas</code>, <code>matplotlib</code> and <code>seaborn</code>. - The column separator in the CSV file is not <code>,</code> but <code>;</code> so you need to use the <code>sep</code> option in <code>pd.read_csv</code> - The categorical columns must be imported as <code>category</code> type - Something weird is going on with the <code>Net_Annual_Income</code> column… Try to understand what is going on and try to correct the problem - Several columns are empty, we need to remove them (or not even read them) - Dates must be imported as dates and not strings - Remove rows with missing values</p>
<p>Many of these things can be done right from the beginning, when reading the CSV file, through some options to the <code>pd.read_csv</code> function. You might need to read carefully its documentation in order to understand some useful options. Once you are happy with your importation and cleaning of the data, you can: - Use <code>matplotlib</code> and <code>pandas</code> to perform data visualization… - … in order to understand visually the impact of some features on <code>Y</code> (credit was granted or not). For this, you need to decide on the plots that make sense for this and produce them</p>
<p>We will provide thorough explanations and code that performs all of this in subsequent sessions.</p>
</section>
<section id="a-quick-and-easy-but-actually-bad-import" class="level1">
<h1>A quick and easy (but actually bad) import</h1>
<p>Let’s import the data into a pandas dataframe, as simply as possible The only thing we care about for now is the fact that the column separator is <code>';'</code> and not <code>','</code> as it should be in a <code>.csv</code> file.</p>
<div id="2f716d36" class="cell" data-execution_count="1">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> requests</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> os</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="co"># The path containing your notebook</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>path_data <span class="op">=</span> <span class="st">'./'</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="co"># The name of the file</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>filename <span class="op">=</span> <span class="st">'gro.csv.gz'</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> os.path.exists(os.path.join(path_data, filename)):</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">'The file </span><span class="sc">%s</span><span class="st"> already exists.'</span> <span class="op">%</span> os.path.join(path_data, filename))</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="cf">else</span>:</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>    url <span class="op">=</span> <span class="st">'https://stephanegaiffas.github.io/big_data_course/data/gro.csv.gz'</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>    r <span class="op">=</span> requests.get(url)</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">with</span> <span class="bu">open</span>(os.path.join(path_data, filename), <span class="st">'wb'</span>) <span class="im">as</span> f:</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>        f.write(r.content)</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">'Downloaded file </span><span class="sc">%s</span><span class="st">.'</span> <span class="op">%</span> os.path.join(path_data, filename))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Downloaded file ./gro.csv.gz.</code></pre>
</div>
</div>
<div id="1ebff42a" class="cell" data-execution_count="2">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pyspark.pandas <span class="im">as</span> ps</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> pyspark.sql <span class="im">import</span> SparkSession</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>/home/boucheron/sandbox/IFEBY310/.venv/lib/python3.12/site-packages/pyspark/pandas/__init__.py:50: UserWarning:

'PYARROW_IGNORE_TIMEZONE' environment variable was not set. It is required to set this environment variable to '1' in both driver and executor sides if you use pyarrow&gt;=2.0.0. pandas-on-Spark will set it for you but it does not work if there is a Spark context already launched.
</code></pre>
</div>
<div class="cell-output cell-output-error">
<div class="ansi-escaped-output">
<pre><span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">AttributeError</span>                            Traceback (most recent call last)
Cell <span class="ansi-green-fg">In[2], line 3</span>
<span class="ansi-green-fg ansi-bold">      1</span> <span style="font-weight:bold;color:rgb(0,135,0)">import</span> <span style="font-weight:bold;color:rgb(0,0,255)">numpy</span> <span style="font-weight:bold;color:rgb(0,135,0)">as</span> <span style="font-weight:bold;color:rgb(0,0,255)">np</span>
<span class="ansi-green-fg ansi-bold">      2</span> <span style="font-weight:bold;color:rgb(0,135,0)">import</span> <span style="font-weight:bold;color:rgb(0,0,255)">pandas</span> <span style="font-weight:bold;color:rgb(0,135,0)">as</span> <span style="font-weight:bold;color:rgb(0,0,255)">pd</span>
<span class="ansi-green-fg">----&gt; 3</span> <span style="font-weight:bold;color:rgb(0,135,0)">import</span> <span style="font-weight:bold;color:rgb(0,0,255)">pyspark</span><span style="font-weight:bold;color:rgb(0,0,255)">.</span><span style="font-weight:bold;color:rgb(0,0,255)">pandas</span> <span style="font-weight:bold;color:rgb(0,135,0)">as</span> <span style="font-weight:bold;color:rgb(0,0,255)">ps</span>
<span class="ansi-green-fg ansi-bold">      4</span> <span style="font-weight:bold;color:rgb(0,135,0)">from</span> <span style="font-weight:bold;color:rgb(0,0,255)">pyspark</span><span style="font-weight:bold;color:rgb(0,0,255)">.</span><span style="font-weight:bold;color:rgb(0,0,255)">sql</span> <span style="font-weight:bold;color:rgb(0,135,0)">import</span> SparkSession

File <span class="ansi-green-fg">~/sandbox/IFEBY310/.venv/lib/python3.12/site-packages/pyspark/pandas/__init__.py:60</span>
<span class="ansi-green-fg ansi-bold">     57</span>     os<span style="color:rgb(98,98,98)">.</span>environ[<span style="color:rgb(175,0,0)">"</span><span style="color:rgb(175,0,0)">PYARROW_IGNORE_TIMEZONE</span><span style="color:rgb(175,0,0)">"</span>] <span style="color:rgb(98,98,98)">=</span> <span style="color:rgb(175,0,0)">"</span><span style="color:rgb(175,0,0)">1</span><span style="color:rgb(175,0,0)">"</span>
<span class="ansi-green-fg ansi-bold">     59</span> <span style="font-weight:bold;color:rgb(0,135,0)">from</span> <span style="font-weight:bold;color:rgb(0,0,255)">pyspark</span><span style="font-weight:bold;color:rgb(0,0,255)">.</span><span style="font-weight:bold;color:rgb(0,0,255)">pandas</span><span style="font-weight:bold;color:rgb(0,0,255)">.</span><span style="font-weight:bold;color:rgb(0,0,255)">frame</span> <span style="font-weight:bold;color:rgb(0,135,0)">import</span> DataFrame
<span class="ansi-green-fg">---&gt; 60</span> <span style="font-weight:bold;color:rgb(0,135,0)">from</span> <span style="font-weight:bold;color:rgb(0,0,255)">pyspark</span><span style="font-weight:bold;color:rgb(0,0,255)">.</span><span style="font-weight:bold;color:rgb(0,0,255)">pandas</span><span style="font-weight:bold;color:rgb(0,0,255)">.</span><span style="font-weight:bold;color:rgb(0,0,255)">indexes</span><span style="font-weight:bold;color:rgb(0,0,255)">.</span><span style="font-weight:bold;color:rgb(0,0,255)">base</span> <span style="font-weight:bold;color:rgb(0,135,0)">import</span> Index
<span class="ansi-green-fg ansi-bold">     61</span> <span style="font-weight:bold;color:rgb(0,135,0)">from</span> <span style="font-weight:bold;color:rgb(0,0,255)">pyspark</span><span style="font-weight:bold;color:rgb(0,0,255)">.</span><span style="font-weight:bold;color:rgb(0,0,255)">pandas</span><span style="font-weight:bold;color:rgb(0,0,255)">.</span><span style="font-weight:bold;color:rgb(0,0,255)">indexes</span><span style="font-weight:bold;color:rgb(0,0,255)">.</span><span style="font-weight:bold;color:rgb(0,0,255)">category</span> <span style="font-weight:bold;color:rgb(0,135,0)">import</span> CategoricalIndex
<span class="ansi-green-fg ansi-bold">     62</span> <span style="font-weight:bold;color:rgb(0,135,0)">from</span> <span style="font-weight:bold;color:rgb(0,0,255)">pyspark</span><span style="font-weight:bold;color:rgb(0,0,255)">.</span><span style="font-weight:bold;color:rgb(0,0,255)">pandas</span><span style="font-weight:bold;color:rgb(0,0,255)">.</span><span style="font-weight:bold;color:rgb(0,0,255)">indexes</span><span style="font-weight:bold;color:rgb(0,0,255)">.</span><span style="font-weight:bold;color:rgb(0,0,255)">datetimes</span> <span style="font-weight:bold;color:rgb(0,135,0)">import</span> DatetimeIndex

File <span class="ansi-green-fg">~/sandbox/IFEBY310/.venv/lib/python3.12/site-packages/pyspark/pandas/indexes/__init__.py:17</span>
<span class="ansi-green-fg ansi-bold">      1</span> <span style="font-style:italic;color:rgb(95,135,135)">#</span>
<span class="ansi-green-fg ansi-bold">      2</span> <span style="font-style:italic;color:rgb(95,135,135)"># Licensed to the Apache Software Foundation (ASF) under one or more</span>
<span class="ansi-green-fg ansi-bold">      3</span> <span style="font-style:italic;color:rgb(95,135,135)"># contributor license agreements.  See the NOTICE file distributed with</span>
<span class="ansi-green-fg">   (...)</span>
<span class="ansi-green-fg ansi-bold">     15</span> <span style="font-style:italic;color:rgb(95,135,135)"># limitations under the License.</span>
<span class="ansi-green-fg ansi-bold">     16</span> <span style="font-style:italic;color:rgb(95,135,135)">#</span>
<span class="ansi-green-fg">---&gt; 17</span> <span style="font-weight:bold;color:rgb(0,135,0)">from</span> <span style="font-weight:bold;color:rgb(0,0,255)">pyspark</span><span style="font-weight:bold;color:rgb(0,0,255)">.</span><span style="font-weight:bold;color:rgb(0,0,255)">pandas</span><span style="font-weight:bold;color:rgb(0,0,255)">.</span><span style="font-weight:bold;color:rgb(0,0,255)">indexes</span><span style="font-weight:bold;color:rgb(0,0,255)">.</span><span style="font-weight:bold;color:rgb(0,0,255)">base</span> <span style="font-weight:bold;color:rgb(0,135,0)">import</span> Index  <span style="font-style:italic;color:rgb(95,135,135)"># noqa: F401</span>
<span class="ansi-green-fg ansi-bold">     18</span> <span style="font-weight:bold;color:rgb(0,135,0)">from</span> <span style="font-weight:bold;color:rgb(0,0,255)">pyspark</span><span style="font-weight:bold;color:rgb(0,0,255)">.</span><span style="font-weight:bold;color:rgb(0,0,255)">pandas</span><span style="font-weight:bold;color:rgb(0,0,255)">.</span><span style="font-weight:bold;color:rgb(0,0,255)">indexes</span><span style="font-weight:bold;color:rgb(0,0,255)">.</span><span style="font-weight:bold;color:rgb(0,0,255)">datetimes</span> <span style="font-weight:bold;color:rgb(0,135,0)">import</span> DatetimeIndex  <span style="font-style:italic;color:rgb(95,135,135)"># noqa: F401</span>
<span class="ansi-green-fg ansi-bold">     19</span> <span style="font-weight:bold;color:rgb(0,135,0)">from</span> <span style="font-weight:bold;color:rgb(0,0,255)">pyspark</span><span style="font-weight:bold;color:rgb(0,0,255)">.</span><span style="font-weight:bold;color:rgb(0,0,255)">pandas</span><span style="font-weight:bold;color:rgb(0,0,255)">.</span><span style="font-weight:bold;color:rgb(0,0,255)">indexes</span><span style="font-weight:bold;color:rgb(0,0,255)">.</span><span style="font-weight:bold;color:rgb(0,0,255)">multi</span> <span style="font-weight:bold;color:rgb(0,135,0)">import</span> MultiIndex  <span style="font-style:italic;color:rgb(95,135,135)"># noqa: F401</span>

File <span class="ansi-green-fg">~/sandbox/IFEBY310/.venv/lib/python3.12/site-packages/pyspark/pandas/indexes/base.py:66</span>
<span class="ansi-green-fg ansi-bold">     64</span> <span style="font-weight:bold;color:rgb(0,135,0)">from</span> <span style="font-weight:bold;color:rgb(0,0,255)">pyspark</span><span style="font-weight:bold;color:rgb(0,0,255)">.</span><span style="font-weight:bold;color:rgb(0,0,255)">pandas</span><span style="font-weight:bold;color:rgb(0,0,255)">.</span><span style="font-weight:bold;color:rgb(0,0,255)">frame</span> <span style="font-weight:bold;color:rgb(0,135,0)">import</span> DataFrame
<span class="ansi-green-fg ansi-bold">     65</span> <span style="font-weight:bold;color:rgb(0,135,0)">from</span> <span style="font-weight:bold;color:rgb(0,0,255)">pyspark</span><span style="font-weight:bold;color:rgb(0,0,255)">.</span><span style="font-weight:bold;color:rgb(0,0,255)">pandas</span><span style="font-weight:bold;color:rgb(0,0,255)">.</span><span style="font-weight:bold;color:rgb(0,0,255)">missing</span><span style="font-weight:bold;color:rgb(0,0,255)">.</span><span style="font-weight:bold;color:rgb(0,0,255)">indexes</span> <span style="font-weight:bold;color:rgb(0,135,0)">import</span> MissingPandasLikeIndex
<span class="ansi-green-fg">---&gt; 66</span> <span style="font-weight:bold;color:rgb(0,135,0)">from</span> <span style="font-weight:bold;color:rgb(0,0,255)">pyspark</span><span style="font-weight:bold;color:rgb(0,0,255)">.</span><span style="font-weight:bold;color:rgb(0,0,255)">pandas</span><span style="font-weight:bold;color:rgb(0,0,255)">.</span><span style="font-weight:bold;color:rgb(0,0,255)">series</span> <span style="font-weight:bold;color:rgb(0,135,0)">import</span> Series, first_series
<span class="ansi-green-fg ansi-bold">     67</span> <span style="font-weight:bold;color:rgb(0,135,0)">from</span> <span style="font-weight:bold;color:rgb(0,0,255)">pyspark</span><span style="font-weight:bold;color:rgb(0,0,255)">.</span><span style="font-weight:bold;color:rgb(0,0,255)">pandas</span><span style="font-weight:bold;color:rgb(0,0,255)">.</span><span style="font-weight:bold;color:rgb(0,0,255)">spark</span><span style="font-weight:bold;color:rgb(0,0,255)">.</span><span style="font-weight:bold;color:rgb(0,0,255)">accessors</span> <span style="font-weight:bold;color:rgb(0,135,0)">import</span> SparkIndexMethods
<span class="ansi-green-fg ansi-bold">     68</span> <span style="font-weight:bold;color:rgb(0,135,0)">from</span> <span style="font-weight:bold;color:rgb(0,0,255)">pyspark</span><span style="font-weight:bold;color:rgb(0,0,255)">.</span><span style="font-weight:bold;color:rgb(0,0,255)">pandas</span><span style="font-weight:bold;color:rgb(0,0,255)">.</span><span style="font-weight:bold;color:rgb(0,0,255)">utils</span> <span style="font-weight:bold;color:rgb(0,135,0)">import</span> (
<span class="ansi-green-fg ansi-bold">     69</span>     is_name_like_tuple,
<span class="ansi-green-fg ansi-bold">     70</span>     is_name_like_value,
<span class="ansi-green-fg">   (...)</span>
<span class="ansi-green-fg ansi-bold">     78</span>     log_advice,
<span class="ansi-green-fg ansi-bold">     79</span> )

File <span class="ansi-green-fg">~/sandbox/IFEBY310/.venv/lib/python3.12/site-packages/pyspark/pandas/series.py:118</span>
<span class="ansi-green-fg ansi-bold">    116</span> <span style="font-weight:bold;color:rgb(0,135,0)">from</span> <span style="font-weight:bold;color:rgb(0,0,255)">pyspark</span><span style="font-weight:bold;color:rgb(0,0,255)">.</span><span style="font-weight:bold;color:rgb(0,0,255)">pandas</span><span style="font-weight:bold;color:rgb(0,0,255)">.</span><span style="font-weight:bold;color:rgb(0,0,255)">spark</span> <span style="font-weight:bold;color:rgb(0,135,0)">import</span> functions <span style="font-weight:bold;color:rgb(0,135,0)">as</span> SF
<span class="ansi-green-fg ansi-bold">    117</span> <span style="font-weight:bold;color:rgb(0,135,0)">from</span> <span style="font-weight:bold;color:rgb(0,0,255)">pyspark</span><span style="font-weight:bold;color:rgb(0,0,255)">.</span><span style="font-weight:bold;color:rgb(0,0,255)">pandas</span><span style="font-weight:bold;color:rgb(0,0,255)">.</span><span style="font-weight:bold;color:rgb(0,0,255)">spark</span><span style="font-weight:bold;color:rgb(0,0,255)">.</span><span style="font-weight:bold;color:rgb(0,0,255)">accessors</span> <span style="font-weight:bold;color:rgb(0,135,0)">import</span> SparkSeriesMethods
<span class="ansi-green-fg">--&gt; 118</span> <span style="font-weight:bold;color:rgb(0,135,0)">from</span> <span style="font-weight:bold;color:rgb(0,0,255)">pyspark</span><span style="font-weight:bold;color:rgb(0,0,255)">.</span><span style="font-weight:bold;color:rgb(0,0,255)">pandas</span><span style="font-weight:bold;color:rgb(0,0,255)">.</span><span style="font-weight:bold;color:rgb(0,0,255)">strings</span> <span style="font-weight:bold;color:rgb(0,135,0)">import</span> StringMethods
<span class="ansi-green-fg ansi-bold">    119</span> <span style="font-weight:bold;color:rgb(0,135,0)">from</span> <span style="font-weight:bold;color:rgb(0,0,255)">pyspark</span><span style="font-weight:bold;color:rgb(0,0,255)">.</span><span style="font-weight:bold;color:rgb(0,0,255)">pandas</span><span style="font-weight:bold;color:rgb(0,0,255)">.</span><span style="font-weight:bold;color:rgb(0,0,255)">typedef</span> <span style="font-weight:bold;color:rgb(0,135,0)">import</span> (
<span class="ansi-green-fg ansi-bold">    120</span>     infer_return_type,
<span class="ansi-green-fg ansi-bold">    121</span>     spark_type_to_pandas_dtype,
<span class="ansi-green-fg">   (...)</span>
<span class="ansi-green-fg ansi-bold">    124</span>     create_type_for_series_type,
<span class="ansi-green-fg ansi-bold">    125</span> )
<span class="ansi-green-fg ansi-bold">    126</span> <span style="font-weight:bold;color:rgb(0,135,0)">from</span> <span style="font-weight:bold;color:rgb(0,0,255)">pyspark</span><span style="font-weight:bold;color:rgb(0,0,255)">.</span><span style="font-weight:bold;color:rgb(0,0,255)">pandas</span><span style="font-weight:bold;color:rgb(0,0,255)">.</span><span style="font-weight:bold;color:rgb(0,0,255)">typedef</span><span style="font-weight:bold;color:rgb(0,0,255)">.</span><span style="font-weight:bold;color:rgb(0,0,255)">typehints</span> <span style="font-weight:bold;color:rgb(0,135,0)">import</span> as_spark_type

File <span class="ansi-green-fg">~/sandbox/IFEBY310/.venv/lib/python3.12/site-packages/pyspark/pandas/strings.py:44</span>
<span class="ansi-green-fg ansi-bold">     40</span> <span style="font-weight:bold;color:rgb(0,135,0)">import</span> <span style="font-weight:bold;color:rgb(0,0,255)">pyspark</span><span style="font-weight:bold;color:rgb(0,0,255)">.</span><span style="font-weight:bold;color:rgb(0,0,255)">pandas</span> <span style="font-weight:bold;color:rgb(0,135,0)">as</span> <span style="font-weight:bold;color:rgb(0,0,255)">ps</span>
<span class="ansi-green-fg ansi-bold">     41</span> <span style="font-weight:bold;color:rgb(0,135,0)">from</span> <span style="font-weight:bold;color:rgb(0,0,255)">pyspark</span><span style="font-weight:bold;color:rgb(0,0,255)">.</span><span style="font-weight:bold;color:rgb(0,0,255)">pandas</span><span style="font-weight:bold;color:rgb(0,0,255)">.</span><span style="font-weight:bold;color:rgb(0,0,255)">spark</span> <span style="font-weight:bold;color:rgb(0,135,0)">import</span> functions <span style="font-weight:bold;color:rgb(0,135,0)">as</span> SF
<span class="ansi-green-fg">---&gt; 44</span> <span style="font-weight:bold;color:rgb(0,135,0)" class="ansi-yellow-bg">class</span><span class="ansi-yellow-bg"> </span><span style="font-weight:bold;color:rgb(0,0,255)" class="ansi-yellow-bg">StringMethods</span><span class="ansi-yellow-bg">:</span>
<span class="ansi-green-fg ansi-bold">     45</span> <span style="color:rgb(188,188,188)" class="ansi-yellow-bg">    </span><span style="font-style:italic;color:rgb(175,0,0)" class="ansi-yellow-bg">"""String methods for pandas-on-Spark Series"""</span>
<span class="ansi-green-fg ansi-bold">     47</span> <span class="ansi-yellow-bg">    </span><span style="font-weight:bold;color:rgb(0,135,0)" class="ansi-yellow-bg">def</span><span class="ansi-yellow-bg"> </span><span style="color:rgb(0,0,255)" class="ansi-yellow-bg">__init__</span><span class="ansi-yellow-bg">(</span><span style="color:rgb(0,135,0)" class="ansi-yellow-bg">self</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">series</span><span class="ansi-yellow-bg">:</span><span class="ansi-yellow-bg"> </span><span style="color:rgb(175,0,0)" class="ansi-yellow-bg">"</span><span style="color:rgb(175,0,0)" class="ansi-yellow-bg">ps.Series</span><span style="color:rgb(175,0,0)" class="ansi-yellow-bg">"</span><span class="ansi-yellow-bg">)</span><span class="ansi-yellow-bg">:</span>

File <span class="ansi-green-fg">~/sandbox/IFEBY310/.venv/lib/python3.12/site-packages/pyspark/pandas/strings.py:1332</span>, in <span class="ansi-cyan-fg">StringMethods</span><span class="ansi-blue-fg">()</span>
<span class="ansi-green-fg ansi-bold">   1328</span>         <span style="font-weight:bold;color:rgb(0,135,0)">return</span> s<span style="color:rgb(98,98,98)">.</span>str<span style="color:rgb(98,98,98)">.</span>ljust(width, fillchar)
<span class="ansi-green-fg ansi-bold">   1330</span>     <span style="font-weight:bold;color:rgb(0,135,0)">return</span> <span style="color:rgb(0,135,0)">self</span><span style="color:rgb(98,98,98)">.</span>_data<span style="color:rgb(98,98,98)">.</span>pandas_on_spark<span style="color:rgb(98,98,98)">.</span>transform_batch(pandas_ljust)
<span class="ansi-green-fg">-&gt; 1332</span> <span style="font-weight:bold;color:rgb(0,135,0)">def</span> <span style="color:rgb(0,0,255)">match</span>(<span style="color:rgb(0,135,0)">self</span>, pat: <span style="color:rgb(0,135,0)">str</span>, case: <span style="color:rgb(0,135,0)">bool</span> <span style="color:rgb(98,98,98)">=</span> <span style="font-weight:bold;color:rgb(0,135,0)">True</span>, flags: <span style="color:rgb(0,135,0)">int</span> <span style="color:rgb(98,98,98)">=</span> <span style="color:rgb(98,98,98)">0</span>, na: Any <span style="color:rgb(98,98,98)">=</span> <span class="ansi-yellow-bg">np</span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">.</span><span class="ansi-yellow-bg">NaN</span>) <span style="color:rgb(98,98,98)">-</span><span style="color:rgb(98,98,98)">&gt;</span> <span style="color:rgb(175,0,0)">"</span><span style="color:rgb(175,0,0)">ps.Series</span><span style="color:rgb(175,0,0)">"</span>:
<span class="ansi-green-fg ansi-bold">   1333</span> <span style="color:rgb(188,188,188)">    </span><span style="font-style:italic;color:rgb(175,0,0)">"""</span>
<span class="ansi-green-fg ansi-bold">   1334</span> <span style="font-style:italic;color:rgb(175,0,0)">    Determine if each string matches a regular expression.</span>
<span class="ansi-green-fg ansi-bold">   1335</span> 
<span class="ansi-green-fg">   (...)</span>
<span class="ansi-green-fg ansi-bold">   1390</span> <span style="font-style:italic;color:rgb(175,0,0)">    dtype: object</span>
<span class="ansi-green-fg ansi-bold">   1391</span> <span style="font-style:italic;color:rgb(175,0,0)">    """</span>
<span class="ansi-green-fg ansi-bold">   1393</span>     <span style="font-weight:bold;color:rgb(0,135,0)">def</span> <span style="color:rgb(0,0,255)">pandas_match</span>(s) <span style="color:rgb(98,98,98)">-</span><span style="color:rgb(98,98,98)">&gt;</span> ps<span style="color:rgb(98,98,98)">.</span>Series[<span style="color:rgb(0,135,0)">bool</span>]:  <span style="font-style:italic;color:rgb(95,135,135)"># type: ignore[no-untyped-def]</span>

File <span class="ansi-green-fg">~/sandbox/IFEBY310/.venv/lib/python3.12/site-packages/numpy/__init__.py:400</span>, in <span class="ansi-cyan-fg">__getattr__</span><span class="ansi-blue-fg">(attr)</span>
<span class="ansi-green-fg ansi-bold">    397</span>     <span style="font-weight:bold;color:rgb(0,135,0)">raise</span> <span style="font-weight:bold;color:rgb(215,95,95)">AttributeError</span>(__former_attrs__[attr], name<span style="color:rgb(98,98,98)">=</span><span style="font-weight:bold;color:rgb(0,135,0)">None</span>)
<span class="ansi-green-fg ansi-bold">    399</span> <span style="font-weight:bold;color:rgb(0,135,0)">if</span> attr <span style="font-weight:bold;color:rgb(175,0,255)">in</span> __expired_attributes__:
<span class="ansi-green-fg">--&gt; 400</span>     <span style="font-weight:bold;color:rgb(0,135,0)">raise</span> <span style="font-weight:bold;color:rgb(215,95,95)">AttributeError</span>(
<span class="ansi-green-fg ansi-bold">    401</span>         <span style="color:rgb(175,0,0)">f</span><span style="color:rgb(175,0,0)">"</span><span style="color:rgb(175,0,0)">`np.</span><span style="font-weight:bold;color:rgb(175,95,135)">{</span>attr<span style="font-weight:bold;color:rgb(175,95,135)">}</span><span style="color:rgb(175,0,0)">` was removed in the NumPy 2.0 release. </span><span style="color:rgb(175,0,0)">"</span>
<span class="ansi-green-fg ansi-bold">    402</span>         <span style="color:rgb(175,0,0)">f</span><span style="color:rgb(175,0,0)">"</span><span style="font-weight:bold;color:rgb(175,95,135)">{</span>__expired_attributes__[attr]<span style="font-weight:bold;color:rgb(175,95,135)">}</span><span style="color:rgb(175,0,0)">"</span>,
<span class="ansi-green-fg ansi-bold">    403</span>         name<span style="color:rgb(98,98,98)">=</span><span style="font-weight:bold;color:rgb(0,135,0)">None</span>
<span class="ansi-green-fg ansi-bold">    404</span>     )
<span class="ansi-green-fg ansi-bold">    406</span> <span style="font-weight:bold;color:rgb(0,135,0)">if</span> attr <span style="color:rgb(98,98,98)">==</span> <span style="color:rgb(175,0,0)">"</span><span style="color:rgb(175,0,0)">chararray</span><span style="color:rgb(175,0,0)">"</span>:
<span class="ansi-green-fg ansi-bold">    407</span>     warnings<span style="color:rgb(98,98,98)">.</span>warn(
<span class="ansi-green-fg ansi-bold">    408</span>         <span style="color:rgb(175,0,0)">"</span><span style="color:rgb(175,0,0)">`np.chararray` is deprecated and will be removed from </span><span style="color:rgb(175,0,0)">"</span>
<span class="ansi-green-fg ansi-bold">    409</span>         <span style="color:rgb(175,0,0)">"</span><span style="color:rgb(175,0,0)">the main namespace in the future. Use an array with a string </span><span style="color:rgb(175,0,0)">"</span>
<span class="ansi-green-fg ansi-bold">    410</span>         <span style="color:rgb(175,0,0)">"</span><span style="color:rgb(175,0,0)">or bytes dtype instead.</span><span style="color:rgb(175,0,0)">"</span>, <span style="font-weight:bold;color:rgb(215,95,95)">DeprecationWarning</span>, stacklevel<span style="color:rgb(98,98,98)">=</span><span style="color:rgb(98,98,98)">2</span>)

<span class="ansi-red-fg">AttributeError</span>: `np.NaN` was removed in the NumPy 2.0 release. Use `np.nan` instead.</pre>
</div>
</div>
</div>
<div id="3112ce83" class="cell" data-execution_count="3">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>filename <span class="op">=</span> <span class="st">"gro.csv.gz"</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>pdf <span class="op">=</span> pd.read_csv(filename, sep<span class="op">=</span><span class="st">';'</span>)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>pdf.head(n<span class="op">=</span><span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-error">
<div class="ansi-escaped-output">
<pre><span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">BadGzipFile</span>                               Traceback (most recent call last)
Cell <span class="ansi-green-fg">In[3], line 2</span>
<span class="ansi-green-fg ansi-bold">      1</span> filename <span style="color:rgb(98,98,98)">=</span> <span style="color:rgb(175,0,0)">"</span><span style="color:rgb(175,0,0)">gro.csv.gz</span><span style="color:rgb(175,0,0)">"</span>
<span class="ansi-green-fg">----&gt; 2</span> pdf <span style="color:rgb(98,98,98)">=</span> <span class="ansi-yellow-bg">pd</span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">.</span><span class="ansi-yellow-bg">read_csv</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">filename</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">sep</span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">=</span><span style="color:rgb(175,0,0)" class="ansi-yellow-bg">'</span><span style="color:rgb(175,0,0)" class="ansi-yellow-bg">;</span><span style="color:rgb(175,0,0)" class="ansi-yellow-bg">'</span><span class="ansi-yellow-bg">)</span>
<span class="ansi-green-fg ansi-bold">      3</span> pdf<span style="color:rgb(98,98,98)">.</span>head(n<span style="color:rgb(98,98,98)">=</span><span style="color:rgb(98,98,98)">5</span>)

File <span class="ansi-green-fg">~/sandbox/IFEBY310/.venv/lib/python3.12/site-packages/pandas/io/parsers/readers.py:1026</span>, in <span class="ansi-cyan-fg">read_csv</span><span class="ansi-blue-fg">(filepath_or_buffer, sep, delimiter, header, names, index_col, usecols, dtype, engine, converters, true_values, false_values, skipinitialspace, skiprows, skipfooter, nrows, na_values, keep_default_na, na_filter, verbose, skip_blank_lines, parse_dates, infer_datetime_format, keep_date_col, date_parser, date_format, dayfirst, cache_dates, iterator, chunksize, compression, thousands, decimal, lineterminator, quotechar, quoting, doublequote, escapechar, comment, encoding, encoding_errors, dialect, on_bad_lines, delim_whitespace, low_memory, memory_map, float_precision, storage_options, dtype_backend)</span>
<span class="ansi-green-fg ansi-bold">   1013</span> kwds_defaults <span style="color:rgb(98,98,98)">=</span> _refine_defaults_read(
<span class="ansi-green-fg ansi-bold">   1014</span>     dialect,
<span class="ansi-green-fg ansi-bold">   1015</span>     delimiter,
<span class="ansi-green-fg">   (...)</span>
<span class="ansi-green-fg ansi-bold">   1022</span>     dtype_backend<span style="color:rgb(98,98,98)">=</span>dtype_backend,
<span class="ansi-green-fg ansi-bold">   1023</span> )
<span class="ansi-green-fg ansi-bold">   1024</span> kwds<span style="color:rgb(98,98,98)">.</span>update(kwds_defaults)
<span class="ansi-green-fg">-&gt; 1026</span> <span style="font-weight:bold;color:rgb(0,135,0)">return</span> <span class="ansi-yellow-bg">_read</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">filepath_or_buffer</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">kwds</span><span class="ansi-yellow-bg">)</span>

File <span class="ansi-green-fg">~/sandbox/IFEBY310/.venv/lib/python3.12/site-packages/pandas/io/parsers/readers.py:620</span>, in <span class="ansi-cyan-fg">_read</span><span class="ansi-blue-fg">(filepath_or_buffer, kwds)</span>
<span class="ansi-green-fg ansi-bold">    617</span> _validate_names(kwds<span style="color:rgb(98,98,98)">.</span>get(<span style="color:rgb(175,0,0)">"</span><span style="color:rgb(175,0,0)">names</span><span style="color:rgb(175,0,0)">"</span>, <span style="font-weight:bold;color:rgb(0,135,0)">None</span>))
<span class="ansi-green-fg ansi-bold">    619</span> <span style="font-style:italic;color:rgb(95,135,135)"># Create the parser.</span>
<span class="ansi-green-fg">--&gt; 620</span> parser <span style="color:rgb(98,98,98)">=</span> <span class="ansi-yellow-bg">TextFileReader</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">filepath_or_buffer</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">*</span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">*</span><span class="ansi-yellow-bg">kwds</span><span class="ansi-yellow-bg">)</span>
<span class="ansi-green-fg ansi-bold">    622</span> <span style="font-weight:bold;color:rgb(0,135,0)">if</span> chunksize <span style="font-weight:bold;color:rgb(175,0,255)">or</span> iterator:
<span class="ansi-green-fg ansi-bold">    623</span>     <span style="font-weight:bold;color:rgb(0,135,0)">return</span> parser

File <span class="ansi-green-fg">~/sandbox/IFEBY310/.venv/lib/python3.12/site-packages/pandas/io/parsers/readers.py:1620</span>, in <span class="ansi-cyan-fg">TextFileReader.__init__</span><span class="ansi-blue-fg">(self, f, engine, **kwds)</span>
<span class="ansi-green-fg ansi-bold">   1617</span>     <span style="color:rgb(0,135,0)">self</span><span style="color:rgb(98,98,98)">.</span>options[<span style="color:rgb(175,0,0)">"</span><span style="color:rgb(175,0,0)">has_index_names</span><span style="color:rgb(175,0,0)">"</span>] <span style="color:rgb(98,98,98)">=</span> kwds[<span style="color:rgb(175,0,0)">"</span><span style="color:rgb(175,0,0)">has_index_names</span><span style="color:rgb(175,0,0)">"</span>]
<span class="ansi-green-fg ansi-bold">   1619</span> <span style="color:rgb(0,135,0)">self</span><span style="color:rgb(98,98,98)">.</span>handles: IOHandles <span style="color:rgb(98,98,98)">|</span> <span style="font-weight:bold;color:rgb(0,135,0)">None</span> <span style="color:rgb(98,98,98)">=</span> <span style="font-weight:bold;color:rgb(0,135,0)">None</span>
<span class="ansi-green-fg">-&gt; 1620</span> <span style="color:rgb(0,135,0)">self</span><span style="color:rgb(98,98,98)">.</span>_engine <span style="color:rgb(98,98,98)">=</span> <span style="color:rgb(0,135,0)" class="ansi-yellow-bg">self</span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">.</span><span class="ansi-yellow-bg">_make_engine</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">f</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span style="color:rgb(0,135,0)" class="ansi-yellow-bg">self</span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">.</span><span class="ansi-yellow-bg">engine</span><span class="ansi-yellow-bg">)</span>

File <span class="ansi-green-fg">~/sandbox/IFEBY310/.venv/lib/python3.12/site-packages/pandas/io/parsers/readers.py:1898</span>, in <span class="ansi-cyan-fg">TextFileReader._make_engine</span><span class="ansi-blue-fg">(self, f, engine)</span>
<span class="ansi-green-fg ansi-bold">   1895</span>     <span style="font-weight:bold;color:rgb(0,135,0)">raise</span> <span style="font-weight:bold;color:rgb(215,95,95)">ValueError</span>(msg)
<span class="ansi-green-fg ansi-bold">   1897</span> <span style="font-weight:bold;color:rgb(0,135,0)">try</span>:
<span class="ansi-green-fg">-&gt; 1898</span>     <span style="font-weight:bold;color:rgb(0,135,0)">return</span> <span class="ansi-yellow-bg">mapping</span><span class="ansi-yellow-bg">[</span><span class="ansi-yellow-bg">engine</span><span class="ansi-yellow-bg">]</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">f</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">*</span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">*</span><span style="color:rgb(0,135,0)" class="ansi-yellow-bg">self</span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">.</span><span class="ansi-yellow-bg">options</span><span class="ansi-yellow-bg">)</span>
<span class="ansi-green-fg ansi-bold">   1899</span> <span style="font-weight:bold;color:rgb(0,135,0)">except</span> <span style="font-weight:bold;color:rgb(215,95,95)">Exception</span>:
<span class="ansi-green-fg ansi-bold">   1900</span>     <span style="font-weight:bold;color:rgb(0,135,0)">if</span> <span style="color:rgb(0,135,0)">self</span><span style="color:rgb(98,98,98)">.</span>handles <span style="font-weight:bold;color:rgb(175,0,255)">is</span> <span style="font-weight:bold;color:rgb(175,0,255)">not</span> <span style="font-weight:bold;color:rgb(0,135,0)">None</span>:

File <span class="ansi-green-fg">~/sandbox/IFEBY310/.venv/lib/python3.12/site-packages/pandas/io/parsers/c_parser_wrapper.py:93</span>, in <span class="ansi-cyan-fg">CParserWrapper.__init__</span><span class="ansi-blue-fg">(self, src, **kwds)</span>
<span class="ansi-green-fg ansi-bold">     90</span> <span style="font-weight:bold;color:rgb(0,135,0)">if</span> kwds[<span style="color:rgb(175,0,0)">"</span><span style="color:rgb(175,0,0)">dtype_backend</span><span style="color:rgb(175,0,0)">"</span>] <span style="color:rgb(98,98,98)">==</span> <span style="color:rgb(175,0,0)">"</span><span style="color:rgb(175,0,0)">pyarrow</span><span style="color:rgb(175,0,0)">"</span>:
<span class="ansi-green-fg ansi-bold">     91</span>     <span style="font-style:italic;color:rgb(95,135,135)"># Fail here loudly instead of in cython after reading</span>
<span class="ansi-green-fg ansi-bold">     92</span>     import_optional_dependency(<span style="color:rgb(175,0,0)">"</span><span style="color:rgb(175,0,0)">pyarrow</span><span style="color:rgb(175,0,0)">"</span>)
<span class="ansi-green-fg">---&gt; 93</span> <span style="color:rgb(0,135,0)">self</span><span style="color:rgb(98,98,98)">.</span>_reader <span style="color:rgb(98,98,98)">=</span> <span class="ansi-yellow-bg">parsers</span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">.</span><span class="ansi-yellow-bg">TextReader</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">src</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">*</span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">*</span><span class="ansi-yellow-bg">kwds</span><span class="ansi-yellow-bg">)</span>
<span class="ansi-green-fg ansi-bold">     95</span> <span style="color:rgb(0,135,0)">self</span><span style="color:rgb(98,98,98)">.</span>unnamed_cols <span style="color:rgb(98,98,98)">=</span> <span style="color:rgb(0,135,0)">self</span><span style="color:rgb(98,98,98)">.</span>_reader<span style="color:rgb(98,98,98)">.</span>unnamed_cols
<span class="ansi-green-fg ansi-bold">     97</span> <span style="font-style:italic;color:rgb(95,135,135)"># error: Cannot determine type of 'names'</span>

File <span class="ansi-green-fg">parsers.pyx:574</span>, in <span class="ansi-cyan-fg">pandas._libs.parsers.TextReader.__cinit__</span><span class="ansi-blue-fg">()</span>

File <span class="ansi-green-fg">parsers.pyx:663</span>, in <span class="ansi-cyan-fg">pandas._libs.parsers.TextReader._get_header</span><span class="ansi-blue-fg">()</span>

File <span class="ansi-green-fg">parsers.pyx:874</span>, in <span class="ansi-cyan-fg">pandas._libs.parsers.TextReader._tokenize_rows</span><span class="ansi-blue-fg">()</span>

File <span class="ansi-green-fg">parsers.pyx:891</span>, in <span class="ansi-cyan-fg">pandas._libs.parsers.TextReader._check_tokenize_status</span><span class="ansi-blue-fg">()</span>

File <span class="ansi-green-fg">parsers.pyx:2053</span>, in <span class="ansi-cyan-fg">pandas._libs.parsers.raise_parser_error</span><span class="ansi-blue-fg">()</span>

File <span class="ansi-green-fg">/usr/lib/python3.12/gzip.py:337</span>, in <span class="ansi-cyan-fg">GzipFile.read1</span><span class="ansi-blue-fg">(self, size)</span>
<span class="ansi-green-fg ansi-bold">    335</span> <span style="font-weight:bold;color:rgb(0,135,0)">if</span> size <span style="color:rgb(98,98,98)">&lt;</span> <span style="color:rgb(98,98,98)">0</span>:
<span class="ansi-green-fg ansi-bold">    336</span>     size <span style="color:rgb(98,98,98)">=</span> io<span style="color:rgb(98,98,98)">.</span>DEFAULT_BUFFER_SIZE
<span class="ansi-green-fg">--&gt; 337</span> <span style="font-weight:bold;color:rgb(0,135,0)">return</span> <span style="color:rgb(0,135,0)" class="ansi-yellow-bg">self</span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">.</span><span class="ansi-yellow-bg">_buffer</span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">.</span><span class="ansi-yellow-bg">read1</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">size</span><span class="ansi-yellow-bg">)</span>

File <span class="ansi-green-fg">/usr/lib/python3.12/_compression.py:68</span>, in <span class="ansi-cyan-fg">DecompressReader.readinto</span><span class="ansi-blue-fg">(self, b)</span>
<span class="ansi-green-fg ansi-bold">     66</span> <span style="font-weight:bold;color:rgb(0,135,0)">def</span> <span style="color:rgb(0,0,255)">readinto</span>(<span style="color:rgb(0,135,0)">self</span>, b):
<span class="ansi-green-fg ansi-bold">     67</span>     <span style="font-weight:bold;color:rgb(0,135,0)">with</span> <span style="color:rgb(0,135,0)">memoryview</span>(b) <span style="font-weight:bold;color:rgb(0,135,0)">as</span> view, view<span style="color:rgb(98,98,98)">.</span>cast(<span style="color:rgb(175,0,0)">"</span><span style="color:rgb(175,0,0)">B</span><span style="color:rgb(175,0,0)">"</span>) <span style="font-weight:bold;color:rgb(0,135,0)">as</span> byte_view:
<span class="ansi-green-fg">---&gt; 68</span>         data <span style="color:rgb(98,98,98)">=</span> <span style="color:rgb(0,135,0)" class="ansi-yellow-bg">self</span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">.</span><span class="ansi-yellow-bg">read</span><span class="ansi-yellow-bg">(</span><span style="color:rgb(0,135,0)" class="ansi-yellow-bg">len</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">byte_view</span><span class="ansi-yellow-bg">)</span><span class="ansi-yellow-bg">)</span>
<span class="ansi-green-fg ansi-bold">     69</span>         byte_view[:<span style="color:rgb(0,135,0)">len</span>(data)] <span style="color:rgb(98,98,98)">=</span> data
<span class="ansi-green-fg ansi-bold">     70</span>     <span style="font-weight:bold;color:rgb(0,135,0)">return</span> <span style="color:rgb(0,135,0)">len</span>(data)

File <span class="ansi-green-fg">/usr/lib/python3.12/gzip.py:527</span>, in <span class="ansi-cyan-fg">_GzipReader.read</span><span class="ansi-blue-fg">(self, size)</span>
<span class="ansi-green-fg ansi-bold">    523</span> <span style="font-weight:bold;color:rgb(0,135,0)">if</span> <span style="color:rgb(0,135,0)">self</span><span style="color:rgb(98,98,98)">.</span>_new_member:
<span class="ansi-green-fg ansi-bold">    524</span>     <span style="font-style:italic;color:rgb(95,135,135)"># If the _new_member flag is set, we have to</span>
<span class="ansi-green-fg ansi-bold">    525</span>     <span style="font-style:italic;color:rgb(95,135,135)"># jump to the next member, if there is one.</span>
<span class="ansi-green-fg ansi-bold">    526</span>     <span style="color:rgb(0,135,0)">self</span><span style="color:rgb(98,98,98)">.</span>_init_read()
<span class="ansi-green-fg">--&gt; 527</span>     <span style="font-weight:bold;color:rgb(0,135,0)">if</span> <span style="font-weight:bold;color:rgb(175,0,255)">not</span> <span style="color:rgb(0,135,0)" class="ansi-yellow-bg">self</span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">.</span><span class="ansi-yellow-bg">_read_gzip_header</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">)</span>:
<span class="ansi-green-fg ansi-bold">    528</span>         <span style="color:rgb(0,135,0)">self</span><span style="color:rgb(98,98,98)">.</span>_size <span style="color:rgb(98,98,98)">=</span> <span style="color:rgb(0,135,0)">self</span><span style="color:rgb(98,98,98)">.</span>_pos
<span class="ansi-green-fg ansi-bold">    529</span>         <span style="font-weight:bold;color:rgb(0,135,0)">return</span> <span style="color:rgb(175,0,0)">b</span><span style="color:rgb(175,0,0)">"</span><span style="color:rgb(175,0,0)">"</span>

File <span class="ansi-green-fg">/usr/lib/python3.12/gzip.py:496</span>, in <span class="ansi-cyan-fg">_GzipReader._read_gzip_header</span><span class="ansi-blue-fg">(self)</span>
<span class="ansi-green-fg ansi-bold">    495</span> <span style="font-weight:bold;color:rgb(0,135,0)">def</span> <span style="color:rgb(0,0,255)">_read_gzip_header</span>(<span style="color:rgb(0,135,0)">self</span>):
<span class="ansi-green-fg">--&gt; 496</span>     last_mtime <span style="color:rgb(98,98,98)">=</span> <span class="ansi-yellow-bg">_read_gzip_header</span><span class="ansi-yellow-bg">(</span><span style="color:rgb(0,135,0)" class="ansi-yellow-bg">self</span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">.</span><span class="ansi-yellow-bg">_fp</span><span class="ansi-yellow-bg">)</span>
<span class="ansi-green-fg ansi-bold">    497</span>     <span style="font-weight:bold;color:rgb(0,135,0)">if</span> last_mtime <span style="font-weight:bold;color:rgb(175,0,255)">is</span> <span style="font-weight:bold;color:rgb(0,135,0)">None</span>:
<span class="ansi-green-fg ansi-bold">    498</span>         <span style="font-weight:bold;color:rgb(0,135,0)">return</span> <span style="font-weight:bold;color:rgb(0,135,0)">False</span>

File <span class="ansi-green-fg">/usr/lib/python3.12/gzip.py:456</span>, in <span class="ansi-cyan-fg">_read_gzip_header</span><span class="ansi-blue-fg">(fp)</span>
<span class="ansi-green-fg ansi-bold">    453</span>     <span style="font-weight:bold;color:rgb(0,135,0)">return</span> <span style="font-weight:bold;color:rgb(0,135,0)">None</span>
<span class="ansi-green-fg ansi-bold">    455</span> <span style="font-weight:bold;color:rgb(0,135,0)">if</span> magic <span style="color:rgb(98,98,98)">!=</span> <span style="color:rgb(175,0,0)">b</span><span style="color:rgb(175,0,0)">'</span><span style="font-weight:bold;color:rgb(175,95,0)">\037</span><span style="font-weight:bold;color:rgb(175,95,0)">\213</span><span style="color:rgb(175,0,0)">'</span>:
<span class="ansi-green-fg">--&gt; 456</span>     <span style="font-weight:bold;color:rgb(0,135,0)">raise</span> BadGzipFile(<span style="color:rgb(175,0,0)">'</span><span style="color:rgb(175,0,0)">Not a gzipped file (</span><span style="font-weight:bold;color:rgb(175,95,135)">%r</span><span style="color:rgb(175,0,0)">)</span><span style="color:rgb(175,0,0)">'</span> <span style="color:rgb(98,98,98)">%</span> magic)
<span class="ansi-green-fg ansi-bold">    458</span> (method, flag, last_mtime) <span style="color:rgb(98,98,98)">=</span> struct<span style="color:rgb(98,98,98)">.</span>unpack(<span style="color:rgb(175,0,0)">"</span><span style="color:rgb(175,0,0)">&lt;BBIxx</span><span style="color:rgb(175,0,0)">"</span>, _read_exact(fp, <span style="color:rgb(98,98,98)">8</span>))
<span class="ansi-green-fg ansi-bold">    459</span> <span style="font-weight:bold;color:rgb(0,135,0)">if</span> method <span style="color:rgb(98,98,98)">!=</span> <span style="color:rgb(98,98,98)">8</span>:

<span class="ansi-red-fg">BadGzipFile</span>: Not a gzipped file (b'&lt;!')</pre>
</div>
</div>
</div>
<div id="9a56656c" class="cell" data-execution_count="4">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>psdf <span class="op">=</span> ps.from_pandas(pdf)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-error">
<div class="ansi-escaped-output">
<pre><span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">NameError</span>                                 Traceback (most recent call last)
Cell <span class="ansi-green-fg">In[4], line 1</span>
<span class="ansi-green-fg">----&gt; 1</span> psdf <span style="color:rgb(98,98,98)">=</span> <span class="ansi-yellow-bg">ps</span><span style="color:rgb(98,98,98)">.</span>from_pandas(pdf)

<span class="ansi-red-fg">NameError</span>: name 'ps' is not defined</pre>
</div>
</div>
</div>
<div id="a5ba4954" class="cell" data-execution_count="5">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>psdf.columns</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>psdf.info</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>psdf.describe()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-error">
<div class="ansi-escaped-output">
<pre><span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">NameError</span>                                 Traceback (most recent call last)
Cell <span class="ansi-green-fg">In[5], line 1</span>
<span class="ansi-green-fg">----&gt; 1</span> <span class="ansi-yellow-bg">psdf</span><span style="color:rgb(98,98,98)">.</span>columns
<span class="ansi-green-fg ansi-bold">      3</span> psdf<span style="color:rgb(98,98,98)">.</span>info
<span class="ansi-green-fg ansi-bold">      5</span> psdf<span style="color:rgb(98,98,98)">.</span>describe()

<span class="ansi-red-fg">NameError</span>: name 'psdf' is not defined</pre>
</div>
</div>
</div>
<div id="fba03b70" class="cell" data-execution_count="6">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>spark <span class="op">=</span> SparkSession.builder.getOrCreate()</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>sdf <span class="op">=</span> spark.createDataFrame(pdf)</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>sdf.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-error">
<div class="ansi-escaped-output">
<pre><span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">NameError</span>                                 Traceback (most recent call last)
Cell <span class="ansi-green-fg">In[6], line 1</span>
<span class="ansi-green-fg">----&gt; 1</span> spark <span style="color:rgb(98,98,98)">=</span> <span class="ansi-yellow-bg">SparkSession</span><span style="color:rgb(98,98,98)">.</span>builder<span style="color:rgb(98,98,98)">.</span>getOrCreate()
<span class="ansi-green-fg ansi-bold">      3</span> sdf <span style="color:rgb(98,98,98)">=</span> spark<span style="color:rgb(98,98,98)">.</span>createDataFrame(pdf)
<span class="ansi-green-fg ansi-bold">      5</span> sdf<span style="color:rgb(98,98,98)">.</span>show()

<span class="ansi-red-fg">NameError</span>: name 'SparkSession' is not defined</pre>
</div>
</div>
</div>
<p><strong>Remark</strong>. There are weird columns in the end, they look empty. They don’t appear in the description of the data.</p>
<div id="8fa128d6" class="cell" data-execution_count="7">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>psdf.info()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-error">
<div class="ansi-escaped-output">
<pre><span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">NameError</span>                                 Traceback (most recent call last)
Cell <span class="ansi-green-fg">In[7], line 1</span>
<span class="ansi-green-fg">----&gt; 1</span> <span class="ansi-yellow-bg">psdf</span><span style="color:rgb(98,98,98)">.</span>info()

<span class="ansi-red-fg">NameError</span>: name 'psdf' is not defined</pre>
</div>
</div>
</div>
<div id="5a077199" class="cell" data-execution_count="8">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>psdf[<span class="st">"BirthDate"</span>].head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-error">
<div class="ansi-escaped-output">
<pre><span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">NameError</span>                                 Traceback (most recent call last)
Cell <span class="ansi-green-fg">In[8], line 1</span>
<span class="ansi-green-fg">----&gt; 1</span> <span class="ansi-yellow-bg">psdf</span>[<span style="color:rgb(175,0,0)">"</span><span style="color:rgb(175,0,0)">BirthDate</span><span style="color:rgb(175,0,0)">"</span>]<span style="color:rgb(98,98,98)">.</span>head()

<span class="ansi-red-fg">NameError</span>: name 'psdf' is not defined</pre>
</div>
</div>
</div>
<div id="7d758712" class="cell" data-execution_count="9">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="bu">type</span>(psdf.loc[<span class="dv">0</span>, <span class="st">'BirthDate'</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-error">
<div class="ansi-escaped-output">
<pre><span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">NameError</span>                                 Traceback (most recent call last)
Cell <span class="ansi-green-fg">In[9], line 1</span>
<span class="ansi-green-fg">----&gt; 1</span> <span style="color:rgb(0,135,0)">type</span>(<span class="ansi-yellow-bg">psdf</span><span style="color:rgb(98,98,98)">.</span>loc[<span style="color:rgb(98,98,98)">0</span>, <span style="color:rgb(175,0,0)">'</span><span style="color:rgb(175,0,0)">BirthDate</span><span style="color:rgb(175,0,0)">'</span>])

<span class="ansi-red-fg">NameError</span>: name 'psdf' is not defined</pre>
</div>
</div>
</div>
<p>This means that dates are indeed imported as a strings…</p>
<div id="bfdafa5b" class="cell" data-execution_count="10">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>psdf[<span class="st">'Prod_Sub_Category'</span>].head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-error">
<div class="ansi-escaped-output">
<pre><span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">NameError</span>                                 Traceback (most recent call last)
Cell <span class="ansi-green-fg">In[10], line 1</span>
<span class="ansi-green-fg">----&gt; 1</span> <span class="ansi-yellow-bg">psdf</span>[<span style="color:rgb(175,0,0)">'</span><span style="color:rgb(175,0,0)">Prod_Sub_Category</span><span style="color:rgb(175,0,0)">'</span>]<span style="color:rgb(98,98,98)">.</span>head()

<span class="ansi-red-fg">NameError</span>: name 'psdf' is not defined</pre>
</div>
</div>
</div>
<div id="1171eb68" class="cell" data-execution_count="11">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="bu">type</span>(psdf.loc[<span class="dv">0</span>, <span class="st">'Prod_Sub_Category'</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-error">
<div class="ansi-escaped-output">
<pre><span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">NameError</span>                                 Traceback (most recent call last)
Cell <span class="ansi-green-fg">In[11], line 1</span>
<span class="ansi-green-fg">----&gt; 1</span> <span style="color:rgb(0,135,0)">type</span>(<span class="ansi-yellow-bg">psdf</span><span style="color:rgb(98,98,98)">.</span>loc[<span style="color:rgb(98,98,98)">0</span>, <span style="color:rgb(175,0,0)">'</span><span style="color:rgb(175,0,0)">Prod_Sub_Category</span><span style="color:rgb(175,0,0)">'</span>])

<span class="ansi-red-fg">NameError</span>: name 'psdf' is not defined</pre>
</div>
</div>
</div>
<p>Categorical variables are imported as a strings as well</p>
<div id="42230acc" class="cell" data-execution_count="12">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>psdf[<span class="st">'Net_Annual_Income'</span>].head(n<span class="op">=</span><span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-error">
<div class="ansi-escaped-output">
<pre><span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">NameError</span>                                 Traceback (most recent call last)
Cell <span class="ansi-green-fg">In[12], line 1</span>
<span class="ansi-green-fg">----&gt; 1</span> <span class="ansi-yellow-bg">psdf</span>[<span style="color:rgb(175,0,0)">'</span><span style="color:rgb(175,0,0)">Net_Annual_Income</span><span style="color:rgb(175,0,0)">'</span>]<span style="color:rgb(98,98,98)">.</span>head(n<span style="color:rgb(98,98,98)">=</span><span style="color:rgb(98,98,98)">10</span>)

<span class="ansi-red-fg">NameError</span>: name 'psdf' is not defined</pre>
</div>
</div>
</div>
<div id="ed8d8d3f" class="cell" data-execution_count="13">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="bu">type</span>(psdf.loc[<span class="dv">0</span>, <span class="st">'Net_Annual_Income'</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-error">
<div class="ansi-escaped-output">
<pre><span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">NameError</span>                                 Traceback (most recent call last)
Cell <span class="ansi-green-fg">In[13], line 1</span>
<span class="ansi-green-fg">----&gt; 1</span> <span style="color:rgb(0,135,0)">type</span>(<span class="ansi-yellow-bg">psdf</span><span style="color:rgb(98,98,98)">.</span>loc[<span style="color:rgb(98,98,98)">0</span>, <span style="color:rgb(175,0,0)">'</span><span style="color:rgb(175,0,0)">Net_Annual_Income</span><span style="color:rgb(175,0,0)">'</span>])

<span class="ansi-red-fg">NameError</span>: name 'psdf' is not defined</pre>
</div>
</div>
</div>
<p>Net actual income is a string as well ! While it is clearly a number !!!</p>
<p>Caveat: there are slight differences between Pandas API on Spark and Pandas API.</p>
<div id="6441f694" class="cell" data-execution_count="14">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># psdf.describe(include='all')</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="lets-assess-what-we-did" class="level2">
<h2 class="anchored" data-anchor-id="lets-assess-what-we-did">Let’s assess what we did</h2>
<p>It appears that we have to work a little bit more for a correct import of the data. Here is a list of the problems we face. - The last three columns are empty - Dates are actually <code>str</code> (python’s <strong>string</strong> type) - There is a lot of missing values - Categorial features are <code>str</code> - The <code>Net_Annual_Income</code> is imported as a string</p>
<p>By looking at the column names, the descriptions of the columns and using some basic, we infer the type of features that we have. There are dates features, continuous features, categorical features, and some features that could be either treated as categorical or continuous.</p>
<ul>
<li>There are <strong>many</strong> missing values, that need to be handled.</li>
<li>The annual net income is imported as a string, we need to understand why.</li>
<li>We really need to treat dates as dates and not strings (because we want to compute the age of a client based on its birth year for instance).</li>
</ul>
<p>Here is a tentative structure of the features</p>
<p><strong>Continuous features</strong></p>
<ul>
<li><code>Years_At_Residence</code></li>
<li><code>Net_Annual_Income</code></li>
<li><code>Years_At_Business</code></li>
</ul>
<p><strong>Features to be decided</strong></p>
<ul>
<li><code>Number_Of_Dependant</code></li>
<li><code>Nb_Of_Products</code></li>
</ul>
<p><strong>Categorical features</strong></p>
<ul>
<li><code>Customer_Type</code></li>
<li><code>P_Client</code></li>
<li><code>Educational_Level</code></li>
<li><code>Marital_Status</code></li>
<li><code>Prod_Sub_Category</code></li>
<li><code>Source</code></li>
<li><code>Type_Of_Residence</code></li>
<li><code>Prod_Category</code></li>
</ul>
<p><strong>Date features</strong></p>
<ul>
<li><code>BirthDate</code></li>
<li><code>Customer_Open_Date</code></li>
<li><code>Prod_Decision_Date</code></li>
<li><code>Prod_Closed_Date</code></li>
</ul>
</section>
</section>
<section id="a-closer-look-at-the-import-problems" class="level1">
<h1>A closer look at the import problems</h1>
<p>Let’s find solutions to all these import problems.</p>
<section id="the-last-three-columns-are-weird-and-empty" class="level2">
<h2 class="anchored" data-anchor-id="the-last-three-columns-are-weird-and-empty">The last three columns are weird and empty</h2>
<p>It seems to come from the fact that the data always ends with several <code>';'</code> characters. We can remove them simply using the <code>usecols</code> option from <code>read_csv</code>.</p>
</section>
<section id="dates-are-actually-str" class="level2">
<h2 class="anchored" data-anchor-id="dates-are-actually-str">Dates are actually <code>str</code></h2>
<p>We need to specify which columns must be encoded as dates using the <code>parse_dates</code> option from <code>read_csv</code>. Fortunately enough, <code>pandas</code> is clever enough to interpret the date format.</p>
<div id="b8d28875" class="cell" data-execution_count="15">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="bu">type</span>(psdf.loc[<span class="dv">0</span>, <span class="st">'BirthDate'</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-error">
<div class="ansi-escaped-output">
<pre><span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">NameError</span>                                 Traceback (most recent call last)
Cell <span class="ansi-green-fg">In[15], line 1</span>
<span class="ansi-green-fg">----&gt; 1</span> <span style="color:rgb(0,135,0)">type</span>(<span class="ansi-yellow-bg">psdf</span><span style="color:rgb(98,98,98)">.</span>loc[<span style="color:rgb(98,98,98)">0</span>, <span style="color:rgb(175,0,0)">'</span><span style="color:rgb(175,0,0)">BirthDate</span><span style="color:rgb(175,0,0)">'</span>])

<span class="ansi-red-fg">NameError</span>: name 'psdf' is not defined</pre>
</div>
</div>
</div>
</section>
<section id="there-is-a-lot-of-missing-values" class="level2">
<h2 class="anchored" data-anchor-id="there-is-a-lot-of-missing-values">There is a lot of missing values</h2>
<p>We’ll see below that actually a single column mostly contain missing values.</p>
<div id="ceae995b" class="cell" data-execution_count="16">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>psdf.isnull().<span class="bu">sum</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-error">
<div class="ansi-escaped-output">
<pre><span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">NameError</span>                                 Traceback (most recent call last)
Cell <span class="ansi-green-fg">In[16], line 1</span>
<span class="ansi-green-fg">----&gt; 1</span> <span class="ansi-yellow-bg">psdf</span><span style="color:rgb(98,98,98)">.</span>isnull()<span style="color:rgb(98,98,98)">.</span>sum()

<span class="ansi-red-fg">NameError</span>: name 'psdf' is not defined</pre>
</div>
</div>
</div>
<p>The column <code>Prod_Closed_Date</code> contains mostly missing values !</p>
<div id="9716aaac" class="cell" data-execution_count="17">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>psdf[[<span class="st">'Prod_Closed_Date'</span>]].head(<span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-error">
<div class="ansi-escaped-output">
<pre><span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">NameError</span>                                 Traceback (most recent call last)
Cell <span class="ansi-green-fg">In[17], line 1</span>
<span class="ansi-green-fg">----&gt; 1</span> <span class="ansi-yellow-bg">psdf</span>[[<span style="color:rgb(175,0,0)">'</span><span style="color:rgb(175,0,0)">Prod_Closed_Date</span><span style="color:rgb(175,0,0)">'</span>]]<span style="color:rgb(98,98,98)">.</span>head(<span style="color:rgb(98,98,98)">5</span>)

<span class="ansi-red-fg">NameError</span>: name 'psdf' is not defined</pre>
</div>
</div>
</div>
<p>Let’s remove the useless columns and check the remaining missing values</p>
<p>Again there are variations. Keyword <code>inplace</code> is not legal in Pandas API on Spark</p>
<div id="65ca0637" class="cell" data-execution_count="18">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># df.drop(['Prod_Closed_Date', 'Unnamed: 19', </span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="co">#          'Unnamed: 20', 'Unnamed: 21'], axis="columns", inplace=True)</span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>psdf <span class="op">=</span> psdf.drop([<span class="st">'Prod_Closed_Date'</span>, </span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Unnamed: 19'</span>, </span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Unnamed: 20'</span>, </span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Unnamed: 21'</span>], </span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>        axis<span class="op">=</span><span class="st">"columns"</span>)</span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>psdf.head()         </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-error">
<div class="ansi-escaped-output">
<pre><span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">NameError</span>                                 Traceback (most recent call last)
Cell <span class="ansi-green-fg">In[18], line 4</span>
<span class="ansi-green-fg ansi-bold">      1</span> <span style="font-style:italic;color:rgb(95,135,135)"># df.drop(['Prod_Closed_Date', 'Unnamed: 19', </span>
<span class="ansi-green-fg ansi-bold">      2</span> <span style="font-style:italic;color:rgb(95,135,135)">#          'Unnamed: 20', 'Unnamed: 21'], axis="columns", inplace=True)</span>
<span class="ansi-green-fg">----&gt; 4</span> psdf <span style="color:rgb(98,98,98)">=</span> <span class="ansi-yellow-bg">psdf</span><span style="color:rgb(98,98,98)">.</span>drop([<span style="color:rgb(175,0,0)">'</span><span style="color:rgb(175,0,0)">Prod_Closed_Date</span><span style="color:rgb(175,0,0)">'</span>, 
<span class="ansi-green-fg ansi-bold">      5</span>         <span style="color:rgb(175,0,0)">'</span><span style="color:rgb(175,0,0)">Unnamed: 19</span><span style="color:rgb(175,0,0)">'</span>, 
<span class="ansi-green-fg ansi-bold">      6</span>         <span style="color:rgb(175,0,0)">'</span><span style="color:rgb(175,0,0)">Unnamed: 20</span><span style="color:rgb(175,0,0)">'</span>, 
<span class="ansi-green-fg ansi-bold">      7</span>         <span style="color:rgb(175,0,0)">'</span><span style="color:rgb(175,0,0)">Unnamed: 21</span><span style="color:rgb(175,0,0)">'</span>], 
<span class="ansi-green-fg ansi-bold">      8</span>         axis<span style="color:rgb(98,98,98)">=</span><span style="color:rgb(175,0,0)">"</span><span style="color:rgb(175,0,0)">columns</span><span style="color:rgb(175,0,0)">"</span>)
<span class="ansi-green-fg ansi-bold">     10</span> psdf<span style="color:rgb(98,98,98)">.</span>head()         

<span class="ansi-red-fg">NameError</span>: name 'psdf' is not defined</pre>
</div>
</div>
</div>
<p>Let’s display the rows with missing values and let’s highlight them</p>
<div id="43dd6cf6" class="cell" data-execution_count="19">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># psdf[psdf.isnull().any(axis="columns")].style.highlight_null()</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="categorial-features-are-str" class="level2">
<h2 class="anchored" data-anchor-id="categorial-features-are-str">Categorial features are <code>str</code></h2>
<p>We need to say the dtype we want to use for some columns using the <code>dtype</code> option of <code>read_csv</code>.</p>
<div id="6cc874d9" class="cell" data-execution_count="20">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="bu">type</span>(psdf.loc[<span class="dv">0</span>, <span class="st">'Prod_Sub_Category'</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-error">
<div class="ansi-escaped-output">
<pre><span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">NameError</span>                                 Traceback (most recent call last)
Cell <span class="ansi-green-fg">In[20], line 1</span>
<span class="ansi-green-fg">----&gt; 1</span> <span style="color:rgb(0,135,0)">type</span>(<span class="ansi-yellow-bg">psdf</span><span style="color:rgb(98,98,98)">.</span>loc[<span style="color:rgb(98,98,98)">0</span>, <span style="color:rgb(175,0,0)">'</span><span style="color:rgb(175,0,0)">Prod_Sub_Category</span><span style="color:rgb(175,0,0)">'</span>])

<span class="ansi-red-fg">NameError</span>: name 'psdf' is not defined</pre>
</div>
</div>
</div>
<div id="a1e19b51" class="cell" data-execution_count="21">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>psdf[<span class="st">'Prod_Sub_Category'</span>].unique()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-error">
<div class="ansi-escaped-output">
<pre><span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">NameError</span>                                 Traceback (most recent call last)
Cell <span class="ansi-green-fg">In[21], line 1</span>
<span class="ansi-green-fg">----&gt; 1</span> <span class="ansi-yellow-bg">psdf</span>[<span style="color:rgb(175,0,0)">'</span><span style="color:rgb(175,0,0)">Prod_Sub_Category</span><span style="color:rgb(175,0,0)">'</span>]<span style="color:rgb(98,98,98)">.</span>unique()

<span class="ansi-red-fg">NameError</span>: name 'psdf' is not defined</pre>
</div>
</div>
</div>
</section>
<section id="the-annual-net-income-is-imported-as-a-string" class="level2">
<h2 class="anchored" data-anchor-id="the-annual-net-income-is-imported-as-a-string">The annual net income is imported as a string</h2>
<p>This problem comes from the fact that the decimal separator is in European notation: it’s a <code>','</code> and not a <code>'.'</code>, so we need to specify it using the <code>decimal</code> option to <code>read_csv</code>. (Data is French, pardon my French…)</p>
<div id="069514cd" class="cell" data-execution_count="22">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="bu">type</span>(psdf.loc[<span class="dv">0</span>, <span class="st">'Net_Annual_Income'</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-error">
<div class="ansi-escaped-output">
<pre><span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">NameError</span>                                 Traceback (most recent call last)
Cell <span class="ansi-green-fg">In[22], line 1</span>
<span class="ansi-green-fg">----&gt; 1</span> <span style="color:rgb(0,135,0)">type</span>(<span class="ansi-yellow-bg">psdf</span><span style="color:rgb(98,98,98)">.</span>loc[<span style="color:rgb(98,98,98)">0</span>, <span style="color:rgb(175,0,0)">'</span><span style="color:rgb(175,0,0)">Net_Annual_Income</span><span style="color:rgb(175,0,0)">'</span>])

<span class="ansi-red-fg">NameError</span>: name 'psdf' is not defined</pre>
</div>
</div>
</div>
<div id="306a3c2d" class="cell" data-execution_count="23">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>psdf[<span class="st">'Net_Annual_Income'</span>].head(n<span class="op">=</span><span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-error">
<div class="ansi-escaped-output">
<pre><span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">NameError</span>                                 Traceback (most recent call last)
Cell <span class="ansi-green-fg">In[23], line 1</span>
<span class="ansi-green-fg">----&gt; 1</span> <span class="ansi-yellow-bg">psdf</span>[<span style="color:rgb(175,0,0)">'</span><span style="color:rgb(175,0,0)">Net_Annual_Income</span><span style="color:rgb(175,0,0)">'</span>]<span style="color:rgb(98,98,98)">.</span>head(n<span style="color:rgb(98,98,98)">=</span><span style="color:rgb(98,98,98)">10</span>)

<span class="ansi-red-fg">NameError</span>: name 'psdf' is not defined</pre>
</div>
</div>
</div>
</section>
</section>
<section id="a-correct-import-of-the-data" class="level1">
<h1>A correct import of the data</h1>
<ul>
<li>We build a dict that specifies the dtype to use for each column and pass it to <code>read_csv</code> using the <code>dtype</code> option</li>
<li>We also specify the <code>decimal</code>, <code>usecols</code> and <code>parse_dates</code> options</li>
</ul>
<p><strong>Very pro remark.</strong> Some columns could be imported as <code>int</code>. However, <code>pandas</code> (actually its <code>numpy</code>) does not support columns with integer dtype and missing values.</p>
<div id="5ce555fe" class="cell" data-execution_count="24">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Does not work completely</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>gro_dtypes <span class="op">=</span> {</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Years_At_Residence'</span>: np.int64,</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Net_Annual_Income'</span> : np.float64,</span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Years_At_Business'</span>: np.float64,</span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Number_Of_Dependant'</span>: np.float64,</span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Nb_Of_Products'</span>: np.int64,</span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Customer_Type'</span>: <span class="st">'category'</span>,</span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a>    <span class="st">'P_Client'</span>: <span class="st">'category'</span>,</span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Educational_Level'</span>: <span class="st">'category'</span>,</span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Marital_Status'</span>: <span class="st">'category'</span>,</span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Prod_Sub_Category'</span>: <span class="st">'category'</span>,</span>
<span id="cb26-13"><a href="#cb26-13" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Source'</span>: <span class="st">'category'</span>,</span>
<span id="cb26-14"><a href="#cb26-14" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Type_Of_Residence'</span>: <span class="st">'category'</span>,</span>
<span id="cb26-15"><a href="#cb26-15" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Prod_Category'</span>: <span class="st">'category'</span>,</span>
<span id="cb26-16"><a href="#cb26-16" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb26-17"><a href="#cb26-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-18"><a href="#cb26-18" aria-hidden="true" tabindex="-1"></a>pssdf <span class="op">=</span> ps.read_csv(</span>
<span id="cb26-19"><a href="#cb26-19" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Filename</span></span>
<span id="cb26-20"><a href="#cb26-20" aria-hidden="true" tabindex="-1"></a>    <span class="st">"gro.csv.gz"</span>,</span>
<span id="cb26-21"><a href="#cb26-21" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Column separator</span></span>
<span id="cb26-22"><a href="#cb26-22" aria-hidden="true" tabindex="-1"></a>    sep<span class="op">=</span><span class="st">';'</span>,</span>
<span id="cb26-23"><a href="#cb26-23" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Decimal separator</span></span>
<span id="cb26-24"><a href="#cb26-24" aria-hidden="true" tabindex="-1"></a>    decimal<span class="op">=</span><span class="st">','</span>,</span>
<span id="cb26-25"><a href="#cb26-25" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Range of the columns to keep (remove the last three ones)</span></span>
<span id="cb26-26"><a href="#cb26-26" aria-hidden="true" tabindex="-1"></a>    usecols<span class="op">=</span><span class="bu">range</span>(<span class="dv">19</span>),</span>
<span id="cb26-27"><a href="#cb26-27" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Which columns should be parsed as dates</span></span>
<span id="cb26-28"><a href="#cb26-28" aria-hidden="true" tabindex="-1"></a>    <span class="co"># parse_dates=['BirthDate', 'Customer_Open_Date', 'Prod_Decision_Date', </span></span>
<span id="cb26-29"><a href="#cb26-29" aria-hidden="true" tabindex="-1"></a>    <span class="co">#              'Prod_Closed_Date'],</span></span>
<span id="cb26-30"><a href="#cb26-30" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Specify some dtypes</span></span>
<span id="cb26-31"><a href="#cb26-31" aria-hidden="true" tabindex="-1"></a>    dtype<span class="op">=</span>gro_dtypes</span>
<span id="cb26-32"><a href="#cb26-32" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-error">
<div class="ansi-escaped-output">
<pre><span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">NameError</span>                                 Traceback (most recent call last)
Cell <span class="ansi-green-fg">In[24], line 18</span>
<span class="ansi-green-fg ansi-bold">      1</span> <span style="font-style:italic;color:rgb(95,135,135)"># Does not work completely</span>
<span class="ansi-green-fg ansi-bold">      2</span> gro_dtypes <span style="color:rgb(98,98,98)">=</span> {
<span class="ansi-green-fg ansi-bold">      3</span>     <span style="color:rgb(175,0,0)">'</span><span style="color:rgb(175,0,0)">Years_At_Residence</span><span style="color:rgb(175,0,0)">'</span>: np<span style="color:rgb(98,98,98)">.</span>int64,
<span class="ansi-green-fg ansi-bold">      4</span>     <span style="color:rgb(175,0,0)">'</span><span style="color:rgb(175,0,0)">Net_Annual_Income</span><span style="color:rgb(175,0,0)">'</span> : np<span style="color:rgb(98,98,98)">.</span>float64,
<span class="ansi-green-fg">   (...)</span>
<span class="ansi-green-fg ansi-bold">     15</span>     <span style="color:rgb(175,0,0)">'</span><span style="color:rgb(175,0,0)">Prod_Category</span><span style="color:rgb(175,0,0)">'</span>: <span style="color:rgb(175,0,0)">'</span><span style="color:rgb(175,0,0)">category</span><span style="color:rgb(175,0,0)">'</span>,
<span class="ansi-green-fg ansi-bold">     16</span> }
<span class="ansi-green-fg">---&gt; 18</span> pssdf <span style="color:rgb(98,98,98)">=</span> <span class="ansi-yellow-bg">ps</span><span style="color:rgb(98,98,98)">.</span>read_csv(
<span class="ansi-green-fg ansi-bold">     19</span>     <span style="font-style:italic;color:rgb(95,135,135)"># Filename</span>
<span class="ansi-green-fg ansi-bold">     20</span>     <span style="color:rgb(175,0,0)">"</span><span style="color:rgb(175,0,0)">gro.csv.gz</span><span style="color:rgb(175,0,0)">"</span>,
<span class="ansi-green-fg ansi-bold">     21</span>     <span style="font-style:italic;color:rgb(95,135,135)"># Column separator</span>
<span class="ansi-green-fg ansi-bold">     22</span>     sep<span style="color:rgb(98,98,98)">=</span><span style="color:rgb(175,0,0)">'</span><span style="color:rgb(175,0,0)">;</span><span style="color:rgb(175,0,0)">'</span>,
<span class="ansi-green-fg ansi-bold">     23</span>     <span style="font-style:italic;color:rgb(95,135,135)"># Decimal separator</span>
<span class="ansi-green-fg ansi-bold">     24</span>     decimal<span style="color:rgb(98,98,98)">=</span><span style="color:rgb(175,0,0)">'</span><span style="color:rgb(175,0,0)">,</span><span style="color:rgb(175,0,0)">'</span>,
<span class="ansi-green-fg ansi-bold">     25</span>     <span style="font-style:italic;color:rgb(95,135,135)"># Range of the columns to keep (remove the last three ones)</span>
<span class="ansi-green-fg ansi-bold">     26</span>     usecols<span style="color:rgb(98,98,98)">=</span><span style="color:rgb(0,135,0)">range</span>(<span style="color:rgb(98,98,98)">19</span>),
<span class="ansi-green-fg ansi-bold">     27</span>     <span style="font-style:italic;color:rgb(95,135,135)"># Which columns should be parsed as dates</span>
<span class="ansi-green-fg ansi-bold">     28</span>     <span style="font-style:italic;color:rgb(95,135,135)"># parse_dates=['BirthDate', 'Customer_Open_Date', 'Prod_Decision_Date', </span>
<span class="ansi-green-fg ansi-bold">     29</span>     <span style="font-style:italic;color:rgb(95,135,135)">#              'Prod_Closed_Date'],</span>
<span class="ansi-green-fg ansi-bold">     30</span>     <span style="font-style:italic;color:rgb(95,135,135)"># Specify some dtypes</span>
<span class="ansi-green-fg ansi-bold">     31</span>     dtype<span style="color:rgb(98,98,98)">=</span>gro_dtypes
<span class="ansi-green-fg ansi-bold">     32</span> )

<span class="ansi-red-fg">NameError</span>: name 'ps' is not defined</pre>
</div>
</div>
</div>
<div id="615e8744" class="cell" data-execution_count="25">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>pssdf.dtypes</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-error">
<div class="ansi-escaped-output">
<pre><span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">NameError</span>                                 Traceback (most recent call last)
Cell <span class="ansi-green-fg">In[25], line 1</span>
<span class="ansi-green-fg">----&gt; 1</span> <span class="ansi-yellow-bg">pssdf</span><span style="color:rgb(98,98,98)">.</span>dtypes

<span class="ansi-red-fg">NameError</span>: name 'pssdf' is not defined</pre>
</div>
</div>
</div>
<div id="18530e65" class="cell" data-execution_count="26">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>  pssdf</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>    .loc[:, [c <span class="cf">for</span> c <span class="kw">in</span> psdf.columns </span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>               <span class="cf">if</span> (c.endswith(<span class="st">'Date'</span>))]]</span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>    .head()</span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-error">
<div class="ansi-escaped-output">
<pre><span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">NameError</span>                                 Traceback (most recent call last)
Cell <span class="ansi-green-fg">In[26], line 2</span>
<span class="ansi-green-fg ansi-bold">      1</span> (
<span class="ansi-green-fg">----&gt; 2</span>   <span class="ansi-yellow-bg">pssdf</span>
<span class="ansi-green-fg ansi-bold">      3</span>     <span style="color:rgb(98,98,98)">.</span>loc[:, [c <span style="font-weight:bold;color:rgb(0,135,0)">for</span> c <span style="font-weight:bold;color:rgb(175,0,255)">in</span> psdf<span style="color:rgb(98,98,98)">.</span>columns 
<span class="ansi-green-fg ansi-bold">      4</span>                <span style="font-weight:bold;color:rgb(0,135,0)">if</span> (c<span style="color:rgb(98,98,98)">.</span>endswith(<span style="color:rgb(175,0,0)">'</span><span style="color:rgb(175,0,0)">Date</span><span style="color:rgb(175,0,0)">'</span>))]]
<span class="ansi-green-fg ansi-bold">      5</span>     <span style="color:rgb(98,98,98)">.</span>head()
<span class="ansi-green-fg ansi-bold">      6</span> )

<span class="ansi-red-fg">NameError</span>: name 'pssdf' is not defined</pre>
</div>
</div>
</div>
<div id="2669da1d" class="cell" data-execution_count="27">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> c <span class="kw">in</span> pssdf.columns:</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="kw">not</span> c.endswith(<span class="st">'Date'</span>)):</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>        <span class="cf">continue</span></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>    pssdf[c] <span class="op">=</span>ps.to_datetime(pssdf[c], <span class="bu">format</span><span class="op">=</span><span class="st">'</span><span class="sc">%d</span><span class="st">/%m/%Y'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-error">
<div class="ansi-escaped-output">
<pre><span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">NameError</span>                                 Traceback (most recent call last)
Cell <span class="ansi-green-fg">In[27], line 1</span>
<span class="ansi-green-fg">----&gt; 1</span> <span style="font-weight:bold;color:rgb(0,135,0)">for</span> c <span style="font-weight:bold;color:rgb(175,0,255)">in</span> <span class="ansi-yellow-bg">pssdf</span><span style="color:rgb(98,98,98)">.</span>columns:
<span class="ansi-green-fg ansi-bold">      2</span>     <span style="font-weight:bold;color:rgb(0,135,0)">if</span> (<span style="font-weight:bold;color:rgb(175,0,255)">not</span> c<span style="color:rgb(98,98,98)">.</span>endswith(<span style="color:rgb(175,0,0)">'</span><span style="color:rgb(175,0,0)">Date</span><span style="color:rgb(175,0,0)">'</span>)):
<span class="ansi-green-fg ansi-bold">      3</span>         <span style="font-weight:bold;color:rgb(0,135,0)">continue</span>

<span class="ansi-red-fg">NameError</span>: name 'pssdf' is not defined</pre>
</div>
</div>
</div>
<div id="762751ac" class="cell" data-execution_count="28">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>pssdf.dtypes</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-error">
<div class="ansi-escaped-output">
<pre><span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">NameError</span>                                 Traceback (most recent call last)
Cell <span class="ansi-green-fg">In[28], line 1</span>
<span class="ansi-green-fg">----&gt; 1</span> <span class="ansi-yellow-bg">pssdf</span><span style="color:rgb(98,98,98)">.</span>dtypes

<span class="ansi-red-fg">NameError</span>: name 'pssdf' is not defined</pre>
</div>
</div>
</div>
<div id="ce495627" class="cell" data-execution_count="29">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>pssdf.loc[:, [c <span class="cf">for</span> c <span class="kw">in</span> pssdf.columns <span class="cf">if</span> (c.endswith(<span class="st">'Date'</span>))]].head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-error">
<div class="ansi-escaped-output">
<pre><span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">NameError</span>                                 Traceback (most recent call last)
Cell <span class="ansi-green-fg">In[29], line 1</span>
<span class="ansi-green-fg">----&gt; 1</span> <span class="ansi-yellow-bg">pssdf</span><span style="color:rgb(98,98,98)">.</span>loc[:, [c <span style="font-weight:bold;color:rgb(0,135,0)">for</span> c <span style="font-weight:bold;color:rgb(175,0,255)">in</span> pssdf<span style="color:rgb(98,98,98)">.</span>columns <span style="font-weight:bold;color:rgb(0,135,0)">if</span> (c<span style="color:rgb(98,98,98)">.</span>endswith(<span style="color:rgb(175,0,0)">'</span><span style="color:rgb(175,0,0)">Date</span><span style="color:rgb(175,0,0)">'</span>))]]<span style="color:rgb(98,98,98)">.</span>head()

<span class="ansi-red-fg">NameError</span>: name 'pssdf' is not defined</pre>
</div>
</div>
</div>
<div id="56688c0d" class="cell" data-execution_count="30">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>pssdf[<span class="st">'Prod_Sub_Category'</span>].head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-error">
<div class="ansi-escaped-output">
<pre><span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">NameError</span>                                 Traceback (most recent call last)
Cell <span class="ansi-green-fg">In[30], line 1</span>
<span class="ansi-green-fg">----&gt; 1</span> <span class="ansi-yellow-bg">pssdf</span>[<span style="color:rgb(175,0,0)">'</span><span style="color:rgb(175,0,0)">Prod_Sub_Category</span><span style="color:rgb(175,0,0)">'</span>]<span style="color:rgb(98,98,98)">.</span>head()

<span class="ansi-red-fg">NameError</span>: name 'pssdf' is not defined</pre>
</div>
</div>
</div>
<div id="91658749" class="cell" data-execution_count="31">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>truc <span class="op">=</span> pssdf[<span class="st">'Prod_Sub_Category'</span>].head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-error">
<div class="ansi-escaped-output">
<pre><span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">NameError</span>                                 Traceback (most recent call last)
Cell <span class="ansi-green-fg">In[31], line 1</span>
<span class="ansi-green-fg">----&gt; 1</span> truc <span style="color:rgb(98,98,98)">=</span> <span class="ansi-yellow-bg">pssdf</span>[<span style="color:rgb(175,0,0)">'</span><span style="color:rgb(175,0,0)">Prod_Sub_Category</span><span style="color:rgb(175,0,0)">'</span>]<span style="color:rgb(98,98,98)">.</span>head()

<span class="ansi-red-fg">NameError</span>: name 'pssdf' is not defined</pre>
</div>
</div>
</div>
<div id="f4d7d8ad" class="cell" data-execution_count="32">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>pssdf.loc[<span class="dv">0</span>, <span class="st">'BirthDate'</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-error">
<div class="ansi-escaped-output">
<pre><span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">NameError</span>                                 Traceback (most recent call last)
Cell <span class="ansi-green-fg">In[32], line 1</span>
<span class="ansi-green-fg">----&gt; 1</span> <span class="ansi-yellow-bg">pssdf</span><span style="color:rgb(98,98,98)">.</span>loc[<span style="color:rgb(98,98,98)">0</span>, <span style="color:rgb(175,0,0)">'</span><span style="color:rgb(175,0,0)">BirthDate</span><span style="color:rgb(175,0,0)">'</span>]

<span class="ansi-red-fg">NameError</span>: name 'pssdf' is not defined</pre>
</div>
</div>
</div>
<p>Let’s remove <code>Prod_Closed_Date</code> (mostly contains missing values)</p>
<div id="218f37f0" class="cell" data-execution_count="33">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>prod_closed_date <span class="op">=</span> pssdf.pop(<span class="st">'Prod_Closed_Date'</span>)</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>pssdf.shape</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-error">
<div class="ansi-escaped-output">
<pre><span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">NameError</span>                                 Traceback (most recent call last)
Cell <span class="ansi-green-fg">In[33], line 1</span>
<span class="ansi-green-fg">----&gt; 1</span> prod_closed_date <span style="color:rgb(98,98,98)">=</span> <span class="ansi-yellow-bg">pssdf</span><span style="color:rgb(98,98,98)">.</span>pop(<span style="color:rgb(175,0,0)">'</span><span style="color:rgb(175,0,0)">Prod_Closed_Date</span><span style="color:rgb(175,0,0)">'</span>)
<span class="ansi-green-fg ansi-bold">      2</span> pssdf<span style="color:rgb(98,98,98)">.</span>shape

<span class="ansi-red-fg">NameError</span>: name 'pssdf' is not defined</pre>
</div>
</div>
</div>
<p>And remove the remaining rows with missing values</p>
<div id="2fe8ad95" class="cell" data-execution_count="34">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(pssdf.shape)</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>pssdf <span class="op">=</span> pssdf.dropna()</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(pssdf.shape)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-error">
<div class="ansi-escaped-output">
<pre><span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">NameError</span>                                 Traceback (most recent call last)
Cell <span class="ansi-green-fg">In[34], line 1</span>
<span class="ansi-green-fg">----&gt; 1</span> <span style="color:rgb(0,135,0)">print</span>(<span class="ansi-yellow-bg">pssdf</span><span style="color:rgb(98,98,98)">.</span>shape)
<span class="ansi-green-fg ansi-bold">      2</span> pssdf <span style="color:rgb(98,98,98)">=</span> pssdf<span style="color:rgb(98,98,98)">.</span>dropna()
<span class="ansi-green-fg ansi-bold">      3</span> <span style="color:rgb(0,135,0)">print</span>(pssdf<span style="color:rgb(98,98,98)">.</span>shape)

<span class="ansi-red-fg">NameError</span>: name 'pssdf' is not defined</pre>
</div>
</div>
</div>
<div id="b6883df8" class="cell" data-execution_count="35">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Now we save the cleaned dataset into a CSV file</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>pssdf.to_csv(<span class="st">"gro_spark_cleaned.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-error">
<div class="ansi-escaped-output">
<pre><span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">NameError</span>                                 Traceback (most recent call last)
Cell <span class="ansi-green-fg">In[35], line 2</span>
<span class="ansi-green-fg ansi-bold">      1</span> <span style="font-style:italic;color:rgb(95,135,135)"># Now we save the cleaned dataset into a CSV file</span>
<span class="ansi-green-fg">----&gt; 2</span> <span class="ansi-yellow-bg">pssdf</span><span style="color:rgb(98,98,98)">.</span>to_csv(<span style="color:rgb(175,0,0)">"</span><span style="color:rgb(175,0,0)">gro_spark_cleaned.csv</span><span style="color:rgb(175,0,0)">"</span>)

<span class="ansi-red-fg">NameError</span>: name 'pssdf' is not defined</pre>
</div>
</div>
</div>
<div id="f86610f2" class="cell" data-execution_count="36">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="op">!</span>pwd</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a><span class="op">!</span>ls <span class="op">-</span>al gro_<span class="op">*</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>/home/boucheron/sandbox/IFEBY310/core/notebooks
ls: cannot access 'gro_*': No such file or directory</code></pre>
</div>
</div>
<section id="comment-on-file-formats" class="level2">
<h2 class="anchored" data-anchor-id="comment-on-file-formats">Comment on file formats</h2>
<p>You can use other methods starting with <code>.to_XX</code> to save in another format. Here are some main examples</p>
<ul>
<li>OK to use <code>csv</code> for “small” datasets (several MB)</li>
<li>Use <code>pickle</code> for more compressed and faster format (limited to 4GB). It’s the standard binary serialization format of <code>Python</code></li>
<li><code>feather</code> is another fast and lightweight file format for storing data frames. A very popular exchange format.</li>
<li><code>parquet</code> is a format for big distributed data (works nicely with <code>Spark</code>)</li>
</ul>
<p>among several others…</p>
<div id="f70fd19a" class="cell" data-execution_count="37">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="co">#df.to_pickle("gro_cleaned.pkl")</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>pssdf.to_parquet(<span class="st">"gro_cleaned.parquet"</span>)</span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a><span class="co"># pssdf.reset_index().to_feather("gro_cleaned.feather")</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-error">
<div class="ansi-escaped-output">
<pre><span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">NameError</span>                                 Traceback (most recent call last)
Cell <span class="ansi-green-fg">In[37], line 2</span>
<span class="ansi-green-fg ansi-bold">      1</span> <span style="font-style:italic;color:rgb(95,135,135)">#df.to_pickle("gro_cleaned.pkl")</span>
<span class="ansi-green-fg">----&gt; 2</span> <span class="ansi-yellow-bg">pssdf</span><span style="color:rgb(98,98,98)">.</span>to_parquet(<span style="color:rgb(175,0,0)">"</span><span style="color:rgb(175,0,0)">gro_cleaned.parquet</span><span style="color:rgb(175,0,0)">"</span>)
<span class="ansi-green-fg ansi-bold">      3</span> <span style="font-style:italic;color:rgb(95,135,135)"># pssdf.reset_index().to_feather("gro_cleaned.feather")</span>

<span class="ansi-red-fg">NameError</span>: name 'pssdf' is not defined</pre>
</div>
</div>
</div>
<div id="87e6411e" class="cell" data-execution_count="38">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>pssdf.index</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-error">
<div class="ansi-escaped-output">
<pre><span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">NameError</span>                                 Traceback (most recent call last)
Cell <span class="ansi-green-fg">In[38], line 1</span>
<span class="ansi-green-fg">----&gt; 1</span> <span class="ansi-yellow-bg">pssdf</span><span style="color:rgb(98,98,98)">.</span>index

<span class="ansi-red-fg">NameError</span>: name 'pssdf' is not defined</pre>
</div>
</div>
</div>
<p>And you can read again using the corresponding <code>read_XX</code> function</p>
<div id="74d54d3b" class="cell" data-execution_count="39">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>pssdf <span class="op">=</span> ps.read_parquet(<span class="st">"gro_cleaned.parquet"</span>)</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>pssdf.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-error">
<div class="ansi-escaped-output">
<pre><span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">NameError</span>                                 Traceback (most recent call last)
Cell <span class="ansi-green-fg">In[39], line 1</span>
<span class="ansi-green-fg">----&gt; 1</span> pssdf <span style="color:rgb(98,98,98)">=</span> <span class="ansi-yellow-bg">ps</span><span style="color:rgb(98,98,98)">.</span>read_parquet(<span style="color:rgb(175,0,0)">"</span><span style="color:rgb(175,0,0)">gro_cleaned.parquet</span><span style="color:rgb(175,0,0)">"</span>)
<span class="ansi-green-fg ansi-bold">      2</span> pssdf<span style="color:rgb(98,98,98)">.</span>head()

<span class="ansi-red-fg">NameError</span>: name 'ps' is not defined</pre>
</div>
</div>
</div>
<div id="d6a3003c" class="cell" data-execution_count="40">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="op">!</span>ls <span class="op">-</span>alh gro_cleaned<span class="op">*</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>ls: cannot access 'gro_cleaned*': No such file or directory</code></pre>
</div>
</div>
</section>
<section id="the-net-income-columns-is-very-weird" class="level2">
<h2 class="anchored" data-anchor-id="the-net-income-columns-is-very-weird">The net income columns is very weird</h2>
<div id="ee9c98d6" class="cell" data-execution_count="41">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>income <span class="op">=</span> pssdf[<span class="st">'Net_Annual_Income'</span>]</span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>income.describe()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-error">
<div class="ansi-escaped-output">
<pre><span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">NameError</span>                                 Traceback (most recent call last)
Cell <span class="ansi-green-fg">In[41], line 1</span>
<span class="ansi-green-fg">----&gt; 1</span> income <span style="color:rgb(98,98,98)">=</span> <span class="ansi-yellow-bg">pssdf</span>[<span style="color:rgb(175,0,0)">'</span><span style="color:rgb(175,0,0)">Net_Annual_Income</span><span style="color:rgb(175,0,0)">'</span>]
<span class="ansi-green-fg ansi-bold">      2</span> income<span style="color:rgb(98,98,98)">.</span>describe()

<span class="ansi-red-fg">NameError</span>: name 'pssdf' is not defined</pre>
</div>
</div>
</div>
<div id="5cbeffb2" class="cell" data-execution_count="42">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>(income <span class="op">&lt;=</span> <span class="dv">100</span>).<span class="bu">sum</span>(), (income <span class="op">&gt;</span> <span class="dv">100</span>).<span class="bu">sum</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-error">
<div class="ansi-escaped-output">
<pre><span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">NameError</span>                                 Traceback (most recent call last)
Cell <span class="ansi-green-fg">In[42], line 1</span>
<span class="ansi-green-fg">----&gt; 1</span> (<span class="ansi-yellow-bg">income</span> <span style="color:rgb(98,98,98)">&lt;</span><span style="color:rgb(98,98,98)">=</span> <span style="color:rgb(98,98,98)">100</span>)<span style="color:rgb(98,98,98)">.</span>sum(), (income <span style="color:rgb(98,98,98)">&gt;</span> <span style="color:rgb(98,98,98)">100</span>)<span style="color:rgb(98,98,98)">.</span>sum()

<span class="ansi-red-fg">NameError</span>: name 'income' is not defined</pre>
</div>
</div>
</div>
<p>Most values are smaller than 100, while some are much much larger…</p>
<div id="90e0f02c" class="cell" data-execution_count="43">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a><span class="op">%</span>matplotlib inline</span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a>sns.set_context(<span class="st">"notebook"</span>, font_scale<span class="op">=</span><span class="fl">1.2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div id="d13619ab" class="cell" data-execution_count="44">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>sns.displot(x<span class="op">=</span><span class="st">'Net_Annual_Income'</span>, </span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>            data<span class="op">=</span>pssdf, </span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>            bins<span class="op">=</span><span class="dv">20</span>,</span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>            height<span class="op">=</span><span class="dv">4</span>, </span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a>            aspect<span class="op">=</span><span class="fl">1.5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div id="ff324d4c" class="cell" data-execution_count="45">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>pssdf[<span class="st">"Net_Annual_Income"</span>].plot.hist(bins<span class="op">=</span><span class="dv">40</span>, </span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>hitsnorm<span class="op">=</span><span class="st">'density'</span>, log_x<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-error">
<div class="ansi-escaped-output">
<pre><span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">NameError</span>                                 Traceback (most recent call last)
Cell <span class="ansi-green-fg">In[43], line 1</span>
<span class="ansi-green-fg">----&gt; 1</span> <span class="ansi-yellow-bg">pssdf</span>[<span style="color:rgb(175,0,0)">"</span><span style="color:rgb(175,0,0)">Net_Annual_Income</span><span style="color:rgb(175,0,0)">"</span>]<span style="color:rgb(98,98,98)">.</span>plot<span style="color:rgb(98,98,98)">.</span>hist(bins<span style="color:rgb(98,98,98)">=</span><span style="color:rgb(98,98,98)">40</span>, 
<span class="ansi-green-fg ansi-bold">      2</span> hitsnorm<span style="color:rgb(98,98,98)">=</span><span style="color:rgb(175,0,0)">'</span><span style="color:rgb(175,0,0)">density</span><span style="color:rgb(175,0,0)">'</span>, log_x<span style="color:rgb(98,98,98)">=</span><span style="font-weight:bold;color:rgb(0,135,0)">True</span>)

<span class="ansi-red-fg">NameError</span>: name 'pssdf' is not defined</pre>
</div>
</div>
</div>
<div id="a7609619" class="cell" data-execution_count="46">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>pssdf[<span class="st">"Net_Annual_Income"</span>].plot.kde(bw_method<span class="op">=</span><span class="dv">10</span>, log_x<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-error">
<div class="ansi-escaped-output">
<pre><span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">NameError</span>                                 Traceback (most recent call last)
Cell <span class="ansi-green-fg">In[44], line 1</span>
<span class="ansi-green-fg">----&gt; 1</span> <span class="ansi-yellow-bg">pssdf</span>[<span style="color:rgb(175,0,0)">"</span><span style="color:rgb(175,0,0)">Net_Annual_Income</span><span style="color:rgb(175,0,0)">"</span>]<span style="color:rgb(98,98,98)">.</span>plot<span style="color:rgb(98,98,98)">.</span>kde(bw_method<span style="color:rgb(98,98,98)">=</span><span style="color:rgb(98,98,98)">10</span>, log_x<span style="color:rgb(98,98,98)">=</span><span style="font-weight:bold;color:rgb(0,135,0)">True</span>)

<span class="ansi-red-fg">NameError</span>: name 'pssdf' is not defined</pre>
</div>
</div>
</div>
<p>This is annoying, we don’t really see much…</p>
<div id="409ca04b" class="cell" data-execution_count="47">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>sns.displot(x<span class="op">=</span><span class="st">'Net_Annual_Income'</span>, </span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>            data<span class="op">=</span>pssdf, </span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>            bins<span class="op">=</span><span class="dv">20</span>, </span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a>            height<span class="op">=</span><span class="dv">4</span>, </span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a>            aspect<span class="op">=</span><span class="fl">1.5</span>, </span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a>            log_scale<span class="op">=</span>(<span class="va">False</span>, <span class="va">True</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Distribution for less than 100K revenue</p>
<div id="806564a7" class="cell" data-execution_count="48">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>sns.displot(x<span class="op">=</span><span class="st">'Net_Annual_Income'</span>, </span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>            data<span class="op">=</span>pssdf[pssdf[<span class="st">'Net_Annual_Income'</span>] <span class="op">&lt;</span> <span class="dv">100</span>], </span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>            bins<span class="op">=</span><span class="dv">15</span>, </span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a>            height<span class="op">=</span><span class="dv">4</span>, </span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a>            aspect<span class="op">=</span><span class="fl">1.5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Distribution for less than 400K revenue</p>
<div id="13ff9597" class="cell" data-execution_count="49">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>sns.displot(x<span class="op">=</span><span class="st">'Net_Annual_Income'</span>, data<span class="op">=</span>pssdf[pssdf[<span class="st">'Net_Annual_Income'</span>] <span class="op">&lt;</span> <span class="dv">400</span>], </span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>            bins<span class="op">=</span><span class="dv">15</span>, height<span class="op">=</span><span class="dv">4</span>, aspect<span class="op">=</span><span class="fl">1.5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div id="9494209f" class="cell" data-execution_count="50">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>(pssdf[<span class="st">'Net_Annual_Income'</span>] <span class="op">==</span> <span class="fl">36.0</span>).<span class="bu">sum</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-error">
<div class="ansi-escaped-output">
<pre><span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">NameError</span>                                 Traceback (most recent call last)
Cell <span class="ansi-green-fg">In[45], line 1</span>
<span class="ansi-green-fg">----&gt; 1</span> (<span class="ansi-yellow-bg">pssdf</span>[<span style="color:rgb(175,0,0)">'</span><span style="color:rgb(175,0,0)">Net_Annual_Income</span><span style="color:rgb(175,0,0)">'</span>] <span style="color:rgb(98,98,98)">==</span> <span style="color:rgb(98,98,98)">36.0</span>)<span style="color:rgb(98,98,98)">.</span>sum()

<span class="ansi-red-fg">NameError</span>: name 'pssdf' is not defined</pre>
</div>
</div>
</div>
<div id="8a5bf2ad" class="cell" data-execution_count="51">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>income_counts <span class="op">=</span> (</span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>    ps.DataFrame({</span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a>        <span class="st">"income_category"</span>: pssdf[<span class="st">'Net_Annual_Income'</span>].astype(<span class="st">"category"</span>),</span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a>        <span class="st">"income"</span>: pssdf[<span class="st">'Net_Annual_Income'</span>]</span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a>    })</span>
<span id="cb55-6"><a href="#cb55-6" aria-hidden="true" tabindex="-1"></a>    .groupby(<span class="st">"income_category"</span>)</span>
<span id="cb55-7"><a href="#cb55-7" aria-hidden="true" tabindex="-1"></a>    .count()</span>
<span id="cb55-8"><a href="#cb55-8" aria-hidden="true" tabindex="-1"></a>    .reset_index()</span>
<span id="cb55-9"><a href="#cb55-9" aria-hidden="true" tabindex="-1"></a>    .rename(columns<span class="op">=</span>{<span class="st">"income"</span>: <span class="st">"#customers"</span>})</span>
<span id="cb55-10"><a href="#cb55-10" aria-hidden="true" tabindex="-1"></a>    .sort_values(by<span class="op">=</span><span class="st">"#customers"</span>, axis<span class="op">=</span><span class="st">"index"</span>, ascending<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb55-11"><a href="#cb55-11" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-error">
<div class="ansi-escaped-output">
<pre><span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">NameError</span>                                 Traceback (most recent call last)
Cell <span class="ansi-green-fg">In[46], line 2</span>
<span class="ansi-green-fg ansi-bold">      1</span> income_counts <span style="color:rgb(98,98,98)">=</span> (
<span class="ansi-green-fg">----&gt; 2</span>     <span class="ansi-yellow-bg">ps</span><span style="color:rgb(98,98,98)">.</span>DataFrame({
<span class="ansi-green-fg ansi-bold">      3</span>         <span style="color:rgb(175,0,0)">"</span><span style="color:rgb(175,0,0)">income_category</span><span style="color:rgb(175,0,0)">"</span>: pssdf[<span style="color:rgb(175,0,0)">'</span><span style="color:rgb(175,0,0)">Net_Annual_Income</span><span style="color:rgb(175,0,0)">'</span>]<span style="color:rgb(98,98,98)">.</span>astype(<span style="color:rgb(175,0,0)">"</span><span style="color:rgb(175,0,0)">category</span><span style="color:rgb(175,0,0)">"</span>),
<span class="ansi-green-fg ansi-bold">      4</span>         <span style="color:rgb(175,0,0)">"</span><span style="color:rgb(175,0,0)">income</span><span style="color:rgb(175,0,0)">"</span>: pssdf[<span style="color:rgb(175,0,0)">'</span><span style="color:rgb(175,0,0)">Net_Annual_Income</span><span style="color:rgb(175,0,0)">'</span>]
<span class="ansi-green-fg ansi-bold">      5</span>     })
<span class="ansi-green-fg ansi-bold">      6</span>     <span style="color:rgb(98,98,98)">.</span>groupby(<span style="color:rgb(175,0,0)">"</span><span style="color:rgb(175,0,0)">income_category</span><span style="color:rgb(175,0,0)">"</span>)
<span class="ansi-green-fg ansi-bold">      7</span>     <span style="color:rgb(98,98,98)">.</span>count()
<span class="ansi-green-fg ansi-bold">      8</span>     <span style="color:rgb(98,98,98)">.</span>reset_index()
<span class="ansi-green-fg ansi-bold">      9</span>     <span style="color:rgb(98,98,98)">.</span>rename(columns<span style="color:rgb(98,98,98)">=</span>{<span style="color:rgb(175,0,0)">"</span><span style="color:rgb(175,0,0)">income</span><span style="color:rgb(175,0,0)">"</span>: <span style="color:rgb(175,0,0)">"</span><span style="color:rgb(175,0,0)">#customers</span><span style="color:rgb(175,0,0)">"</span>})
<span class="ansi-green-fg ansi-bold">     10</span>     <span style="color:rgb(98,98,98)">.</span>sort_values(by<span style="color:rgb(98,98,98)">=</span><span style="color:rgb(175,0,0)">"</span><span style="color:rgb(175,0,0)">#customers</span><span style="color:rgb(175,0,0)">"</span>, axis<span style="color:rgb(98,98,98)">=</span><span style="color:rgb(175,0,0)">"</span><span style="color:rgb(175,0,0)">index</span><span style="color:rgb(175,0,0)">"</span>, ascending<span style="color:rgb(98,98,98)">=</span><span style="font-weight:bold;color:rgb(0,135,0)">False</span>)
<span class="ansi-green-fg ansi-bold">     11</span> )

<span class="ansi-red-fg">NameError</span>: name 'ps' is not defined</pre>
</div>
</div>
</div>
<div id="ee3ad25f" class="cell" data-execution_count="52">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>income_counts[<span class="st">"</span><span class="sc">%c</span><span class="st">ummulative clients"</span>] <span class="op">\</span></span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>    <span class="op">=</span> income_counts[<span class="st">"#customers"</span>].cumsum() <span class="op">/</span> income_counts[<span class="st">"#customers"</span>].<span class="bu">sum</span>()</span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a>income_counts.iloc[:<span class="dv">20</span>].style.bar(subset<span class="op">=</span>[<span class="st">"</span><span class="sc">%c</span><span class="st">ummulative clients"</span>], vmin<span class="op">=</span><span class="dv">0</span>, vmax<span class="op">=</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-error">
<div class="ansi-escaped-output">
<pre><span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">NameError</span>                                 Traceback (most recent call last)
Cell <span class="ansi-green-fg">In[47], line 2</span>
<span class="ansi-green-fg ansi-bold">      1</span> income_counts[<span style="color:rgb(175,0,0)">"</span><span style="font-weight:bold;color:rgb(175,95,135)">%c</span><span style="color:rgb(175,0,0)">ummulative clients</span><span style="color:rgb(175,0,0)">"</span>] \
<span class="ansi-green-fg">----&gt; 2</span>     <span style="color:rgb(98,98,98)">=</span> <span class="ansi-yellow-bg">income_counts</span>[<span style="color:rgb(175,0,0)">"</span><span style="color:rgb(175,0,0)">#customers</span><span style="color:rgb(175,0,0)">"</span>]<span style="color:rgb(98,98,98)">.</span>cumsum() <span style="color:rgb(98,98,98)">/</span> income_counts[<span style="color:rgb(175,0,0)">"</span><span style="color:rgb(175,0,0)">#customers</span><span style="color:rgb(175,0,0)">"</span>]<span style="color:rgb(98,98,98)">.</span>sum()
<span class="ansi-green-fg ansi-bold">      4</span> income_counts<span style="color:rgb(98,98,98)">.</span>iloc[:<span style="color:rgb(98,98,98)">20</span>]<span style="color:rgb(98,98,98)">.</span>style<span style="color:rgb(98,98,98)">.</span>bar(subset<span style="color:rgb(98,98,98)">=</span>[<span style="color:rgb(175,0,0)">"</span><span style="font-weight:bold;color:rgb(175,95,135)">%c</span><span style="color:rgb(175,0,0)">ummulative clients</span><span style="color:rgb(175,0,0)">"</span>], vmin<span style="color:rgb(98,98,98)">=</span><span style="color:rgb(98,98,98)">0</span>, vmax<span style="color:rgb(98,98,98)">=</span><span style="color:rgb(98,98,98)">1</span>)

<span class="ansi-red-fg">NameError</span>: name 'income_counts' is not defined</pre>
</div>
</div>
</div>
<ul>
<li>We have some overrepresented values (many possible explanations for this)</li>
<li>To clean the data, we can, for instance, keep only the revenues between [10, 200], or leave it as such</li>
</ul>
<div id="fb68e5fd" class="cell" data-execution_count="53">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> df[(df[<span class="st">'Net_Annual_Income'</span>] <span class="op">&gt;=</span> <span class="dv">10</span>) <span class="op">&amp;</span> (df[<span class="st">'Net_Annual_Income'</span>] <span class="op">&lt;=</span> <span class="dv">200</span>)]</span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a>sns.displot(x<span class="op">=</span><span class="st">'Net_Annual_Income'</span>, data<span class="op">=</span>df, bins<span class="op">=</span><span class="dv">15</span>, height<span class="op">=</span><span class="dv">4</span>, aspect<span class="op">=</span><span class="fl">1.5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
<section id="some-data-visualization-with-pandas-seaborn" class="level1">
<h1>Some data visualization with <code>pandas</code> + <code>seaborn</code></h1>
<div id="d410a830" class="cell" data-execution_count="54">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">8</span>, <span class="dv">5</span>))</span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>sns.stripplot(x<span class="op">=</span><span class="st">'Educational_Level'</span>, </span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>              y<span class="op">=</span><span class="st">'Net_Annual_Income'</span>, </span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a>              hue<span class="op">=</span><span class="st">'Y'</span>, </span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a>              jitter<span class="op">=</span><span class="va">True</span>, </span>
<span id="cb58-6"><a href="#cb58-6" aria-hidden="true" tabindex="-1"></a>              data<span class="op">=</span>df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-error">
<div class="ansi-escaped-output">
<pre><span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">NameError</span>                                 Traceback (most recent call last)
Cell <span class="ansi-green-fg">In[48], line 1</span>
<span class="ansi-green-fg">----&gt; 1</span> <span class="ansi-yellow-bg">plt</span><span style="color:rgb(98,98,98)">.</span>figure(figsize<span style="color:rgb(98,98,98)">=</span>(<span style="color:rgb(98,98,98)">8</span>, <span style="color:rgb(98,98,98)">5</span>))
<span class="ansi-green-fg ansi-bold">      2</span> sns<span style="color:rgb(98,98,98)">.</span>stripplot(x<span style="color:rgb(98,98,98)">=</span><span style="color:rgb(175,0,0)">'</span><span style="color:rgb(175,0,0)">Educational_Level</span><span style="color:rgb(175,0,0)">'</span>, 
<span class="ansi-green-fg ansi-bold">      3</span>               y<span style="color:rgb(98,98,98)">=</span><span style="color:rgb(175,0,0)">'</span><span style="color:rgb(175,0,0)">Net_Annual_Income</span><span style="color:rgb(175,0,0)">'</span>, 
<span class="ansi-green-fg ansi-bold">      4</span>               hue<span style="color:rgb(98,98,98)">=</span><span style="color:rgb(175,0,0)">'</span><span style="color:rgb(175,0,0)">Y</span><span style="color:rgb(175,0,0)">'</span>, 
<span class="ansi-green-fg ansi-bold">      5</span>               jitter<span style="color:rgb(98,98,98)">=</span><span style="font-weight:bold;color:rgb(0,135,0)">True</span>, 
<span class="ansi-green-fg ansi-bold">      6</span>               data<span style="color:rgb(98,98,98)">=</span>df)

<span class="ansi-red-fg">NameError</span>: name 'plt' is not defined</pre>
</div>
</div>
</div>
<div id="a4cc2dc6" class="cell" data-execution_count="55">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">12</span>, <span class="dv">6</span>))</span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>sns.boxplot(x<span class="op">=</span><span class="st">'Educational_Level'</span>, y<span class="op">=</span><span class="st">'Net_Annual_Income'</span>, </span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a>            hue<span class="op">=</span><span class="st">'Y'</span>, data<span class="op">=</span>df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-error">
<div class="ansi-escaped-output">
<pre><span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">NameError</span>                                 Traceback (most recent call last)
Cell <span class="ansi-green-fg">In[49], line 1</span>
<span class="ansi-green-fg">----&gt; 1</span> <span class="ansi-yellow-bg">plt</span><span style="color:rgb(98,98,98)">.</span>figure(figsize<span style="color:rgb(98,98,98)">=</span>(<span style="color:rgb(98,98,98)">12</span>, <span style="color:rgb(98,98,98)">6</span>))
<span class="ansi-green-fg ansi-bold">      2</span> sns<span style="color:rgb(98,98,98)">.</span>boxplot(x<span style="color:rgb(98,98,98)">=</span><span style="color:rgb(175,0,0)">'</span><span style="color:rgb(175,0,0)">Educational_Level</span><span style="color:rgb(175,0,0)">'</span>, y<span style="color:rgb(98,98,98)">=</span><span style="color:rgb(175,0,0)">'</span><span style="color:rgb(175,0,0)">Net_Annual_Income</span><span style="color:rgb(175,0,0)">'</span>, 
<span class="ansi-green-fg ansi-bold">      3</span>             hue<span style="color:rgb(98,98,98)">=</span><span style="color:rgb(175,0,0)">'</span><span style="color:rgb(175,0,0)">Y</span><span style="color:rgb(175,0,0)">'</span>, data<span style="color:rgb(98,98,98)">=</span>df)

<span class="ansi-red-fg">NameError</span>: name 'plt' is not defined</pre>
</div>
</div>
</div>
<div id="f71fb2b0" class="cell" data-execution_count="56">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">12</span>, <span class="dv">6</span>))</span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>sns.violinplot(x<span class="op">=</span><span class="st">'Marital_Status'</span>, y<span class="op">=</span><span class="st">'Net_Annual_Income'</span>, </span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a>               hue<span class="op">=</span><span class="st">'Y'</span>, split<span class="op">=</span><span class="va">True</span>, data<span class="op">=</span>df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-error">
<div class="ansi-escaped-output">
<pre><span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">NameError</span>                                 Traceback (most recent call last)
Cell <span class="ansi-green-fg">In[50], line 1</span>
<span class="ansi-green-fg">----&gt; 1</span> <span class="ansi-yellow-bg">plt</span><span style="color:rgb(98,98,98)">.</span>figure(figsize<span style="color:rgb(98,98,98)">=</span>(<span style="color:rgb(98,98,98)">12</span>, <span style="color:rgb(98,98,98)">6</span>))
<span class="ansi-green-fg ansi-bold">      2</span> sns<span style="color:rgb(98,98,98)">.</span>violinplot(x<span style="color:rgb(98,98,98)">=</span><span style="color:rgb(175,0,0)">'</span><span style="color:rgb(175,0,0)">Marital_Status</span><span style="color:rgb(175,0,0)">'</span>, y<span style="color:rgb(98,98,98)">=</span><span style="color:rgb(175,0,0)">'</span><span style="color:rgb(175,0,0)">Net_Annual_Income</span><span style="color:rgb(175,0,0)">'</span>, 
<span class="ansi-green-fg ansi-bold">      3</span>                hue<span style="color:rgb(98,98,98)">=</span><span style="color:rgb(175,0,0)">'</span><span style="color:rgb(175,0,0)">Y</span><span style="color:rgb(175,0,0)">'</span>, split<span style="color:rgb(98,98,98)">=</span><span style="font-weight:bold;color:rgb(0,135,0)">True</span>, data<span style="color:rgb(98,98,98)">=</span>df)

<span class="ansi-red-fg">NameError</span>: name 'plt' is not defined</pre>
</div>
</div>
</div>
<div id="92c70c19" class="cell" data-execution_count="57">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">5</span>))</span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>sns.countplot(x<span class="op">=</span><span class="st">'Marital_Status'</span>, hue<span class="op">=</span><span class="st">'Y'</span>, data<span class="op">=</span>df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-error">
<div class="ansi-escaped-output">
<pre><span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">NameError</span>                                 Traceback (most recent call last)
Cell <span class="ansi-green-fg">In[51], line 1</span>
<span class="ansi-green-fg">----&gt; 1</span> <span class="ansi-yellow-bg">plt</span><span style="color:rgb(98,98,98)">.</span>figure(figsize<span style="color:rgb(98,98,98)">=</span>(<span style="color:rgb(98,98,98)">10</span>, <span style="color:rgb(98,98,98)">5</span>))
<span class="ansi-green-fg ansi-bold">      2</span> sns<span style="color:rgb(98,98,98)">.</span>countplot(x<span style="color:rgb(98,98,98)">=</span><span style="color:rgb(175,0,0)">'</span><span style="color:rgb(175,0,0)">Marital_Status</span><span style="color:rgb(175,0,0)">'</span>, hue<span style="color:rgb(98,98,98)">=</span><span style="color:rgb(175,0,0)">'</span><span style="color:rgb(175,0,0)">Y</span><span style="color:rgb(175,0,0)">'</span>, data<span style="color:rgb(98,98,98)">=</span>df)

<span class="ansi-red-fg">NameError</span>: name 'plt' is not defined</pre>
</div>
</div>
</div>
<div id="8678cbb6" class="cell" data-execution_count="58">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>fig, axes <span class="op">=</span> plt.subplots(nrows<span class="op">=</span><span class="dv">4</span>, ncols<span class="op">=</span><span class="dv">3</span>, figsize<span class="op">=</span>(<span class="dv">16</span>, <span class="dv">16</span>))</span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>columns <span class="op">=</span> [<span class="st">'Customer_Type'</span>, <span class="st">'P_Client'</span>, <span class="st">'Educational_Level'</span>, </span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a>           <span class="st">'Number_Of_Dependant'</span>, <span class="st">'Marital_Status'</span>, <span class="st">'Prod_Sub_Category'</span>,</span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a>           <span class="st">'Source'</span>, <span class="st">'Type_Of_Residence'</span>, <span class="st">'Nb_Of_Products'</span>, </span>
<span id="cb62-5"><a href="#cb62-5" aria-hidden="true" tabindex="-1"></a>           <span class="st">'Prod_Category'</span>, <span class="st">'Y'</span>]</span>
<span id="cb62-6"><a href="#cb62-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-7"><a href="#cb62-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i, colname <span class="kw">in</span> <span class="bu">enumerate</span>(columns):</span>
<span id="cb62-8"><a href="#cb62-8" aria-hidden="true" tabindex="-1"></a>    sns.countplot(x<span class="op">=</span>colname, data<span class="op">=</span>df, ax<span class="op">=</span>fig.axes[i])</span>
<span id="cb62-9"><a href="#cb62-9" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-error">
<div class="ansi-escaped-output">
<pre><span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">NameError</span>                                 Traceback (most recent call last)
Cell <span class="ansi-green-fg">In[52], line 1</span>
<span class="ansi-green-fg">----&gt; 1</span> fig, axes <span style="color:rgb(98,98,98)">=</span> <span class="ansi-yellow-bg">plt</span><span style="color:rgb(98,98,98)">.</span>subplots(nrows<span style="color:rgb(98,98,98)">=</span><span style="color:rgb(98,98,98)">4</span>, ncols<span style="color:rgb(98,98,98)">=</span><span style="color:rgb(98,98,98)">3</span>, figsize<span style="color:rgb(98,98,98)">=</span>(<span style="color:rgb(98,98,98)">16</span>, <span style="color:rgb(98,98,98)">16</span>))
<span class="ansi-green-fg ansi-bold">      2</span> columns <span style="color:rgb(98,98,98)">=</span> [<span style="color:rgb(175,0,0)">'</span><span style="color:rgb(175,0,0)">Customer_Type</span><span style="color:rgb(175,0,0)">'</span>, <span style="color:rgb(175,0,0)">'</span><span style="color:rgb(175,0,0)">P_Client</span><span style="color:rgb(175,0,0)">'</span>, <span style="color:rgb(175,0,0)">'</span><span style="color:rgb(175,0,0)">Educational_Level</span><span style="color:rgb(175,0,0)">'</span>, 
<span class="ansi-green-fg ansi-bold">      3</span>            <span style="color:rgb(175,0,0)">'</span><span style="color:rgb(175,0,0)">Number_Of_Dependant</span><span style="color:rgb(175,0,0)">'</span>, <span style="color:rgb(175,0,0)">'</span><span style="color:rgb(175,0,0)">Marital_Status</span><span style="color:rgb(175,0,0)">'</span>, <span style="color:rgb(175,0,0)">'</span><span style="color:rgb(175,0,0)">Prod_Sub_Category</span><span style="color:rgb(175,0,0)">'</span>,
<span class="ansi-green-fg ansi-bold">      4</span>            <span style="color:rgb(175,0,0)">'</span><span style="color:rgb(175,0,0)">Source</span><span style="color:rgb(175,0,0)">'</span>, <span style="color:rgb(175,0,0)">'</span><span style="color:rgb(175,0,0)">Type_Of_Residence</span><span style="color:rgb(175,0,0)">'</span>, <span style="color:rgb(175,0,0)">'</span><span style="color:rgb(175,0,0)">Nb_Of_Products</span><span style="color:rgb(175,0,0)">'</span>, 
<span class="ansi-green-fg ansi-bold">      5</span>            <span style="color:rgb(175,0,0)">'</span><span style="color:rgb(175,0,0)">Prod_Category</span><span style="color:rgb(175,0,0)">'</span>, <span style="color:rgb(175,0,0)">'</span><span style="color:rgb(175,0,0)">Y</span><span style="color:rgb(175,0,0)">'</span>]
<span class="ansi-green-fg ansi-bold">      7</span> <span style="font-weight:bold;color:rgb(0,135,0)">for</span> i, colname <span style="font-weight:bold;color:rgb(175,0,255)">in</span> <span style="color:rgb(0,135,0)">enumerate</span>(columns):

<span class="ansi-red-fg">NameError</span>: name 'plt' is not defined</pre>
</div>
</div>
</div>
</section>
<section id="final-preparation-of-the-dataset" class="level1">
<h1>Final preparation of the dataset</h1>
<div id="1324b2d0" class="cell" data-execution_count="59">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="co"># First we make lists of continuous, categorial and date features</span></span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a>cnt_featnames <span class="op">=</span> [</span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Years_At_Residence'</span>,</span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Net_Annual_Income'</span>,</span>
<span id="cb63-6"><a href="#cb63-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Years_At_Business'</span>,</span>
<span id="cb63-7"><a href="#cb63-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Number_Of_Dependant'</span></span>
<span id="cb63-8"><a href="#cb63-8" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb63-9"><a href="#cb63-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-10"><a href="#cb63-10" aria-hidden="true" tabindex="-1"></a>cat_featnames <span class="op">=</span> [</span>
<span id="cb63-11"><a href="#cb63-11" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Customer_Type'</span>,</span>
<span id="cb63-12"><a href="#cb63-12" aria-hidden="true" tabindex="-1"></a>    <span class="st">'P_Client'</span>,</span>
<span id="cb63-13"><a href="#cb63-13" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Educational_Level'</span>,</span>
<span id="cb63-14"><a href="#cb63-14" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Marital_Status'</span>,</span>
<span id="cb63-15"><a href="#cb63-15" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Prod_Sub_Category'</span>,</span>
<span id="cb63-16"><a href="#cb63-16" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Source'</span>,</span>
<span id="cb63-17"><a href="#cb63-17" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Type_Of_Residence'</span>,</span>
<span id="cb63-18"><a href="#cb63-18" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Prod_Category'</span>,</span>
<span id="cb63-19"><a href="#cb63-19" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Nb_Of_Products'</span></span>
<span id="cb63-20"><a href="#cb63-20" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb63-21"><a href="#cb63-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-22"><a href="#cb63-22" aria-hidden="true" tabindex="-1"></a>date_featnames <span class="op">=</span> [</span>
<span id="cb63-23"><a href="#cb63-23" aria-hidden="true" tabindex="-1"></a>    <span class="st">'BirthDate'</span>,</span>
<span id="cb63-24"><a href="#cb63-24" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Customer_Open_Date'</span>,</span>
<span id="cb63-25"><a href="#cb63-25" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Prod_Decision_Date'</span></span>
<span id="cb63-26"><a href="#cb63-26" aria-hidden="true" tabindex="-1"></a>    <span class="co">#'Prod_Closed_Date'</span></span>
<span id="cb63-27"><a href="#cb63-27" aria-hidden="true" tabindex="-1"></a>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="creation-of-the-features-matrix" class="level2">
<h2 class="anchored" data-anchor-id="creation-of-the-features-matrix">Creation of the features matrix</h2>
<div id="bf84b79f" class="cell" data-execution_count="60">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>df[cnt_featnames].head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-error">
<div class="ansi-escaped-output">
<pre><span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">NameError</span>                                 Traceback (most recent call last)
Cell <span class="ansi-green-fg">In[54], line 1</span>
<span class="ansi-green-fg">----&gt; 1</span> <span class="ansi-yellow-bg">df</span>[cnt_featnames]<span style="color:rgb(98,98,98)">.</span>head()

<span class="ansi-red-fg">NameError</span>: name 'df' is not defined</pre>
</div>
</div>
</div>
<div id="97fe7c64" class="cell" data-execution_count="61">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a>bin_features <span class="op">=</span> pd.get_dummies(df[cat_featnames],</span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>                              prefix_sep<span class="op">=</span><span class="st">'#'</span>, drop_first<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-error">
<div class="ansi-escaped-output">
<pre><span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">NameError</span>                                 Traceback (most recent call last)
Cell <span class="ansi-green-fg">In[55], line 1</span>
<span class="ansi-green-fg">----&gt; 1</span> bin_features <span style="color:rgb(98,98,98)">=</span> pd<span style="color:rgb(98,98,98)">.</span>get_dummies(<span class="ansi-yellow-bg">df</span>[cat_featnames],
<span class="ansi-green-fg ansi-bold">      2</span>                               prefix_sep<span style="color:rgb(98,98,98)">=</span><span style="color:rgb(175,0,0)">'</span><span style="color:rgb(175,0,0)">#</span><span style="color:rgb(175,0,0)">'</span>, drop_first<span style="color:rgb(98,98,98)">=</span><span style="font-weight:bold;color:rgb(0,135,0)">True</span>)

<span class="ansi-red-fg">NameError</span>: name 'df' is not defined</pre>
</div>
</div>
</div>
<div id="2c6c1f75" class="cell" data-execution_count="62">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a>bin_features.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-error">
<div class="ansi-escaped-output">
<pre><span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">NameError</span>                                 Traceback (most recent call last)
Cell <span class="ansi-green-fg">In[56], line 1</span>
<span class="ansi-green-fg">----&gt; 1</span> <span class="ansi-yellow-bg">bin_features</span><span style="color:rgb(98,98,98)">.</span>head()

<span class="ansi-red-fg">NameError</span>: name 'bin_features' is not defined</pre>
</div>
</div>
</div>
<div id="7335df96" class="cell" data-execution_count="63">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a>cnt_features <span class="op">=</span> df[cnt_featnames]</span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a>cnt_features.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-error">
<div class="ansi-escaped-output">
<pre><span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">NameError</span>                                 Traceback (most recent call last)
Cell <span class="ansi-green-fg">In[57], line 1</span>
<span class="ansi-green-fg">----&gt; 1</span> cnt_features <span style="color:rgb(98,98,98)">=</span> <span class="ansi-yellow-bg">df</span>[cnt_featnames]
<span class="ansi-green-fg ansi-bold">      2</span> cnt_features<span style="color:rgb(98,98,98)">.</span>head()

<span class="ansi-red-fg">NameError</span>: name 'df' is not defined</pre>
</div>
</div>
</div>
<div id="3bc720fe" class="cell" data-execution_count="64">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> pandas <span class="im">import</span> Timestamp</span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> age(x):</span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a>    today <span class="op">=</span> Timestamp.today()</span>
<span id="cb68-5"><a href="#cb68-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> (today <span class="op">-</span> x).dt.days</span>
<span id="cb68-6"><a href="#cb68-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-7"><a href="#cb68-7" aria-hidden="true" tabindex="-1"></a>date_features <span class="op">=</span> df[date_featnames].<span class="bu">apply</span>(age, axis<span class="op">=</span><span class="st">"index"</span>)</span>
<span id="cb68-8"><a href="#cb68-8" aria-hidden="true" tabindex="-1"></a>date_features.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-error">
<div class="ansi-escaped-output">
<pre><span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">NameError</span>                                 Traceback (most recent call last)
Cell <span class="ansi-green-fg">In[58], line 7</span>
<span class="ansi-green-fg ansi-bold">      4</span>     today <span style="color:rgb(98,98,98)">=</span> Timestamp<span style="color:rgb(98,98,98)">.</span>today()
<span class="ansi-green-fg ansi-bold">      5</span>     <span style="font-weight:bold;color:rgb(0,135,0)">return</span> (today <span style="color:rgb(98,98,98)">-</span> x)<span style="color:rgb(98,98,98)">.</span>dt<span style="color:rgb(98,98,98)">.</span>days
<span class="ansi-green-fg">----&gt; 7</span> date_features <span style="color:rgb(98,98,98)">=</span> <span class="ansi-yellow-bg">df</span>[date_featnames]<span style="color:rgb(98,98,98)">.</span>apply(age, axis<span style="color:rgb(98,98,98)">=</span><span style="color:rgb(175,0,0)">"</span><span style="color:rgb(175,0,0)">index</span><span style="color:rgb(175,0,0)">"</span>)
<span class="ansi-green-fg ansi-bold">      8</span> date_features<span style="color:rgb(98,98,98)">.</span>head()

<span class="ansi-red-fg">NameError</span>: name 'df' is not defined</pre>
</div>
</div>
</div>
<div id="b4113b41" class="cell" data-execution_count="65">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a>today <span class="op">=</span> Timestamp.today()</span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a>today</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="59">
<pre><code>Timestamp('2025-04-03 15:08:18.726353')</code></pre>
</div>
</div>
<div id="3f82c382" class="cell" data-execution_count="66">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a>tt <span class="op">=</span> (today <span class="op">-</span> df[<span class="st">"BirthDate"</span>]).loc[<span class="dv">0</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-error">
<div class="ansi-escaped-output">
<pre><span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">NameError</span>                                 Traceback (most recent call last)
Cell <span class="ansi-green-fg">In[60], line 1</span>
<span class="ansi-green-fg">----&gt; 1</span> tt <span style="color:rgb(98,98,98)">=</span> (today <span style="color:rgb(98,98,98)">-</span> <span class="ansi-yellow-bg">df</span>[<span style="color:rgb(175,0,0)">"</span><span style="color:rgb(175,0,0)">BirthDate</span><span style="color:rgb(175,0,0)">"</span>])<span style="color:rgb(98,98,98)">.</span>loc[<span style="color:rgb(98,98,98)">0</span>]

<span class="ansi-red-fg">NameError</span>: name 'df' is not defined</pre>
</div>
</div>
</div>
<div id="61a46dd4" class="cell" data-execution_count="67">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a>(today <span class="op">-</span> df[<span class="st">"BirthDate"</span>]).dt.days</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-error">
<div class="ansi-escaped-output">
<pre><span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">NameError</span>                                 Traceback (most recent call last)
Cell <span class="ansi-green-fg">In[61], line 1</span>
<span class="ansi-green-fg">----&gt; 1</span> (today <span style="color:rgb(98,98,98)">-</span> <span class="ansi-yellow-bg">df</span>[<span style="color:rgb(175,0,0)">"</span><span style="color:rgb(175,0,0)">BirthDate</span><span style="color:rgb(175,0,0)">"</span>])<span style="color:rgb(98,98,98)">.</span>dt<span style="color:rgb(98,98,98)">.</span>days

<span class="ansi-red-fg">NameError</span>: name 'df' is not defined</pre>
</div>
</div>
</div>
<div id="7ff9c38f" class="cell" data-execution_count="68">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a>tt</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-error">
<div class="ansi-escaped-output">
<pre><span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">NameError</span>                                 Traceback (most recent call last)
Cell <span class="ansi-green-fg">In[62], line 1</span>
<span class="ansi-green-fg">----&gt; 1</span> <span class="ansi-yellow-bg">tt</span>

<span class="ansi-red-fg">NameError</span>: name 'tt' is not defined</pre>
</div>
</div>
</div>
</section>
<section id="final-features-matrix" class="level2">
<h2 class="anchored" data-anchor-id="final-features-matrix">Final features matrix</h2>
<div id="2bb05c56" class="cell" data-execution_count="69">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a>all_features <span class="op">=</span> pd.concat([bin_features, cnt_features, date_features], axis<span class="op">=</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-error">
<div class="ansi-escaped-output">
<pre><span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">NameError</span>                                 Traceback (most recent call last)
Cell <span class="ansi-green-fg">In[63], line 1</span>
<span class="ansi-green-fg">----&gt; 1</span> all_features <span style="color:rgb(98,98,98)">=</span> pd<span style="color:rgb(98,98,98)">.</span>concat([<span class="ansi-yellow-bg">bin_features</span>, cnt_features, date_features], axis<span style="color:rgb(98,98,98)">=</span><span style="color:rgb(98,98,98)">1</span>)

<span class="ansi-red-fg">NameError</span>: name 'bin_features' is not defined</pre>
</div>
</div>
</div>
<div id="9ccb0bad" class="cell" data-execution_count="70">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a>all_features.columns</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-error">
<div class="ansi-escaped-output">
<pre><span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">NameError</span>                                 Traceback (most recent call last)
Cell <span class="ansi-green-fg">In[64], line 1</span>
<span class="ansi-green-fg">----&gt; 1</span> <span class="ansi-yellow-bg">all_features</span><span style="color:rgb(98,98,98)">.</span>columns

<span class="ansi-red-fg">NameError</span>: name 'all_features' is not defined</pre>
</div>
</div>
</div>
<div id="79d16b56" class="cell" data-execution_count="71">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a>all_features.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-error">
<div class="ansi-escaped-output">
<pre><span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">NameError</span>                                 Traceback (most recent call last)
Cell <span class="ansi-green-fg">In[65], line 1</span>
<span class="ansi-green-fg">----&gt; 1</span> <span class="ansi-yellow-bg">all_features</span><span style="color:rgb(98,98,98)">.</span>head()

<span class="ansi-red-fg">NameError</span>: name 'all_features' is not defined</pre>
</div>
</div>
</div>
<div id="1d94775e" class="cell" data-execution_count="72">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a>df_debile <span class="op">=</span> pd.DataFrame({<span class="st">"nom etudiant"</span>: [<span class="st">"yiyang"</span>, <span class="st">"jaouad"</span>, <span class="st">"mokhtar"</span>, <span class="st">"massil"</span>, <span class="st">"simon"</span>], </span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a>              <span class="st">"portable"</span>: [<span class="va">True</span>, <span class="va">True</span>, <span class="va">None</span>, <span class="va">True</span>, <span class="va">False</span>]})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div id="25dc2e6f" class="cell" data-execution_count="73">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a>df_debile</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="67">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">nom etudiant</th>
<th data-quarto-table-cell-role="th">portable</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>yiyang</td>
<td>True</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>jaouad</td>
<td>True</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>mokhtar</td>
<td>None</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>massil</td>
<td>True</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>simon</td>
<td>False</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="eb3cb4fa" class="cell" data-execution_count="74">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a>df_debile.index</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="68">
<pre><code>RangeIndex(start=0, stop=5, step=1)</code></pre>
</div>
</div>
<div id="db313719" class="cell" data-execution_count="75">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a>df_debile.dropna().index</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="69">
<pre><code>Index([0, 1, 3, 4], dtype='int64')</code></pre>
</div>
</div>
<div id="4e5b872c" class="cell" data-execution_count="76">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a>df_debile.info()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;class 'pandas.core.frame.DataFrame'&gt;
RangeIndex: 5 entries, 0 to 4
Data columns (total 2 columns):
 #   Column        Non-Null Count  Dtype 
---  ------        --------------  ----- 
 0   nom etudiant  5 non-null      object
 1   portable      4 non-null      object
dtypes: object(2)
memory usage: 212.0+ bytes</code></pre>
</div>
</div>
<p><strong>VERY IMPORTANT</strong>: we removed lines of data that contained missing values. The index of the dataframe is therefore not contiguous anymore</p>
<div id="5b13a73e" class="cell" data-execution_count="77">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a>all_features.index.<span class="bu">max</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-error">
<div class="ansi-escaped-output">
<pre><span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">NameError</span>                                 Traceback (most recent call last)
Cell <span class="ansi-green-fg">In[71], line 1</span>
<span class="ansi-green-fg">----&gt; 1</span> <span class="ansi-yellow-bg">all_features</span><span style="color:rgb(98,98,98)">.</span>index<span style="color:rgb(98,98,98)">.</span>max()

<span class="ansi-red-fg">NameError</span>: name 'all_features' is not defined</pre>
</div>
</div>
</div>
<p>This could be a problem for later. So let’s reset the index to get a contiguous one</p>
<div id="87611142" class="cell" data-execution_count="78">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a>all_features.shape</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-error">
<div class="ansi-escaped-output">
<pre><span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">NameError</span>                                 Traceback (most recent call last)
Cell <span class="ansi-green-fg">In[72], line 1</span>
<span class="ansi-green-fg">----&gt; 1</span> <span class="ansi-yellow-bg">all_features</span><span style="color:rgb(98,98,98)">.</span>shape

<span class="ansi-red-fg">NameError</span>: name 'all_features' is not defined</pre>
</div>
</div>
</div>
<div id="18858abe" class="cell" data-execution_count="79">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a>all_features.reset_index(inplace<span class="op">=</span><span class="va">True</span>, drop<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-error">
<div class="ansi-escaped-output">
<pre><span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">NameError</span>                                 Traceback (most recent call last)
Cell <span class="ansi-green-fg">In[73], line 1</span>
<span class="ansi-green-fg">----&gt; 1</span> <span class="ansi-yellow-bg">all_features</span><span style="color:rgb(98,98,98)">.</span>reset_index(inplace<span style="color:rgb(98,98,98)">=</span><span style="font-weight:bold;color:rgb(0,135,0)">True</span>, drop<span style="color:rgb(98,98,98)">=</span><span style="font-weight:bold;color:rgb(0,135,0)">True</span>)

<span class="ansi-red-fg">NameError</span>: name 'all_features' is not defined</pre>
</div>
</div>
</div>
<div id="424b6d0f" class="cell" data-execution_count="80">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a>all_features.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-error">
<div class="ansi-escaped-output">
<pre><span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">NameError</span>                                 Traceback (most recent call last)
Cell <span class="ansi-green-fg">In[74], line 1</span>
<span class="ansi-green-fg">----&gt; 1</span> <span class="ansi-yellow-bg">all_features</span><span style="color:rgb(98,98,98)">.</span>head()

<span class="ansi-red-fg">NameError</span>: name 'all_features' is not defined</pre>
</div>
</div>
</div>
</section>
<section id="lets-save-the-data-using-pickle" class="level2">
<h2 class="anchored" data-anchor-id="lets-save-the-data-using-pickle">Let’s save the data using <code>pickle</code></h2>
<div id="d5a3b9b8" class="cell" data-execution_count="81">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pickle <span class="im">as</span> pkl</span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-3"><a href="#cb89-3" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> all_features</span>
<span id="cb89-4"><a href="#cb89-4" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> df[<span class="st">'Y'</span>]</span>
<span id="cb89-5"><a href="#cb89-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-6"><a href="#cb89-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Let's put eveything in a dictionary</span></span>
<span id="cb89-7"><a href="#cb89-7" aria-hidden="true" tabindex="-1"></a>df_pkl <span class="op">=</span> {}</span>
<span id="cb89-8"><a href="#cb89-8" aria-hidden="true" tabindex="-1"></a><span class="co"># The features and the labels</span></span>
<span id="cb89-9"><a href="#cb89-9" aria-hidden="true" tabindex="-1"></a>df_pkl[<span class="st">'features'</span>] <span class="op">=</span> X</span>
<span id="cb89-10"><a href="#cb89-10" aria-hidden="true" tabindex="-1"></a>df_pkl[<span class="st">'labels'</span>] <span class="op">=</span> y</span>
<span id="cb89-11"><a href="#cb89-11" aria-hidden="true" tabindex="-1"></a><span class="co"># And also the list of columns we built above</span></span>
<span id="cb89-12"><a href="#cb89-12" aria-hidden="true" tabindex="-1"></a>df_pkl[<span class="st">'cnt_featnames'</span>] <span class="op">=</span> cnt_featnames</span>
<span id="cb89-13"><a href="#cb89-13" aria-hidden="true" tabindex="-1"></a>df_pkl[<span class="st">'cat_featnames'</span>] <span class="op">=</span> cat_featnames</span>
<span id="cb89-14"><a href="#cb89-14" aria-hidden="true" tabindex="-1"></a>df_pkl[<span class="st">'date_featnames'</span>] <span class="op">=</span> date_featnames</span>
<span id="cb89-15"><a href="#cb89-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-16"><a href="#cb89-16" aria-hidden="true" tabindex="-1"></a><span class="cf">with</span> <span class="bu">open</span>(<span class="st">"gro_training.pkl"</span>, <span class="st">'wb'</span>) <span class="im">as</span> f:</span>
<span id="cb89-17"><a href="#cb89-17" aria-hidden="true" tabindex="-1"></a>    pkl.dump(df_pkl, f)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div id="2065fd85" class="cell" data-execution_count="82">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a>ls <span class="op">-</span>al gro<span class="op">*</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>-rw-rw-r-- 1 boucheron boucheron 9115 avril  3 15:08 gro.csv.gz</code></pre>
</div>
</div>
<p>The preprocessed data is saved in a pickle file called <code>gro_training.pkdfl</code>.</p>
<p><a href="https://www.databricks.com/blog/2021/10/04/pandas-api-on-upcoming-apache-spark-3-2.html">Databricks blog about Koalas, SPIP, Zen</a></p>
<blockquote class="blockquote">
<p>pandas users will be able scale their workloads with one simple line change in the upcoming Spark 3.2 release:</p>
</blockquote>
<div class="sourceCode" id="cb92"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a><span class="op">&lt;</span>s<span class="op">&gt;</span><span class="im">from</span> pandas <span class="im">import</span> read_csv<span class="op">&lt;/</span>s<span class="op">&gt;</span></span>
<span id="cb92-2"><a href="#cb92-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> pyspark.pandas <span class="im">import</span> read_csv</span>
<span id="cb92-3"><a href="#cb92-3" aria-hidden="true" tabindex="-1"></a>pdf <span class="op">=</span> read_csv(<span class="st">"data.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/s-v-b\.github\.io\/IFEBY310\/");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
          // target, if specified
          link.setAttribute("target", "_blank");
          if (link.getAttribute("rel") === null) {
            link.setAttribute("rel", "noopener");
          }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p>© Copyright 2024, Stéphane Boucheron</p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    <div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/s-v-b/IFEBY310/edit/main/core/notebooks/notebook04_pandas_spark.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/s-v-b/IFEBY310/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></div>
    <div class="nav-footer-right">
<p>This page is built with blood, sweat, tears, and <a href="https://quarto.org/">Quarto</a>.</p>
</div>
  </div>
</footer>




</body></html>