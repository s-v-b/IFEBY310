<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US" xml:lang="en-US"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.40">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Introduction to numpy – IFEBY310 - Spring 2025</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-549806ee2085284f45b00abea8c6df48.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-dark-8ea72dc5fed832574809a9c94082fbbb.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap-65bb2660d2added026bc737f6d61009c.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../../site_libs/bootstrap/bootstrap-dark-7b2e65690087d8706f18962bbef010b2.min.css" rel="prefetch" append-hash="true" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<meta property="og:title" content="Introduction to numpy – IFEBY310 - Spring 2025">
<meta property="og:description" content="Homepage for course IFEBY310 - Big Data Technologies, Master MIDS Spring 2025.">
<meta property="og:image" content="https://s-v-b.github.io/IFEBY310/core/notebooks/notebook02_numpy_files/figure-html/cell-46-output-1.png">
<meta property="og:site_name" content="IFEBY310 - Spring 2025">
<meta property="og:image:height" content="674">
<meta property="og:image:width" content="1303">
</head>

<body class="nav-sidebar docked">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item">Introduction to <code>numpy</code></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-center sidebar-header">
      <a href="../../index.html" class="sidebar-logo-link">
      <img src="../../images/UniversiteParisCite_logo_horizontal_couleur_RVB.png" alt="" class="sidebar-logo py-0 d-lg-inline d-none">
      </a>
      <div class="sidebar-tools-main tools-wide">
    <a href="https://github.com/s-v-b/IFEBY310" title="GitHub organization" class="quarto-navigation-tool px-1" aria-label="GitHub organization"><i class="bi bi-github"></i></a>
    <div class="dropdown">
      <a href="" title="Moodle" id="quarto-navigation-tool-dropdown-0" class="quarto-navigation-tool dropdown-toggle px-1" data-bs-toggle="dropdown" aria-expanded="false" role="link" aria-label="Moodle"><i class="bi bi-person-fill"></i></a>
      <ul class="dropdown-menu" aria-labelledby="quarto-navigation-tool-dropdown-0">
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://moodle.u-paris.fr/course/view.php?id=28534">
            Discussion forum
            </a>
          </li>
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://moodle.u-paris.fr/course/view.php?id=28534">
            Dépot
            </a>
          </li>
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://moodle.u-paris.fr/course/view.php?id=28534">
            Notes
            </a>
          </li>
      </ul>
    </div>
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="false">
 <span class="menu-text">Information</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Glimpse</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../cours-syllabus.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Syllabus</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../course-team.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Team</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="false">
 <span class="menu-text">Support</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../computing-access.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Computing resources</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../computing-virtualenv.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Virtual environments</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../computing-jupyter.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Jupyter</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../quarto-format.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Quarto</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../computing-docker.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Docker</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../slides-listings.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Slides</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../notebooks-listings.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Notebooks</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../projects-listings.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Homeworks</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../weeks-listings.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Journal</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#the-base-numpy.array-object" id="toc-the-base-numpy.array-object" class="nav-link active" data-scroll-target="#the-base-numpy.array-object">The base <code>numpy.array</code> object</a></li>
  <li><a href="#matrix-multiplication" id="toc-matrix-multiplication" class="nav-link" data-scroll-target="#matrix-multiplication">Matrix multiplication</a></li>
  <li><a href="#generating-arrays" id="toc-generating-arrays" class="nav-link" data-scroll-target="#generating-arrays">Generating arrays</a></li>
  <li><a href="#slicing" id="toc-slicing" class="nav-link" data-scroll-target="#slicing">Slicing</a>
  <ul class="collapse">
  <li><a href="#copies" id="toc-copies" class="nav-link" data-scroll-target="#copies">Copies</a></li>
  <li><a href="#miscellanea" id="toc-miscellanea" class="nav-link" data-scroll-target="#miscellanea">Miscellanea</a>
  <ul class="collapse">
  <li><a href="#non-numerical-values" id="toc-non-numerical-values" class="nav-link" data-scroll-target="#non-numerical-values">Non-numerical values</a></li>
  </ul></li>
  <li><a href="#a-matrix-is-no-2d-array-in-numpy" id="toc-a-matrix-is-no-2d-array-in-numpy" class="nav-link" data-scroll-target="#a-matrix-is-no-2d-array-in-numpy">A matrix is no 2D array in <code>numpy</code></a></li>
  <li><a href="#sparse-matrices" id="toc-sparse-matrices" class="nav-link" data-scroll-target="#sparse-matrices">Sparse matrices</a></li>
  <li><a href="#bored-with-decimals" id="toc-bored-with-decimals" class="nav-link" data-scroll-target="#bored-with-decimals">Bored with decimals?</a></li>
  <li><a href="#not-limited-to-2d" id="toc-not-limited-to-2d" class="nav-link" data-scroll-target="#not-limited-to-2d">Not limited to 2D!</a></li>
  </ul></li>
  <li><a href="#aggregations-and-statistics" id="toc-aggregations-and-statistics" class="nav-link" data-scroll-target="#aggregations-and-statistics">Aggregations and statistics</a></li>
  <li><a href="#linear-algebra" id="toc-linear-algebra" class="nav-link" data-scroll-target="#linear-algebra">Linear Algebra</a>
  <ul class="collapse">
  <li><a href="#inner-products" id="toc-inner-products" class="nav-link" data-scroll-target="#inner-products">Inner products</a></li>
  <li><a href="#linear-systems" id="toc-linear-systems" class="nav-link" data-scroll-target="#linear-systems">Linear systems</a></li>
  <li><a href="#eigenvalues-and-eigenvectors" id="toc-eigenvalues-and-eigenvectors" class="nav-link" data-scroll-target="#eigenvalues-and-eigenvectors">Eigenvalues and eigenvectors</a></li>
  <li><a href="#singular-value-decomposition-svd" id="toc-singular-value-decomposition-svd" class="nav-link" data-scroll-target="#singular-value-decomposition-svd">Singular value decomposition (SVD)</a></li>
  <li><a href="#exercice-the-racoon-svd" id="toc-exercice-the-racoon-svd" class="nav-link" data-scroll-target="#exercice-the-racoon-svd">Exercice: the racoon SVD</a></li>
  </ul></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.com/s-v-b/IFEBY310/edit/main/core/notebooks/notebook02_numpy.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/s-v-b/IFEBY310/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">Introduction to <code>numpy</code></h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button" data-quarto-source-url="https://github.com/s-v-b/IFEBY310/blob/main/core/notebooks/notebook02_numpy.qmd">View Source</a></li></ul></div></div>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p><a href="https://numpy.org"><code>NumPy</code></a> is the fundamental package for scientific computing with Python. It contains among other things:</p>
<ul>
<li>a powerful <a href="https://numpy.org/doc/stable/user/basics.indexing.html">N-dimensional array object</a></li>
<li>(sophisticated) <a href="https://numpy.org/doc/stable/user/basics.broadcasting.html">broadcasting functions</a></li>
<li>tools for integrating C/C++ and Fortran code</li>
<li>useful <a href="https://numpy.org/doc/stable/reference/routines.linalg.html">linear algebra</a>, <a href="https://numpy.org/doc/stable/user/basics.indexing.html">Fourier transform</a>, and <a href="https://numpy.org/doc/stable/reference/random/index.html">random generation capabilities</a></li>
</ul>
<p>Besides its obvious scientific uses, <code>NumPy</code> can also be used as an efficient multi-dimensional container for general data. Arbitrary data-types can be defined. This allows <code>NumPy</code> to seamlessly and speedily integrate with a wide variety of databases.</p>
<p>Library documentation: <a>http://numpy.org/</a></p>
<section id="the-base-numpy.array-object" class="level2">
<h2 class="anchored" data-anchor-id="the-base-numpy.array-object">The base <code>numpy.array</code> object</h2>
<div id="cell-setup" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2022-01-19T10:03:56.772810Z&quot;,&quot;start_time&quot;:&quot;2022-01-19T10:03:56.767960Z&quot;}" data-slideshow="{&quot;slide_type&quot;:&quot;subslide&quot;}" data-execution_count="1">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="co"># declare a vector using a list as the argument</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>v <span class="op">=</span> np.array([<span class="dv">1</span>, <span class="fl">2.0</span>, <span class="dv">3</span>, <span class="dv">4</span>])</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>v</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div id="setup" class="cell-output cell-output-display" data-execution_count="1">
<pre><code>array([1., 2., 3., 4.])</code></pre>
</div>
</div>
<div id="dce40be9" class="cell" data-execution_count="2">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="bu">list</span>([<span class="dv">1</span>, <span class="fl">2.0</span>, <span class="dv">3</span>, <span class="dv">4</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="2">
<pre><code>[1, 2.0, 3, 4]</code></pre>
</div>
</div>
<div id="487db108" class="cell" data-execution_count="3">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="bu">type</span>(v)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="3">
<pre><code>numpy.ndarray</code></pre>
</div>
</div>
<div id="6492e8ac" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2022-01-19T10:04:14.635335Z&quot;,&quot;start_time&quot;:&quot;2022-01-19T10:04:14.631049Z&quot;}" data-execution_count="4">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>v.shape</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="4">
<pre><code>(4,)</code></pre>
</div>
</div>
<div id="0c3d2914" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2022-01-19T10:04:21.792284Z&quot;,&quot;start_time&quot;:&quot;2022-01-19T10:04:21.788055Z&quot;}" data-execution_count="5">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>v.ndim</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="5">
<pre><code>1</code></pre>
</div>
</div>
<div id="01ef5cdc" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2022-01-19T10:04:25.288962Z&quot;,&quot;start_time&quot;:&quot;2022-01-19T10:04:25.284105Z&quot;}" data-execution_count="6">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>v.dtype <span class="kw">is</span> <span class="bu">float</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="6">
<pre><code>False</code></pre>
</div>
</div>
<div id="1422fcf3" class="cell" data-execution_count="7">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>v.dtype </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="7">
<pre><code>dtype('float64')</code></pre>
</div>
</div>
<div id="b493e018" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2022-01-19T10:04:40.960057Z&quot;,&quot;start_time&quot;:&quot;2022-01-19T10:04:40.955004Z&quot;}" data-execution_count="8">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>np.uint8 <span class="kw">is</span> <span class="bu">int</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="8">
<pre><code>False</code></pre>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-1-contents" aria-controls="callout-1" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-1" class="callout-1-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Use copilot <em>explain</em> to understand the chunks:</p>
<blockquote class="blockquote">
<p>The np.uint8 is a data type in NumPy, representing an unsigned 8-bit integer, which can store values from 0 to 255. The int type is the built-in integer type in Python, which can represent any integer value without a fixed size limit.</p>
</blockquote>
</div>
</div>
</div>
<div id="c4425aa4" class="cell" data-execution_count="9">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>np.array([<span class="dv">2</span><span class="op">**</span><span class="dv">120</span>, <span class="dv">2</span><span class="op">**</span><span class="dv">40</span>], dtype<span class="op">=</span>np.int64)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-error">
<div class="ansi-escaped-output">
<pre><span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">OverflowError</span>                             Traceback (most recent call last)
Cell <span class="ansi-green-fg">In[9], line 1</span>
<span class="ansi-green-fg">----&gt; 1</span> <span class="ansi-yellow-bg">np</span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">.</span><span class="ansi-yellow-bg">array</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">[</span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">2</span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">*</span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">*</span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">120</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">2</span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">*</span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">*</span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">40</span><span class="ansi-yellow-bg">]</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">dtype</span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">=</span><span class="ansi-yellow-bg">np</span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">.</span><span class="ansi-yellow-bg">int64</span><span class="ansi-yellow-bg">)</span>

<span class="ansi-red-fg">OverflowError</span>: Python int too large to convert to C long</pre>
</div>
</div>
</div>
<div id="b33d0937" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2022-01-19T10:04:43.844304Z&quot;,&quot;start_time&quot;:&quot;2022-01-19T10:04:43.838964Z&quot;}" data-execution_count="10">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>np.uint16 <span class="kw">is</span> <span class="bu">int</span> </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="10">
<pre><code>False</code></pre>
</div>
</div>
<div id="7f70be80" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2022-01-19T10:04:45.206350Z&quot;,&quot;start_time&quot;:&quot;2022-01-19T10:04:45.201261Z&quot;}" data-execution_count="11">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>np.uint32  <span class="kw">is</span> <span class="bu">int</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="11">
<pre><code>False</code></pre>
</div>
</div>
<div id="16528d57" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2022-01-19T10:04:48.250324Z&quot;,&quot;start_time&quot;:&quot;2022-01-19T10:04:48.244917Z&quot;}" data-slideshow="{&quot;slide_type&quot;:&quot;subslide&quot;}" data-execution_count="12">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>w <span class="op">=</span> np.array([<span class="fl">1.3</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>], dtype<span class="op">=</span>np.int64)</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>w</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="12">
<pre><code>array([1, 2, 3, 4])</code></pre>
</div>
</div>
<div id="ea127192" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2022-01-19T10:05:00.151747Z&quot;,&quot;start_time&quot;:&quot;2022-01-19T10:05:00.146141Z&quot;}" data-execution_count="13">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>w.dtype</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="13">
<pre><code>dtype('int64')</code></pre>
</div>
</div>
<div id="165fb31a" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2022-01-19T10:08:25.417588Z&quot;,&quot;start_time&quot;:&quot;2022-01-19T10:08:25.414352Z&quot;}" data-slideshow="{&quot;slide_type&quot;:&quot;subslide&quot;}" data-execution_count="14">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>a <span class="op">=</span> np.arange(<span class="dv">100</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div id="760b221e" class="cell" data-execution_count="15">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="bu">type</span>(a)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="15">
<pre><code>numpy.ndarray</code></pre>
</div>
</div>
<div id="c060eb91" class="cell" data-execution_count="16">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>np.array(<span class="bu">range</span>(<span class="dv">100</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="16">
<pre><code>array([ 0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14, 15, 16,
       17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33,
       34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50,
       51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67,
       68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84,
       85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99])</code></pre>
</div>
</div>
<div id="521e1228" class="cell" data-execution_count="17">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>a</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="17">
<pre><code>array([ 0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14, 15, 16,
       17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33,
       34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50,
       51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67,
       68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84,
       85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99])</code></pre>
</div>
</div>
<div id="d9c3fc96" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2022-01-19T10:08:30.650242Z&quot;,&quot;start_time&quot;:&quot;2022-01-19T10:08:30.645228Z&quot;}" data-execution_count="18">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>a.dtype</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="18">
<pre><code>dtype('int64')</code></pre>
</div>
</div>
<div id="ec4c0df9" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2022-01-19T10:08:34.906164Z&quot;,&quot;start_time&quot;:&quot;2022-01-19T10:08:34.899997Z&quot;}" data-slideshow="{&quot;slide_type&quot;:&quot;subslide&quot;}" data-execution_count="19">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="op">-</span><span class="dv">3</span> <span class="op">*</span> a <span class="op">**</span> <span class="dv">2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="19">
<pre><code>array([     0,     -3,    -12,    -27,    -48,    -75,   -108,   -147,
         -192,   -243,   -300,   -363,   -432,   -507,   -588,   -675,
         -768,   -867,   -972,  -1083,  -1200,  -1323,  -1452,  -1587,
        -1728,  -1875,  -2028,  -2187,  -2352,  -2523,  -2700,  -2883,
        -3072,  -3267,  -3468,  -3675,  -3888,  -4107,  -4332,  -4563,
        -4800,  -5043,  -5292,  -5547,  -5808,  -6075,  -6348,  -6627,
        -6912,  -7203,  -7500,  -7803,  -8112,  -8427,  -8748,  -9075,
        -9408,  -9747, -10092, -10443, -10800, -11163, -11532, -11907,
       -12288, -12675, -13068, -13467, -13872, -14283, -14700, -15123,
       -15552, -15987, -16428, -16875, -17328, -17787, -18252, -18723,
       -19200, -19683, -20172, -20667, -21168, -21675, -22188, -22707,
       -23232, -23763, -24300, -24843, -25392, -25947, -26508, -27075,
       -27648, -28227, -28812, -29403])</code></pre>
</div>
</div>
<div id="6d88e380" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2022-01-19T10:08:37.560386Z&quot;,&quot;start_time&quot;:&quot;2022-01-19T10:08:37.557072Z&quot;}" data-slideshow="{&quot;slide_type&quot;:&quot;subslide&quot;}" data-execution_count="20">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>a[<span class="dv">42</span>] <span class="op">=</span> <span class="dv">13</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div id="6d907d51" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2022-01-19T10:08:38.581351Z&quot;,&quot;start_time&quot;:&quot;2022-01-19T10:08:38.578031Z&quot;}" data-execution_count="21">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>a[<span class="dv">42</span>] <span class="op">=</span> <span class="dv">1025</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div id="ae1d6618" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2022-01-19T10:09:34.115461Z&quot;,&quot;start_time&quot;:&quot;2022-01-19T10:09:34.109542Z&quot;}" data-execution_count="22">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>np.info(np.int16)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> int16()

Signed integer type, compatible with C ``short``.

:Character code: ``'h'``
:Canonical name: `numpy.short`
:Alias on this platform (Linux x86_64): `numpy.int16`: 16-bit signed integer (``-32_768`` to ``32_767``).


Methods:

  all  --  Scalar method identical to the corresponding array attribute.
  any  --  Scalar method identical to the corresponding array attribute.
  argmax  --  Scalar method identical to the corresponding array attribute.
  argmin  --  Scalar method identical to the corresponding array attribute.
  argsort  --  Scalar method identical to the corresponding array attribute.
  astype  --  Scalar method identical to the corresponding array attribute.
  bit_count  --  int16.bit_count() -&gt; int
  byteswap  --  Scalar method identical to the corresponding array attribute.
  choose  --  Scalar method identical to the corresponding array attribute.
  clip  --  Scalar method identical to the corresponding array attribute.
  compress  --  Scalar method identical to the corresponding array attribute.
  conj  --  None
  conjugate  --  Scalar method identical to the corresponding array attribute.
  copy  --  Scalar method identical to the corresponding array attribute.
  cumprod  --  Scalar method identical to the corresponding array attribute.
  cumsum  --  Scalar method identical to the corresponding array attribute.
  diagonal  --  Scalar method identical to the corresponding array attribute.
  dump  --  Scalar method identical to the corresponding array attribute.
  dumps  --  Scalar method identical to the corresponding array attribute.
  fill  --  Scalar method identical to the corresponding array attribute.
  flatten  --  Scalar method identical to the corresponding array attribute.
  getfield  --  Scalar method identical to the corresponding array attribute.
  is_integer  --  integer.is_integer() -&gt; bool
  item  --  Scalar method identical to the corresponding array attribute.
  max  --  Scalar method identical to the corresponding array attribute.
  mean  --  Scalar method identical to the corresponding array attribute.
  min  --  Scalar method identical to the corresponding array attribute.
  nonzero  --  Scalar method identical to the corresponding array attribute.
  prod  --  Scalar method identical to the corresponding array attribute.
  put  --  Scalar method identical to the corresponding array attribute.
  ravel  --  Scalar method identical to the corresponding array attribute.
  repeat  --  Scalar method identical to the corresponding array attribute.
  reshape  --  Scalar method identical to the corresponding array attribute.
  resize  --  Scalar method identical to the corresponding array attribute.
  round  --  Scalar method identical to the corresponding array attribute.
  searchsorted  --  Scalar method identical to the corresponding array attribute.
  setfield  --  Scalar method identical to the corresponding array attribute.
  setflags  --  Scalar method identical to the corresponding array attribute.
  sort  --  Scalar method identical to the corresponding array attribute.
  squeeze  --  Scalar method identical to the corresponding array attribute.
  std  --  Scalar method identical to the corresponding array attribute.
  sum  --  Scalar method identical to the corresponding array attribute.
  swapaxes  --  Scalar method identical to the corresponding array attribute.
  take  --  Scalar method identical to the corresponding array attribute.
  to_device  --  None
  tobytes  --  None
  tofile  --  Scalar method identical to the corresponding array attribute.
  tolist  --  Scalar method identical to the corresponding array attribute.
  tostring  --  Scalar method identical to the corresponding array attribute.
  trace  --  Scalar method identical to the corresponding array attribute.
  transpose  --  Scalar method identical to the corresponding array attribute.
  var  --  Scalar method identical to the corresponding array attribute.
  view  --  Scalar method identical to the corresponding array attribute.</code></pre>
</div>
</div>
<div id="8ad97d5c" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2022-01-19T10:09:20.037776Z&quot;,&quot;start_time&quot;:&quot;2022-01-19T10:09:20.031216Z&quot;}" data-execution_count="23">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>np.int16</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="23">
<pre><code>numpy.int16</code></pre>
</div>
</div>
<div id="6a0bbcb4" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2022-01-19T10:08:39.686116Z&quot;,&quot;start_time&quot;:&quot;2022-01-19T10:08:39.678619Z&quot;}" data-execution_count="24">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="bu">dict</span>(<span class="bu">enumerate</span>(a))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="24">
<pre><code>{0: np.int64(0),
 1: np.int64(1),
 2: np.int64(2),
 3: np.int64(3),
 4: np.int64(4),
 5: np.int64(5),
 6: np.int64(6),
 7: np.int64(7),
 8: np.int64(8),
 9: np.int64(9),
 10: np.int64(10),
 11: np.int64(11),
 12: np.int64(12),
 13: np.int64(13),
 14: np.int64(14),
 15: np.int64(15),
 16: np.int64(16),
 17: np.int64(17),
 18: np.int64(18),
 19: np.int64(19),
 20: np.int64(20),
 21: np.int64(21),
 22: np.int64(22),
 23: np.int64(23),
 24: np.int64(24),
 25: np.int64(25),
 26: np.int64(26),
 27: np.int64(27),
 28: np.int64(28),
 29: np.int64(29),
 30: np.int64(30),
 31: np.int64(31),
 32: np.int64(32),
 33: np.int64(33),
 34: np.int64(34),
 35: np.int64(35),
 36: np.int64(36),
 37: np.int64(37),
 38: np.int64(38),
 39: np.int64(39),
 40: np.int64(40),
 41: np.int64(41),
 42: np.int64(1025),
 43: np.int64(43),
 44: np.int64(44),
 45: np.int64(45),
 46: np.int64(46),
 47: np.int64(47),
 48: np.int64(48),
 49: np.int64(49),
 50: np.int64(50),
 51: np.int64(51),
 52: np.int64(52),
 53: np.int64(53),
 54: np.int64(54),
 55: np.int64(55),
 56: np.int64(56),
 57: np.int64(57),
 58: np.int64(58),
 59: np.int64(59),
 60: np.int64(60),
 61: np.int64(61),
 62: np.int64(62),
 63: np.int64(63),
 64: np.int64(64),
 65: np.int64(65),
 66: np.int64(66),
 67: np.int64(67),
 68: np.int64(68),
 69: np.int64(69),
 70: np.int64(70),
 71: np.int64(71),
 72: np.int64(72),
 73: np.int64(73),
 74: np.int64(74),
 75: np.int64(75),
 76: np.int64(76),
 77: np.int64(77),
 78: np.int64(78),
 79: np.int64(79),
 80: np.int64(80),
 81: np.int64(81),
 82: np.int64(82),
 83: np.int64(83),
 84: np.int64(84),
 85: np.int64(85),
 86: np.int64(86),
 87: np.int64(87),
 88: np.int64(88),
 89: np.int64(89),
 90: np.int64(90),
 91: np.int64(91),
 92: np.int64(92),
 93: np.int64(93),
 94: np.int64(94),
 95: np.int64(95),
 96: np.int64(96),
 97: np.int64(97),
 98: np.int64(98),
 99: np.int64(99)}</code></pre>
</div>
</div>
<div id="c3ec8dac" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2022-01-19T10:09:47.067438Z&quot;,&quot;start_time&quot;:&quot;2022-01-19T10:09:47.061548Z&quot;}" data-execution_count="25">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>a <span class="op">+</span> <span class="dv">1</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="25">
<pre><code>array([   1,    2,    3,    4,    5,    6,    7,    8,    9,   10,   11,
         12,   13,   14,   15,   16,   17,   18,   19,   20,   21,   22,
         23,   24,   25,   26,   27,   28,   29,   30,   31,   32,   33,
         34,   35,   36,   37,   38,   39,   40,   41,   42, 1026,   44,
         45,   46,   47,   48,   49,   50,   51,   52,   53,   54,   55,
         56,   57,   58,   59,   60,   61,   62,   63,   64,   65,   66,
         67,   68,   69,   70,   71,   72,   73,   74,   75,   76,   77,
         78,   79,   80,   81,   82,   83,   84,   85,   86,   87,   88,
         89,   90,   91,   92,   93,   94,   95,   96,   97,   98,   99,
        100])</code></pre>
</div>
</div>
<div id="0bfb6830" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2022-01-19T10:10:02.092179Z&quot;,&quot;start_time&quot;:&quot;2022-01-19T10:10:02.086622Z&quot;}" data-execution_count="26">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>b <span class="op">=</span> a <span class="op">+</span> <span class="dv">1</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>b</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="26">
<pre><code>array([   1,    2,    3,    4,    5,    6,    7,    8,    9,   10,   11,
         12,   13,   14,   15,   16,   17,   18,   19,   20,   21,   22,
         23,   24,   25,   26,   27,   28,   29,   30,   31,   32,   33,
         34,   35,   36,   37,   38,   39,   40,   41,   42, 1026,   44,
         45,   46,   47,   48,   49,   50,   51,   52,   53,   54,   55,
         56,   57,   58,   59,   60,   61,   62,   63,   64,   65,   66,
         67,   68,   69,   70,   71,   72,   73,   74,   75,   76,   77,
         78,   79,   80,   81,   82,   83,   84,   85,   86,   87,   88,
         89,   90,   91,   92,   93,   94,   95,   96,   97,   98,   99,
        100])</code></pre>
</div>
</div>
<div id="afaa9de2" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2022-01-19T10:10:12.761835Z&quot;,&quot;start_time&quot;:&quot;2022-01-19T10:10:12.756736Z&quot;}" data-execution_count="27">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>a <span class="kw">is</span> b</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="27">
<pre><code>False</code></pre>
</div>
</div>
<div id="6030d304" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2022-01-19T10:10:22.189001Z&quot;,&quot;start_time&quot;:&quot;2022-01-19T10:10:22.185209Z&quot;}" data-slideshow="{&quot;slide_type&quot;:&quot;subslide&quot;}" data-execution_count="28">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>f <span class="op">=</span> <span class="bu">id</span>(a)</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>a <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>f, <span class="bu">id</span>(a)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="28">
<pre><code>(137393579285968, 137393579285968)</code></pre>
</div>
</div>
<div id="21120289" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2022-01-19T10:10:23.392681Z&quot;,&quot;start_time&quot;:&quot;2022-01-19T10:10:23.387466Z&quot;}" data-execution_count="29">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>a</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="29">
<pre><code>array([   1,    2,    3,    4,    5,    6,    7,    8,    9,   10,   11,
         12,   13,   14,   15,   16,   17,   18,   19,   20,   21,   22,
         23,   24,   25,   26,   27,   28,   29,   30,   31,   32,   33,
         34,   35,   36,   37,   38,   39,   40,   41,   42, 1026,   44,
         45,   46,   47,   48,   49,   50,   51,   52,   53,   54,   55,
         56,   57,   58,   59,   60,   61,   62,   63,   64,   65,   66,
         67,   68,   69,   70,   71,   72,   73,   74,   75,   76,   77,
         78,   79,   80,   81,   82,   83,   84,   85,   86,   87,   88,
         89,   90,   91,   92,   93,   94,   95,   96,   97,   98,   99,
        100])</code></pre>
</div>
</div>
<div id="e8445a75" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2022-01-19T10:10:27.087595Z&quot;,&quot;start_time&quot;:&quot;2022-01-19T10:10:27.081763Z&quot;}" data-execution_count="30">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>b</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="30">
<pre><code>array([   1,    2,    3,    4,    5,    6,    7,    8,    9,   10,   11,
         12,   13,   14,   15,   16,   17,   18,   19,   20,   21,   22,
         23,   24,   25,   26,   27,   28,   29,   30,   31,   32,   33,
         34,   35,   36,   37,   38,   39,   40,   41,   42, 1026,   44,
         45,   46,   47,   48,   49,   50,   51,   52,   53,   54,   55,
         56,   57,   58,   59,   60,   61,   62,   63,   64,   65,   66,
         67,   68,   69,   70,   71,   72,   73,   74,   75,   76,   77,
         78,   79,   80,   81,   82,   83,   84,   85,   86,   87,   88,
         89,   90,   91,   92,   93,   94,   95,   96,   97,   98,   99,
        100])</code></pre>
</div>
</div>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Warning
</div>
</div>
<div class="callout-body-container callout-body">
<p>Beware of the dimensions: a 1D array is not the same as a 2D array with 1 column</p>
</div>
</div>
<div id="faaa496a" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2022-01-19T10:10:30.211477Z&quot;,&quot;start_time&quot;:&quot;2022-01-19T10:10:30.204724Z&quot;}" data-slideshow="{&quot;slide_type&quot;:&quot;-&quot;}" data-execution_count="31">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>a1 <span class="op">=</span> np.array([<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>])</span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(a1, a1.shape, a1.ndim)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1 2 3] (3,) 1</code></pre>
</div>
</div>
<div id="694d00de" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2022-01-19T10:11:39.470253Z&quot;,&quot;start_time&quot;:&quot;2022-01-19T10:11:39.465331Z&quot;}" data-execution_count="32">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>a2 <span class="op">=</span> np.array([<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>])</span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(a2, a2.shape, a2.ndim)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1 2 3] (3,) 1</code></pre>
</div>
</div>
<p><a href="https://numpy.org/devdocs/user/quickstart.html">More on NumPy quickstart</a></p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>List the attributes and methods of class <code>numpy.ndarray</code>. You may use function <code>dir()</code> and filter the result using methods for objects of class <code>string</code>.</p>
</div>
</div>
</section>
<section id="matrix-multiplication" class="level2">
<h2 class="anchored" data-anchor-id="matrix-multiplication">Matrix multiplication</h2>
<div id="f69e64b0" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2022-01-19T10:11:41.023400Z&quot;,&quot;start_time&quot;:&quot;2022-01-19T10:11:41.018032Z&quot;}" data-execution_count="33">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>a2.dot(a1) <span class="co"># inner product </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="33">
<pre><code>np.int64(14)</code></pre>
</div>
</div>
<div id="749df1fa" class="cell" data-execution_count="34">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>( </span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>    np.array([a2])</span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a>        .transpose() <span class="co"># column vector</span></span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a>        .dot(np.array([a1]))</span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a>) <span class="co"># column vector multiplied by row vector</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="34">
<pre><code>array([[1, 2, 3],
       [2, 4, 6],
       [3, 6, 9]])</code></pre>
</div>
</div>
<div id="917f6338" class="cell" data-execution_count="35">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>    np.array([a2])</span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a>    .transpose()<span class="co">#.shape</span></span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="35">
<pre><code>array([[1],
       [2],
       [3]])</code></pre>
</div>
</div>
<div id="90f5e03f" class="cell" data-execution_count="36">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a>    a2.reshape(<span class="dv">3</span>,<span class="dv">1</span>)  <span class="co"># all explicit</span></span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a>      .dot(a1.reshape(<span class="dv">1</span>, <span class="dv">3</span>))</span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="36">
<pre><code>array([[1, 2, 3],
       [2, 4, 6],
       [3, 6, 9]])</code></pre>
</div>
</div>
<div id="3726b578" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2022-01-19T10:11:55.636179Z&quot;,&quot;start_time&quot;:&quot;2022-01-19T10:11:55.630699Z&quot;}" data-slideshow="{&quot;slide_type&quot;:&quot;subslide&quot;}" data-execution_count="37">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Declare a 2D array using a nested list as the constructor argument</span></span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a>M <span class="op">=</span> np.array([[<span class="dv">1</span>,<span class="dv">2</span>], </span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a>              [<span class="dv">3</span>,<span class="dv">4</span>], </span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a>              [<span class="fl">3.14</span>, <span class="op">-</span><span class="fl">9.17</span>]])</span>
<span id="cb69-5"><a href="#cb69-5" aria-hidden="true" tabindex="-1"></a>M</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="37">
<pre><code>array([[ 1.  ,  2.  ],
       [ 3.  ,  4.  ],
       [ 3.14, -9.17]])</code></pre>
</div>
</div>
<div id="21584400" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2022-01-19T10:11:55.792686Z&quot;,&quot;start_time&quot;:&quot;2022-01-19T10:11:55.787196Z&quot;}" data-execution_count="38">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a>M.shape, M.size</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="38">
<pre><code>((3, 2), 6)</code></pre>
</div>
</div>
<div id="d184699e" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2022-01-19T10:12:05.624781Z&quot;,&quot;start_time&quot;:&quot;2022-01-19T10:12:05.619551Z&quot;}" data-execution_count="39">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a>M.ravel(), M.ndim, M.ravel().shape</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="39">
<pre><code>(array([ 1.  ,  2.  ,  3.  ,  4.  ,  3.14, -9.17]), 2, (6,))</code></pre>
</div>
</div>
<div id="2f5e5541" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2022-01-19T10:12:32.331344Z&quot;,&quot;start_time&quot;:&quot;2022-01-19T10:12:32.325181Z&quot;}" data-slideshow="{&quot;slide_type&quot;:&quot;subslide&quot;}" data-execution_count="40">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="co"># arguments: start, stop, step</span></span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> (</span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a>     np.arange(<span class="dv">12</span>)</span>
<span id="cb75-4"><a href="#cb75-4" aria-hidden="true" tabindex="-1"></a>       .reshape(<span class="dv">4</span>, <span class="dv">3</span>)</span>
<span id="cb75-5"><a href="#cb75-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb75-6"><a href="#cb75-6" aria-hidden="true" tabindex="-1"></a>x</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="40">
<pre><code>array([[ 0,  1,  2],
       [ 3,  4,  5],
       [ 6,  7,  8],
       [ 9, 10, 11]])</code></pre>
</div>
</div>
<div id="2893dc20" class="cell" data-execution_count="41">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> np.arange(<span class="dv">3</span>).reshape(<span class="dv">3</span>,<span class="dv">1</span>)</span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a>y</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="41">
<pre><code>array([[0],
       [1],
       [2]])</code></pre>
</div>
</div>
<div id="f2f0f286" class="cell" data-execution_count="42">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a>x <span class="op">@</span> y, x.dot(y)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="42">
<pre><code>(array([[ 5],
        [14],
        [23],
        [32]]),
 array([[ 5],
        [14],
        [23],
        [32]]))</code></pre>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">

</div>
</div>
</section>
<section id="generating-arrays" class="level2">
<h2 class="anchored" data-anchor-id="generating-arrays">Generating arrays</h2>
<div id="5581d596" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2022-01-19T10:12:34.268059Z&quot;,&quot;start_time&quot;:&quot;2022-01-19T10:12:34.260897Z&quot;}" data-execution_count="43">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a>np.linspace(<span class="dv">0</span>, <span class="dv">10</span>, <span class="dv">51</span>)  <span class="co"># meaning of the 3 positional parameters ? </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="43">
<pre><code>array([ 0. ,  0.2,  0.4,  0.6,  0.8,  1. ,  1.2,  1.4,  1.6,  1.8,  2. ,
        2.2,  2.4,  2.6,  2.8,  3. ,  3.2,  3.4,  3.6,  3.8,  4. ,  4.2,
        4.4,  4.6,  4.8,  5. ,  5.2,  5.4,  5.6,  5.8,  6. ,  6.2,  6.4,
        6.6,  6.8,  7. ,  7.2,  7.4,  7.6,  7.8,  8. ,  8.2,  8.4,  8.6,
        8.8,  9. ,  9.2,  9.4,  9.6,  9.8, 10. ])</code></pre>
</div>
</div>
<div id="988cde4e" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2022-01-19T10:13:05.893229Z&quot;,&quot;start_time&quot;:&quot;2022-01-19T10:13:05.887241Z&quot;}" data-slideshow="{&quot;slide_type&quot;:&quot;-&quot;}" data-execution_count="44">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a>np.logspace(<span class="dv">0</span>, <span class="dv">10</span>, <span class="dv">11</span>, base<span class="op">=</span>np.e), np.e<span class="op">**</span>(np.arange(<span class="dv">11</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="44">
<pre><code>(array([1.00000000e+00, 2.71828183e+00, 7.38905610e+00, 2.00855369e+01,
        5.45981500e+01, 1.48413159e+02, 4.03428793e+02, 1.09663316e+03,
        2.98095799e+03, 8.10308393e+03, 2.20264658e+04]),
 array([1.00000000e+00, 2.71828183e+00, 7.38905610e+00, 2.00855369e+01,
        5.45981500e+01, 1.48413159e+02, 4.03428793e+02, 1.09663316e+03,
        2.98095799e+03, 8.10308393e+03, 2.20264658e+04]))</code></pre>
</div>
</div>
<div id="2cfb445c" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2022-01-19T10:14:43.385320Z&quot;,&quot;start_time&quot;:&quot;2022-01-19T10:14:43.273674Z&quot;}" data-slideshow="{&quot;slide_type&quot;:&quot;subslide&quot;}" data-execution_count="45">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-3"><a href="#cb85-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Random standard Gaussian numbers</span></span>
<span id="cb85-4"><a href="#cb85-4" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> plt.figure(figsize<span class="op">=</span>(<span class="dv">8</span>, <span class="dv">4</span>))</span>
<span id="cb85-5"><a href="#cb85-5" aria-hidden="true" tabindex="-1"></a>wn <span class="op">=</span> np.random.randn(<span class="dv">1000</span>)</span>
<span id="cb85-6"><a href="#cb85-6" aria-hidden="true" tabindex="-1"></a>bm <span class="op">=</span> wn.cumsum()</span>
<span id="cb85-7"><a href="#cb85-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-8"><a href="#cb85-8" aria-hidden="true" tabindex="-1"></a>plt.plot(bm, lw<span class="op">=</span><span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="notebook02_numpy_files/figure-html/cell-46-output-1.png" width="652" height="337" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="4579ad9c" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2022-01-19T10:14:46.379228Z&quot;,&quot;start_time&quot;:&quot;2022-01-19T10:14:46.373157Z&quot;}" data-slideshow="{&quot;slide_type&quot;:&quot;subslide&quot;}" data-execution_count="46">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a>np.diag(np.arange(<span class="dv">10</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="46">
<pre><code>array([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
       [0, 1, 0, 0, 0, 0, 0, 0, 0, 0],
       [0, 0, 2, 0, 0, 0, 0, 0, 0, 0],
       [0, 0, 0, 3, 0, 0, 0, 0, 0, 0],
       [0, 0, 0, 0, 4, 0, 0, 0, 0, 0],
       [0, 0, 0, 0, 0, 5, 0, 0, 0, 0],
       [0, 0, 0, 0, 0, 0, 6, 0, 0, 0],
       [0, 0, 0, 0, 0, 0, 0, 7, 0, 0],
       [0, 0, 0, 0, 0, 0, 0, 0, 8, 0],
       [0, 0, 0, 0, 0, 0, 0, 0, 0, 9]])</code></pre>
</div>
</div>
<div id="6b6876d1" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2022-01-19T10:15:19.746421Z&quot;,&quot;start_time&quot;:&quot;2022-01-19T10:15:19.740184Z&quot;}" data-slideshow="{&quot;slide_type&quot;:&quot;-&quot;}" data-execution_count="47">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a>zozo <span class="op">=</span> np.zeros((<span class="dv">10</span>, <span class="dv">10</span>), dtype<span class="op">=</span>np.float32)</span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a>zozo</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="47">
<pre><code>array([[0., 0., 0., 0., 0., 0., 0., 0., 0., 0.],
       [0., 0., 0., 0., 0., 0., 0., 0., 0., 0.],
       [0., 0., 0., 0., 0., 0., 0., 0., 0., 0.],
       [0., 0., 0., 0., 0., 0., 0., 0., 0., 0.],
       [0., 0., 0., 0., 0., 0., 0., 0., 0., 0.],
       [0., 0., 0., 0., 0., 0., 0., 0., 0., 0.],
       [0., 0., 0., 0., 0., 0., 0., 0., 0., 0.],
       [0., 0., 0., 0., 0., 0., 0., 0., 0., 0.],
       [0., 0., 0., 0., 0., 0., 0., 0., 0., 0.],
       [0., 0., 0., 0., 0., 0., 0., 0., 0., 0.]], dtype=float32)</code></pre>
</div>
</div>
<div id="99e8703e" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2022-01-19T10:15:25.983891Z&quot;,&quot;start_time&quot;:&quot;2022-01-19T10:15:25.979180Z&quot;}" data-slideshow="{&quot;slide_type&quot;:&quot;-&quot;}" data-execution_count="48">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a>zozo.shape</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="48">
<pre><code>(10, 10)</code></pre>
</div>
</div>
<div id="410921c4" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2022-01-19T10:15:28.982811Z&quot;,&quot;start_time&quot;:&quot;2022-01-19T10:15:28.978770Z&quot;}" data-slideshow="{&quot;slide_type&quot;:&quot;subslide&quot;}" data-execution_count="49">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(M)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[[ 1.    2.  ]
 [ 3.    4.  ]
 [ 3.14 -9.17]]</code></pre>
</div>
</div>
<div id="ecf048e8" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2022-01-19T10:15:29.424077Z&quot;,&quot;start_time&quot;:&quot;2022-01-19T10:15:29.418759Z&quot;}" data-execution_count="50">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a>M[<span class="dv">1</span>, <span class="dv">1</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="50">
<pre><code>np.float64(4.0)</code></pre>
</div>
</div>
<div id="aa08e1c2" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2022-01-19T10:16:19.133869Z&quot;,&quot;start_time&quot;:&quot;2022-01-19T10:16:19.128542Z&quot;}" data-slideshow="{&quot;slide_type&quot;:&quot;-&quot;}" data-execution_count="51">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a><span class="co"># assign new value</span></span>
<span id="cb96-2"><a href="#cb96-2" aria-hidden="true" tabindex="-1"></a>M[<span class="dv">0</span>, <span class="dv">0</span>] <span class="op">=</span> <span class="dv">7</span></span>
<span id="cb96-3"><a href="#cb96-3" aria-hidden="true" tabindex="-1"></a>M[:, <span class="dv">0</span>] <span class="op">=</span> <span class="dv">42</span></span>
<span id="cb96-4"><a href="#cb96-4" aria-hidden="true" tabindex="-1"></a>M</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="51">
<pre><code>array([[42.  ,  2.  ],
       [42.  ,  4.  ],
       [42.  , -9.17]])</code></pre>
</div>
</div>
<div id="461fa54d" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2022-01-19T10:16:56.907063Z&quot;,&quot;start_time&quot;:&quot;2022-01-19T10:16:56.901415Z&quot;}" data-execution_count="52">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a>M</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="52">
<pre><code>array([[42.  ,  2.  ],
       [42.  ,  4.  ],
       [42.  , -9.17]])</code></pre>
</div>
</div>
<div id="94b38dc6" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2022-01-19T10:16:44.838732Z&quot;,&quot;start_time&quot;:&quot;2022-01-19T10:16:44.832758Z&quot;}" data-execution_count="53">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Warning: the next m is a **view** on M. </span></span>
<span id="cb100-2"><a href="#cb100-2" aria-hidden="true" tabindex="-1"></a><span class="co"># One again, no copies unless you ask for one!</span></span>
<span id="cb100-3"><a href="#cb100-3" aria-hidden="true" tabindex="-1"></a>m <span class="op">=</span> M[<span class="dv">0</span>, :]</span>
<span id="cb100-4"><a href="#cb100-4" aria-hidden="true" tabindex="-1"></a>m</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="53">
<pre><code>array([42.,  2.])</code></pre>
</div>
</div>
<div id="4422d206" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2022-01-19T10:17:45.614910Z&quot;,&quot;start_time&quot;:&quot;2022-01-19T10:17:45.609735Z&quot;}" data-execution_count="54">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a>m[:] <span class="op">=</span> <span class="fl">3.14</span></span>
<span id="cb102-2"><a href="#cb102-2" aria-hidden="true" tabindex="-1"></a>M</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="54">
<pre><code>array([[ 3.14,  3.14],
       [42.  ,  4.  ],
       [42.  , -9.17]])</code></pre>
</div>
</div>
<div id="92169102" class="cell" data-execution_count="55">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb104"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a>m[:] <span class="op">=</span> <span class="dv">7</span></span>
<span id="cb104-2"><a href="#cb104-2" aria-hidden="true" tabindex="-1"></a>M</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="55">
<pre><code>array([[ 7.  ,  7.  ],
       [42.  ,  4.  ],
       [42.  , -9.17]])</code></pre>
</div>
</div>
</section>
<section id="slicing" class="level1">
<h1>Slicing</h1>
<div id="8f4591c0" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2022-01-19T10:19:44.021962Z&quot;,&quot;start_time&quot;:&quot;2022-01-19T10:19:44.015749Z&quot;}" data-slideshow="{&quot;slide_type&quot;:&quot;subslide&quot;}" data-execution_count="56">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb106"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a><span class="co"># slicing works just like with anything else (lists, etc.)</span></span>
<span id="cb106-2"><a href="#cb106-2" aria-hidden="true" tabindex="-1"></a>A <span class="op">=</span> np.array([<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>])</span>
<span id="cb106-3"><a href="#cb106-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(A)</span>
<span id="cb106-4"><a href="#cb106-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(A[::<span class="op">-</span><span class="dv">1</span>])</span>
<span id="cb106-5"><a href="#cb106-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(A[::<span class="dv">2</span>])</span>
<span id="cb106-6"><a href="#cb106-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(A[:<span class="op">-</span><span class="dv">1</span>:<span class="dv">2</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1 2 3 4 5]
[5 4 3 2 1]
[1 3 5]
[1 3]</code></pre>
</div>
</div>
<div id="b6afabaf" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2022-01-19T10:20:08.103594Z&quot;,&quot;start_time&quot;:&quot;2022-01-19T10:20:08.097276Z&quot;}" data-execution_count="57">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb108"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a>[[n <span class="op">+</span> m <span class="op">*</span> <span class="dv">10</span> <span class="cf">for</span> n <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">5</span>)] <span class="cf">for</span> m <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">5</span>)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="57">
<pre><code>[[0, 1, 2, 3, 4],
 [10, 11, 12, 13, 14],
 [20, 21, 22, 23, 24],
 [30, 31, 32, 33, 34],
 [40, 41, 42, 43, 44]]</code></pre>
</div>
</div>
<div id="2e43ceba" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2022-01-19T10:20:28.427508Z&quot;,&quot;start_time&quot;:&quot;2022-01-19T10:20:28.422319Z&quot;}" data-execution_count="58">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb110"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a>A <span class="op">=</span> np.array([[n <span class="op">+</span> m <span class="op">*</span> <span class="dv">10</span> <span class="cf">for</span> n <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">5</span>)] <span class="cf">for</span> m <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">5</span>)])</span>
<span id="cb110-2"><a href="#cb110-2" aria-hidden="true" tabindex="-1"></a>A</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="58">
<pre><code>array([[ 0,  1,  2,  3,  4],
       [10, 11, 12, 13, 14],
       [20, 21, 22, 23, 24],
       [30, 31, 32, 33, 34],
       [40, 41, 42, 43, 44]])</code></pre>
</div>
</div>
<div id="06ebaab9" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2022-01-19T10:20:57.347620Z&quot;,&quot;start_time&quot;:&quot;2022-01-19T10:20:57.343219Z&quot;}" data-slideshow="{&quot;slide_type&quot;:&quot;subslide&quot;}" data-execution_count="59">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb112"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(A[<span class="dv">1</span>:<span class="dv">4</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[[10 11 12 13 14]
 [20 21 22 23 24]
 [30 31 32 33 34]]</code></pre>
</div>
</div>
<div id="137346e5" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2022-01-19T10:21:15.952179Z&quot;,&quot;start_time&quot;:&quot;2022-01-19T10:21:15.948641Z&quot;}" data-execution_count="60">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb114"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a>m <span class="op">=</span> A[:, <span class="dv">1</span>:<span class="dv">4</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div id="08f3a94a" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2022-01-19T10:21:22.878446Z&quot;,&quot;start_time&quot;:&quot;2022-01-19T10:21:22.874600Z&quot;}" data-execution_count="61">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb115"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a>m[<span class="dv">1</span>, <span class="dv">1</span>] <span class="op">=</span> <span class="dv">123</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div id="4d203847" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2022-01-19T10:21:24.877152Z&quot;,&quot;start_time&quot;:&quot;2022-01-19T10:21:24.871364Z&quot;}" data-execution_count="62">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb116"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a>A</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="62">
<pre><code>array([[  0,   1,   2,   3,   4],
       [ 10,  11, 123,  13,  14],
       [ 20,  21,  22,  23,  24],
       [ 30,  31,  32,  33,  34],
       [ 40,  41,  42,  43,  44]])</code></pre>
</div>
</div>
<div id="f7824a9e" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2022-01-19T10:21:35.679054Z&quot;,&quot;start_time&quot;:&quot;2022-01-19T10:21:35.674159Z&quot;}" data-execution_count="63">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb118"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true" tabindex="-1"></a>A[<span class="dv">1</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="63">
<pre><code>array([ 10,  11, 123,  13,  14])</code></pre>
</div>
</div>
<div id="95bada8b" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2022-01-19T10:21:36.493496Z&quot;,&quot;start_time&quot;:&quot;2022-01-19T10:21:36.487589Z&quot;}" data-execution_count="64">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb120"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb120-1"><a href="#cb120-1" aria-hidden="true" tabindex="-1"></a>A[:, <span class="dv">1</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="64">
<pre><code>array([ 1, 11, 21, 31, 41])</code></pre>
</div>
</div>
<div id="bb9b730f" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2022-01-19T10:22:13.690836Z&quot;,&quot;start_time&quot;:&quot;2022-01-19T10:22:13.685191Z&quot;}" data-execution_count="65">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb122"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb122-1"><a href="#cb122-1" aria-hidden="true" tabindex="-1"></a>A[:, ::<span class="op">-</span><span class="dv">1</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="65">
<pre><code>array([[  4,   3,   2,   1,   0],
       [ 14,  13, 123,  11,  10],
       [ 24,  23,  22,  21,  20],
       [ 34,  33,  32,  31,  30],
       [ 44,  43,  42,  41,  40]])</code></pre>
</div>
</div>
<div id="318ade26" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2022-01-19T10:22:13.893926Z&quot;,&quot;start_time&quot;:&quot;2022-01-19T10:22:13.890163Z&quot;}" data-slideshow="{&quot;slide_type&quot;:&quot;subslide&quot;}" data-execution_count="66">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb124"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb124-1"><a href="#cb124-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(A)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[[  0   1   2   3   4]
 [ 10  11 123  13  14]
 [ 20  21  22  23  24]
 [ 30  31  32  33  34]
 [ 40  41  42  43  44]]</code></pre>
</div>
</div>
<div id="22ea85d2" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2022-01-19T10:22:59.881914Z&quot;,&quot;start_time&quot;:&quot;2022-01-19T10:22:59.877820Z&quot;}" data-execution_count="67">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb126"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb126-1"><a href="#cb126-1" aria-hidden="true" tabindex="-1"></a>row_indices <span class="op">=</span> np.array([<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">4</span>])</span>
<span id="cb126-2"><a href="#cb126-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(A[row_indices])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[[ 10  11 123  13  14]
 [ 20  21  22  23  24]
 [ 40  41  42  43  44]]</code></pre>
</div>
</div>
<div id="6dd4ccaf" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2022-01-19T10:23:06.495460Z&quot;,&quot;start_time&quot;:&quot;2022-01-19T10:23:06.490235Z&quot;}" data-execution_count="68">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb128"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb128-1"><a href="#cb128-1" aria-hidden="true" tabindex="-1"></a>A[:, row_indices]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="68">
<pre><code>array([[  1,   2,   4],
       [ 11, 123,  14],
       [ 21,  22,  24],
       [ 31,  32,  34],
       [ 41,  42,  44]])</code></pre>
</div>
</div>
<p>Another way is through masking with an array of <code>bool</code>s</p>
<div id="78bf1c89" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2022-01-19T10:23:28.237730Z&quot;,&quot;start_time&quot;:&quot;2022-01-19T10:23:28.230508Z&quot;}" data-slideshow="{&quot;slide_type&quot;:&quot;-&quot;}" data-execution_count="69">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb130"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb130-1"><a href="#cb130-1" aria-hidden="true" tabindex="-1"></a><span class="co"># index masking</span></span>
<span id="cb130-2"><a href="#cb130-2" aria-hidden="true" tabindex="-1"></a>B <span class="op">=</span> np.arange(<span class="dv">5</span>)</span>
<span id="cb130-3"><a href="#cb130-3" aria-hidden="true" tabindex="-1"></a>row_mask <span class="op">=</span> np.array([<span class="va">True</span>, <span class="va">False</span>, <span class="va">True</span>, <span class="va">False</span>, <span class="va">False</span>])</span>
<span id="cb130-4"><a href="#cb130-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(B)</span>
<span id="cb130-5"><a href="#cb130-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(B[row_mask])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[0 1 2 3 4]
[0 2]</code></pre>
</div>
</div>
<div id="cd6177ff" class="cell" data-execution_count="70">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb132"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb132-1"><a href="#cb132-1" aria-hidden="true" tabindex="-1"></a>A, A[row_mask] , A[:,row_mask]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="70">
<pre><code>(array([[  0,   1,   2,   3,   4],
        [ 10,  11, 123,  13,  14],
        [ 20,  21,  22,  23,  24],
        [ 30,  31,  32,  33,  34],
        [ 40,  41,  42,  43,  44]]),
 array([[ 0,  1,  2,  3,  4],
        [20, 21, 22, 23, 24]]),
 array([[  0,   2],
        [ 10, 123],
        [ 20,  22],
        [ 30,  32],
        [ 40,  42]]))</code></pre>
</div>
</div>
<section id="copies" class="level2">
<h2 class="anchored" data-anchor-id="copies">Copies</h2>
<p>Don’t forget that <code>python</code> <em>does not make copies unless told to do so</em> (same as with any mutable type)</p>
<p>If you are not careful enough, this typically leads to a <em>lot of errors</em> and to being fired !!</p>
<div id="7203d391" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2022-01-19T10:23:51.294522Z&quot;,&quot;start_time&quot;:&quot;2022-01-19T10:23:51.288358Z&quot;}" data-slideshow="{&quot;slide_type&quot;:&quot;-&quot;}" data-execution_count="71">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb134"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb134-1"><a href="#cb134-1" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> x <span class="op">=</span> np.arange(<span class="dv">6</span>)</span>
<span id="cb134-2"><a href="#cb134-2" aria-hidden="true" tabindex="-1"></a>x[<span class="dv">2</span>] <span class="op">=</span> <span class="dv">123</span></span>
<span id="cb134-3"><a href="#cb134-3" aria-hidden="true" tabindex="-1"></a>y</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="71">
<pre><code>array([  0,   1, 123,   3,   4,   5])</code></pre>
</div>
</div>
<div id="c6fce2f1" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2022-01-19T10:24:34.145203Z&quot;,&quot;start_time&quot;:&quot;2022-01-19T10:24:34.140801Z&quot;}" data-execution_count="72">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb136"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb136-1"><a href="#cb136-1" aria-hidden="true" tabindex="-1"></a>x <span class="kw">is</span> y</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="72">
<pre><code>True</code></pre>
</div>
</div>
<div id="c666d4ca" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2022-01-19T10:24:38.815817Z&quot;,&quot;start_time&quot;:&quot;2022-01-19T10:24:38.811878Z&quot;}" data-slideshow="{&quot;slide_type&quot;:&quot;subslide&quot;}" data-execution_count="73">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb138"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb138-1"><a href="#cb138-1" aria-hidden="true" tabindex="-1"></a><span class="co"># A real copy</span></span>
<span id="cb138-2"><a href="#cb138-2" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> x.copy()</span>
<span id="cb138-3"><a href="#cb138-3" aria-hidden="true" tabindex="-1"></a>x <span class="kw">is</span> y </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="73">
<pre><code>False</code></pre>
</div>
</div>
<div id="32e0521f" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2022-01-19T10:24:57.551439Z&quot;,&quot;start_time&quot;:&quot;2022-01-19T10:24:57.548073Z&quot;}" data-execution_count="74">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb140"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb140-1"><a href="#cb140-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Or equivalently (but the one above is better...)</span></span>
<span id="cb140-2"><a href="#cb140-2" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> np.copy(x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div id="a909b56f" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2022-01-19T10:24:57.733643Z&quot;,&quot;start_time&quot;:&quot;2022-01-19T10:24:57.727390Z&quot;}" data-execution_count="75">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb141"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb141-1"><a href="#cb141-1" aria-hidden="true" tabindex="-1"></a>x[<span class="dv">0</span>] <span class="op">=</span> <span class="op">-</span><span class="dv">12</span></span>
<span id="cb141-2"><a href="#cb141-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(x, y, x <span class="kw">is</span> y)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[-12   1 123   3   4   5] [  0   1 123   3   4   5] False</code></pre>
</div>
</div>
<p>To put values of x in y (copy values into an <strong>existing</strong> array) use</p>
<div id="d303474c" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2022-01-19T10:27:00.707987Z&quot;,&quot;start_time&quot;:&quot;2022-01-19T10:27:00.703474Z&quot;}" data-execution_count="76">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb143"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb143-1"><a href="#cb143-1" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.random.randn(<span class="dv">10</span>)</span>
<span id="cb143-2"><a href="#cb143-2" aria-hidden="true" tabindex="-1"></a>x, <span class="bu">id</span>(x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="76">
<pre><code>(array([ 0.34735265,  0.38783658, -0.01660985, -0.14114233, -0.27206558,
        -0.97844654,  0.69630894,  0.18247432,  0.91764587, -1.26549418]),
 137393486622672)</code></pre>
</div>
</div>
<div id="3387d6d0" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2022-01-19T10:27:35.874585Z&quot;,&quot;start_time&quot;:&quot;2022-01-19T10:27:35.871235Z&quot;}" data-execution_count="77">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb145"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb145-1"><a href="#cb145-1" aria-hidden="true" tabindex="-1"></a>x.fill(<span class="fl">2.78</span>)   <span class="co"># in place. </span></span>
<span id="cb145-2"><a href="#cb145-2" aria-hidden="true" tabindex="-1"></a>x, <span class="bu">id</span>(x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="77">
<pre><code>(array([2.78, 2.78, 2.78, 2.78, 2.78, 2.78, 2.78, 2.78, 2.78, 2.78]),
 137393486622672)</code></pre>
</div>
</div>
<div id="2f85c340" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2022-01-19T10:27:39.785341Z&quot;,&quot;start_time&quot;:&quot;2022-01-19T10:27:39.782357Z&quot;}" data-execution_count="78">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb147"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb147-1"><a href="#cb147-1" aria-hidden="true" tabindex="-1"></a>x[:] <span class="op">=</span> <span class="fl">3.14</span>  <span class="co"># x.fill(3.14)  can. be chained ...</span></span>
<span id="cb147-2"><a href="#cb147-2" aria-hidden="true" tabindex="-1"></a>x, <span class="bu">id</span>(x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="78">
<pre><code>(array([3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14, 3.14]),
 137393486622672)</code></pre>
</div>
</div>
<div id="c97d39cb" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2022-01-19T10:29:03.422782Z&quot;,&quot;start_time&quot;:&quot;2022-01-19T10:29:03.418965Z&quot;}" data-execution_count="79">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb149"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb149-1"><a href="#cb149-1" aria-hidden="true" tabindex="-1"></a>x[:] <span class="op">=</span> np.random.randn(x.shape[<span class="dv">0</span>])</span>
<span id="cb149-2"><a href="#cb149-2" aria-hidden="true" tabindex="-1"></a>x, <span class="bu">id</span>(x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="79">
<pre><code>(array([ 0.26189023, -1.95759172, -2.0419464 ,  0.32512999,  0.73671901,
        -2.24966756,  0.9421588 ,  0.52023431, -0.10153539, -0.29100377]),
 137393486622672)</code></pre>
</div>
</div>
<div id="3fb61e17" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2022-01-19T10:29:05.933501Z&quot;,&quot;start_time&quot;:&quot;2022-01-19T10:29:05.929790Z&quot;}" data-execution_count="80">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb151"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb151-1"><a href="#cb151-1" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> np.empty(x.shape)  <span class="co"># how does empty() work ?</span></span>
<span id="cb151-2"><a href="#cb151-2" aria-hidden="true" tabindex="-1"></a>y, <span class="bu">id</span>(y)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="80">
<pre><code>(array([0.26189023, 1.95759172, 2.0419464 , 0.32512999, 0.73671901,
        2.24966756, 0.9421588 , 0.52023431, 0.10153539, 0.29100377]),
 137393486622384)</code></pre>
</div>
</div>
<div id="7a51c149" class="cell" data-execution_count="81">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb153"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb153-1"><a href="#cb153-1" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> x</span>
<span id="cb153-2"><a href="#cb153-2" aria-hidden="true" tabindex="-1"></a>y, <span class="bu">id</span>(y), <span class="bu">id</span>(x), y <span class="kw">is</span> x</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="81">
<pre><code>(array([ 0.26189023, -1.95759172, -2.0419464 ,  0.32512999,  0.73671901,
        -2.24966756,  0.9421588 ,  0.52023431, -0.10153539, -0.29100377]),
 137393486622672,
 137393486622672,
 True)</code></pre>
</div>
</div>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Final warning
</div>
</div>
<div class="callout-body-container callout-body">

</div>
</div>
<p>In the next line you copy the values of <code>x</code> into an existing array <code>y</code> (of same size…)</p>
<div id="14550229" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2022-01-19T10:29:26.993302Z&quot;,&quot;start_time&quot;:&quot;2022-01-19T10:29:26.989487Z&quot;}" data-slideshow="{&quot;slide_type&quot;:&quot;-&quot;}" data-execution_count="82">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb155"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb155-1"><a href="#cb155-1" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> np.zeros(x.shape)</span>
<span id="cb155-2"><a href="#cb155-2" aria-hidden="true" tabindex="-1"></a>y[:] <span class="op">=</span> x</span>
<span id="cb155-3"><a href="#cb155-3" aria-hidden="true" tabindex="-1"></a>y, y <span class="kw">is</span> x, np.<span class="bu">all</span>(y<span class="op">==</span>x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="82">
<pre><code>(array([ 0.26189023, -1.95759172, -2.0419464 ,  0.32512999,  0.73671901,
        -2.24966756,  0.9421588 ,  0.52023431, -0.10153539, -0.29100377]),
 False,
 np.True_)</code></pre>
</div>
</div>
<p>While in the next line, you are aliasing, you are giving a new name <code>y</code> to the object named <code>x</code> (you should <strong>never, ever</strong> write something like this)</p>
<div id="e16e1ac9" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2022-01-19T10:30:11.677048Z&quot;,&quot;start_time&quot;:&quot;2022-01-19T10:30:11.673812Z&quot;}" data-slideshow="{&quot;slide_type&quot;:&quot;-&quot;}" data-execution_count="83">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb157"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb157-1"><a href="#cb157-1" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> x</span>
<span id="cb157-2"><a href="#cb157-2" aria-hidden="true" tabindex="-1"></a>y <span class="kw">is</span> x</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="83">
<pre><code>True</code></pre>
</div>
</div>
</section>
<section id="miscellanea" class="level2">
<h2 class="anchored" data-anchor-id="miscellanea">Miscellanea</h2>
<section id="non-numerical-values" class="level3">
<h3 class="anchored" data-anchor-id="non-numerical-values">Non-numerical values</h3>
<p>A <code>numpy</code> array can contain other things than numeric types</p>
<div id="b777703b" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2022-01-19T10:30:12.402445Z&quot;,&quot;start_time&quot;:&quot;2022-01-19T10:30:12.399156Z&quot;}" data-slideshow="{&quot;slide_type&quot;:&quot;-&quot;}" data-execution_count="84">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb159"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb159-1"><a href="#cb159-1" aria-hidden="true" tabindex="-1"></a>arr <span class="op">=</span> np.array([<span class="st">'Labore'</span>, <span class="st">'neque'</span>, <span class="st">'ipsum'</span>, <span class="st">'ut'</span>, <span class="st">'non'</span>, <span class="st">'quiquia'</span>, <span class="st">'dolore.'</span>])</span>
<span id="cb159-2"><a href="#cb159-2" aria-hidden="true" tabindex="-1"></a>arr, arr.shape, arr.dtype</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="84">
<pre><code>(array(['Labore', 'neque', 'ipsum', 'ut', 'non', 'quiquia', 'dolore.'],
       dtype='&lt;U7'),
 (7,),
 dtype('&lt;U7'))</code></pre>
</div>
</div>
<div id="8676521c" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2022-01-19T10:30:14.073657Z&quot;,&quot;start_time&quot;:&quot;2022-01-19T10:30:14.062255Z&quot;}" data-slideshow="{&quot;slide_type&quot;:&quot;subslide&quot;}" data-execution_count="85">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb161"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb161-1"><a href="#cb161-1" aria-hidden="true" tabindex="-1"></a><span class="co"># arr.sum()</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div id="a882ae2f" class="cell" data-slideshow="{&quot;slide_type&quot;:&quot;subslide&quot;}" data-execution_count="86">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb162"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb162-1"><a href="#cb162-1" aria-hidden="true" tabindex="-1"></a><span class="co">"_"</span>.join(arr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="86">
<pre><code>'Labore_neque_ipsum_ut_non_quiquia_dolore.'</code></pre>
</div>
</div>
<div id="2c768277" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2022-01-19T10:30:46.274448Z&quot;,&quot;start_time&quot;:&quot;2022-01-19T10:30:46.269678Z&quot;}" data-slideshow="{&quot;slide_type&quot;:&quot;fragment&quot;}" data-execution_count="87">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb164"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb164-1"><a href="#cb164-1" aria-hidden="true" tabindex="-1"></a>arr.dtype</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="87">
<pre><code>dtype('&lt;U7')</code></pre>
</div>
</div>
</section>
</section>
<section id="a-matrix-is-no-2d-array-in-numpy" class="level2">
<h2 class="anchored" data-anchor-id="a-matrix-is-no-2d-array-in-numpy">A matrix is no 2D array in <code>numpy</code></h2>
<p>So far, we have only used <code>array</code> or <code>ndarray</code> objects</p>
<p>The is another type: the <code>matrix</code> type</p>
<p>In words: <strong>don’t use it</strong> (IMhO) and stick with arrays</p>
<div id="ea718f2a" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2022-01-19T10:31:48.972264Z&quot;,&quot;start_time&quot;:&quot;2022-01-19T10:31:48.968244Z&quot;}" data-slideshow="{&quot;slide_type&quot;:&quot;-&quot;}" data-execution_count="88">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb166"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb166-1"><a href="#cb166-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Matrix VS array objects in numpy</span></span>
<span id="cb166-2"><a href="#cb166-2" aria-hidden="true" tabindex="-1"></a>m1 <span class="op">=</span> np.matrix(np.arange(<span class="dv">3</span>))</span>
<span id="cb166-3"><a href="#cb166-3" aria-hidden="true" tabindex="-1"></a>m2 <span class="op">=</span> np.matrix(np.arange(<span class="dv">3</span>))</span>
<span id="cb166-4"><a href="#cb166-4" aria-hidden="true" tabindex="-1"></a>m1, m2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="88">
<pre><code>(matrix([[0, 1, 2]]), matrix([[0, 1, 2]]))</code></pre>
</div>
</div>
<div id="48969ede" class="cell" data-slideshow="{&quot;slide_type&quot;:&quot;fragment&quot;}" data-execution_count="89">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb168"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb168-1"><a href="#cb168-1" aria-hidden="true" tabindex="-1"></a>m1.transpose() <span class="op">@</span> m2, m1.shape, m1.transpose() <span class="op">*</span> m2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="89">
<pre><code>(matrix([[0, 0, 0],
         [0, 1, 2],
         [0, 2, 4]]),
 (1, 3),
 matrix([[0, 0, 0],
         [0, 1, 2],
         [0, 2, 4]]))</code></pre>
</div>
</div>
<div id="0c934376" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2022-01-19T10:31:50.070823Z&quot;,&quot;start_time&quot;:&quot;2022-01-19T10:31:50.067191Z&quot;}" data-slideshow="{&quot;slide_type&quot;:&quot;fragment&quot;}" data-execution_count="90">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb170"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb170-1"><a href="#cb170-1" aria-hidden="true" tabindex="-1"></a>a1 <span class="op">=</span> np.arange(<span class="dv">3</span>)</span>
<span id="cb170-2"><a href="#cb170-2" aria-hidden="true" tabindex="-1"></a>a2 <span class="op">=</span> np.arange(<span class="dv">3</span>)</span>
<span id="cb170-3"><a href="#cb170-3" aria-hidden="true" tabindex="-1"></a>a1, a2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="90">
<pre><code>(array([0, 1, 2]), array([0, 1, 2]))</code></pre>
</div>
</div>
<div id="b4eccdbe" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2022-01-19T10:33:12.726005Z&quot;,&quot;start_time&quot;:&quot;2022-01-19T10:33:12.719514Z&quot;}" data-slideshow="{&quot;slide_type&quot;:&quot;subslide&quot;}" data-execution_count="91">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb172"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb172-1"><a href="#cb172-1" aria-hidden="true" tabindex="-1"></a>m1 <span class="op">*</span> m2.T, m1.dot(m2.T)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="91">
<pre><code>(matrix([[5]]), matrix([[5]]))</code></pre>
</div>
</div>
<div id="bf1a860b" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2022-01-19T10:33:27.178091Z&quot;,&quot;start_time&quot;:&quot;2022-01-19T10:33:27.172613Z&quot;}" data-execution_count="92">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb174"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb174-1"><a href="#cb174-1" aria-hidden="true" tabindex="-1"></a>a1 <span class="op">*</span> a2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="92">
<pre><code>array([0, 1, 4])</code></pre>
</div>
</div>
<div id="f9fa06d3" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2022-01-19T10:33:36.836024Z&quot;,&quot;start_time&quot;:&quot;2022-01-19T10:33:36.830383Z&quot;}" data-execution_count="93">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb176"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb176-1"><a href="#cb176-1" aria-hidden="true" tabindex="-1"></a>a1.dot(a2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="93">
<pre><code>np.int64(5)</code></pre>
</div>
</div>
<div id="026fc191" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2022-01-19T10:33:48.138130Z&quot;,&quot;start_time&quot;:&quot;2022-01-19T10:33:48.132664Z&quot;}" data-execution_count="94">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb178"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb178-1"><a href="#cb178-1" aria-hidden="true" tabindex="-1"></a>np.outer(a1, a2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="94">
<pre><code>array([[0, 0, 0],
       [0, 1, 2],
       [0, 2, 4]])</code></pre>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>Visit <a href="https://numpy.org/doc/stable/reference/arrays.ndarray.html#arrays-ndarray" class="uri">https://numpy.org/doc/stable/reference/arrays.ndarray.html#arrays-ndarray</a></p>
</div>
</div>
</section>
<section id="sparse-matrices" class="level2">
<h2 class="anchored" data-anchor-id="sparse-matrices">Sparse matrices</h2>
<div id="d6d083e8" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2022-01-19T10:37:31.887375Z&quot;,&quot;start_time&quot;:&quot;2022-01-19T10:37:31.882051Z&quot;}" data-slideshow="{&quot;slide_type&quot;:&quot;-&quot;}" data-execution_count="95">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb180"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb180-1"><a href="#cb180-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.sparse <span class="im">import</span> csc_matrix, csr_matrix, coo_matrix</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div id="acba7d47" class="cell" data-execution_count="96">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb181"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb181-1"><a href="#cb181-1" aria-hidden="true" tabindex="-1"></a>probs <span class="op">=</span> np.full(fill_value<span class="op">=</span><span class="dv">1</span><span class="op">/</span><span class="dv">4</span>, shape<span class="op">=</span>(<span class="dv">4</span>,))</span>
<span id="cb181-2"><a href="#cb181-2" aria-hidden="true" tabindex="-1"></a>probs</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="96">
<pre><code>array([0.25, 0.25, 0.25, 0.25])</code></pre>
</div>
</div>
<div id="fa726b6a" class="cell" data-execution_count="97">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb183"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb183-1"><a href="#cb183-1" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> np.random.multinomial(n<span class="op">=</span><span class="dv">2</span>, pvals<span class="op">=</span>probs, size<span class="op">=</span><span class="dv">4</span>)   <span class="co"># check you understand what is going on </span></span>
<span id="cb183-2"><a href="#cb183-2" aria-hidden="true" tabindex="-1"></a>X</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="97">
<pre><code>array([[0, 2, 0, 0],
       [0, 1, 1, 0],
       [1, 0, 0, 1],
       [1, 1, 0, 0]])</code></pre>
</div>
</div>
<div id="f7e8a1e9" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2022-01-19T10:37:48.232516Z&quot;,&quot;start_time&quot;:&quot;2022-01-19T10:37:48.228484Z&quot;}" data-execution_count="98">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb185"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb185-1"><a href="#cb185-1" aria-hidden="true" tabindex="-1"></a>probs</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="98">
<pre><code>array([0.25, 0.25, 0.25, 0.25])</code></pre>
</div>
</div>
<div id="c4d22c11" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2022-01-19T10:37:48.397749Z&quot;,&quot;start_time&quot;:&quot;2022-01-19T10:37:48.392611Z&quot;}" data-execution_count="99">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb187"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb187-1"><a href="#cb187-1" aria-hidden="true" tabindex="-1"></a>X_coo <span class="op">=</span> coo_matrix(X)  <span class="co">## coordinate format</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div id="078cca06" class="cell" data-execution_count="100">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb188"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb188-1"><a href="#cb188-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(X_coo)</span>
<span id="cb188-2"><a href="#cb188-2" aria-hidden="true" tabindex="-1"></a>X_coo</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;COOrdinate sparse matrix of dtype 'int64'
    with 7 stored elements and shape (4, 4)&gt;
  Coords    Values
  (0, 1)    2
  (1, 1)    1
  (1, 2)    1
  (2, 0)    1
  (2, 3)    1
  (3, 0)    1
  (3, 1)    1</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="100">
<pre><code>&lt;COOrdinate sparse matrix of dtype 'int64'
    with 7 stored elements and shape (4, 4)&gt;</code></pre>
</div>
</div>
<div id="729c053a" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2022-01-19T10:38:09.049157Z&quot;,&quot;start_time&quot;:&quot;2022-01-19T10:38:09.044598Z&quot;}" data-slideshow="{&quot;slide_type&quot;:&quot;subslide&quot;}" data-execution_count="101">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb191"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb191-1"><a href="#cb191-1" aria-hidden="true" tabindex="-1"></a>X_coo.nnz    <span class="co"># number pf non-zero coordinates </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="101">
<pre><code>7</code></pre>
</div>
</div>
<div id="8ee7bc52" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2022-01-19T10:38:14.258127Z&quot;,&quot;start_time&quot;:&quot;2022-01-19T10:38:14.251407Z&quot;}" data-execution_count="102">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb193"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb193-1"><a href="#cb193-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(X, end<span class="op">=</span><span class="st">'</span><span class="ch">\n</span><span class="st">----</span><span class="ch">\n</span><span class="st">'</span>)</span>
<span id="cb193-2"><a href="#cb193-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(X_coo.data, end<span class="op">=</span><span class="st">'</span><span class="ch">\n</span><span class="st">----</span><span class="ch">\n</span><span class="st">'</span>)</span>
<span id="cb193-3"><a href="#cb193-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(X_coo.row, end<span class="op">=</span><span class="st">'</span><span class="ch">\n</span><span class="st">----</span><span class="ch">\n</span><span class="st">'</span>)</span>
<span id="cb193-4"><a href="#cb193-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(X_coo.col, end<span class="op">=</span><span class="st">'</span><span class="ch">\n</span><span class="st">----</span><span class="ch">\n</span><span class="st">'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[[0 2 0 0]
 [0 1 1 0]
 [1 0 0 1]
 [1 1 0 0]]
----
[2 1 1 1 1 1 1]
----
[0 1 1 2 2 3 3]
----
[1 1 2 0 3 0 1]
----</code></pre>
</div>
</div>
<p>There is also</p>
<ul>
<li><code>csr_matrix</code>: sparse rows format</li>
<li><code>csc_matrix</code>: sparse columns format</li>
</ul>
<p>Sparse rows is often used for machine learning: sparse features vectors</p>
<p>But sparse column format useful as well (e.g.&nbsp;coordinate gradient descent)</p>
</section>
<section id="bored-with-decimals" class="level2">
<h2 class="anchored" data-anchor-id="bored-with-decimals">Bored with decimals?</h2>
<div id="dae64e76" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2022-01-19T10:39:04.467972Z&quot;,&quot;start_time&quot;:&quot;2022-01-19T10:39:04.461304Z&quot;}" data-execution_count="103">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb195"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb195-1"><a href="#cb195-1" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> np.random.randn(<span class="dv">5</span>, <span class="dv">5</span>)</span>
<span id="cb195-2"><a href="#cb195-2" aria-hidden="true" tabindex="-1"></a>X</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="103">
<pre><code>array([[ 0.50279636, -0.89142068,  0.14705019, -1.97484462,  0.14565327],
       [ 0.81568164,  0.13153904,  0.96874511,  0.16661565, -0.81720499],
       [-2.0552225 ,  0.22125786,  0.270791  , -0.54197397, -1.32477109],
       [-0.85336519,  0.28360894,  0.13626591, -0.21327729, -0.24759177],
       [-1.13969827,  0.72759541, -0.0920562 ,  1.03212989,  0.38869068]])</code></pre>
</div>
</div>
<div id="be558add" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2022-01-19T10:39:09.241253Z&quot;,&quot;start_time&quot;:&quot;2022-01-19T10:39:09.235736Z&quot;}" data-execution_count="104">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb197"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb197-1"><a href="#cb197-1" aria-hidden="true" tabindex="-1"></a><span class="co"># All number displayed by numpy (in the current kernel) are with 3 decimals max</span></span>
<span id="cb197-2"><a href="#cb197-2" aria-hidden="true" tabindex="-1"></a>np.set_printoptions(precision<span class="op">=</span><span class="dv">3</span>)</span>
<span id="cb197-3"><a href="#cb197-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(X)</span>
<span id="cb197-4"><a href="#cb197-4" aria-hidden="true" tabindex="-1"></a>np.set_printoptions(precision<span class="op">=</span><span class="dv">8</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[[ 0.503 -0.891  0.147 -1.975  0.146]
 [ 0.816  0.132  0.969  0.167 -0.817]
 [-2.055  0.221  0.271 -0.542 -1.325]
 [-0.853  0.284  0.136 -0.213 -0.248]
 [-1.14   0.728 -0.092  1.032  0.389]]</code></pre>
</div>
</div>
</section>
<section id="not-limited-to-2d" class="level2">
<h2 class="anchored" data-anchor-id="not-limited-to-2d">Not limited to 2D!</h2>
<p><code>numpy</code> arrays can have any number of dimension (hence the name <code>ndarray</code>)</p>
<div id="e0323c44" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2022-01-19T10:39:46.037716Z&quot;,&quot;start_time&quot;:&quot;2022-01-19T10:39:46.032228Z&quot;}" data-execution_count="105">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb199"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb199-1"><a href="#cb199-1" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> np.arange(<span class="dv">18</span>).reshape(<span class="dv">3</span>, <span class="dv">2</span>, <span class="dv">3</span>)</span>
<span id="cb199-2"><a href="#cb199-2" aria-hidden="true" tabindex="-1"></a>X</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="105">
<pre><code>array([[[ 0,  1,  2],
        [ 3,  4,  5]],

       [[ 6,  7,  8],
        [ 9, 10, 11]],

       [[12, 13, 14],
        [15, 16, 17]]])</code></pre>
</div>
</div>
<div id="e3c2be78" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2022-01-19T10:39:46.370909Z&quot;,&quot;start_time&quot;:&quot;2022-01-19T10:39:46.366101Z&quot;}" data-execution_count="106">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb201"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb201-1"><a href="#cb201-1" aria-hidden="true" tabindex="-1"></a>X.shape</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="106">
<pre><code>(3, 2, 3)</code></pre>
</div>
</div>
<div id="fd140abb" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2022-01-19T10:39:51.793204Z&quot;,&quot;start_time&quot;:&quot;2022-01-19T10:39:51.787910Z&quot;}" data-execution_count="107">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb203"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb203-1"><a href="#cb203-1" aria-hidden="true" tabindex="-1"></a>X.ndim</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="107">
<pre><code>3</code></pre>
</div>
</div>
<p>Visit <a href="https://numpy.org/doc/stable/reference/arrays.ndarray.html#arrays-ndarray" class="uri">https://numpy.org/doc/stable/reference/arrays.ndarray.html#arrays-ndarray</a></p>
</section>
</section>
<section id="aggregations-and-statistics" class="level1">
<h1>Aggregations and statistics</h1>
<div id="0ffb3dc8" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2022-01-19T10:40:09.476064Z&quot;,&quot;start_time&quot;:&quot;2022-01-19T10:40:09.470504Z&quot;}" data-slideshow="{&quot;slide_type&quot;:&quot;subslide&quot;}" data-execution_count="108">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb205"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb205-1"><a href="#cb205-1" aria-hidden="true" tabindex="-1"></a>A <span class="op">=</span> np.arange(<span class="dv">42</span>).reshape(<span class="dv">7</span>, <span class="dv">6</span>)</span>
<span id="cb205-2"><a href="#cb205-2" aria-hidden="true" tabindex="-1"></a>A</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="108">
<pre><code>array([[ 0,  1,  2,  3,  4,  5],
       [ 6,  7,  8,  9, 10, 11],
       [12, 13, 14, 15, 16, 17],
       [18, 19, 20, 21, 22, 23],
       [24, 25, 26, 27, 28, 29],
       [30, 31, 32, 33, 34, 35],
       [36, 37, 38, 39, 40, 41]])</code></pre>
</div>
</div>
<div id="20eee60d" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2022-01-19T10:40:15.486454Z&quot;,&quot;start_time&quot;:&quot;2022-01-19T10:40:15.480429Z&quot;}" data-execution_count="109">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb207"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb207-1"><a href="#cb207-1" aria-hidden="true" tabindex="-1"></a>A.<span class="bu">sum</span>(), <span class="dv">42</span> <span class="op">*</span> <span class="dv">41</span> <span class="op">//</span><span class="dv">2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="109">
<pre><code>(np.int64(861), 861)</code></pre>
</div>
</div>
<div id="5b8ad36b" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2022-01-19T10:40:30.552043Z&quot;,&quot;start_time&quot;:&quot;2022-01-19T10:40:30.545833Z&quot;}" data-execution_count="110">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb209"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb209-1"><a href="#cb209-1" aria-hidden="true" tabindex="-1"></a>A[:, <span class="dv">3</span>].mean(), np.mean (<span class="dv">3</span> <span class="op">+</span> np.arange(<span class="dv">0</span>, <span class="dv">42</span>, <span class="dv">6</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="110">
<pre><code>(np.float64(21.0), np.float64(21.0))</code></pre>
</div>
</div>
<div id="981104c6" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2022-01-19T10:40:35.563769Z&quot;,&quot;start_time&quot;:&quot;2022-01-19T10:40:35.558458Z&quot;}" data-execution_count="111">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb211"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb211-1"><a href="#cb211-1" aria-hidden="true" tabindex="-1"></a>A.mean(axis<span class="op">=</span><span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="111">
<pre><code>array([18., 19., 20., 21., 22., 23.])</code></pre>
</div>
</div>
<div id="15dd3608" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2022-01-19T10:41:32.219284Z&quot;,&quot;start_time&quot;:&quot;2022-01-19T10:41:32.213546Z&quot;}" data-execution_count="112">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb213"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb213-1"><a href="#cb213-1" aria-hidden="true" tabindex="-1"></a>A.mean(axis<span class="op">=</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="112">
<pre><code>array([ 2.5,  8.5, 14.5, 20.5, 26.5, 32.5, 38.5])</code></pre>
</div>
</div>
<div id="57e1aa44" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2022-01-19T10:41:36.654691Z&quot;,&quot;start_time&quot;:&quot;2022-01-19T10:41:36.649712Z&quot;}" data-slideshow="{&quot;slide_type&quot;:&quot;subslide&quot;}" data-execution_count="113">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb215"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb215-1"><a href="#cb215-1" aria-hidden="true" tabindex="-1"></a>A[:,<span class="dv">3</span>].std(), A[:,<span class="dv">3</span>].var()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="113">
<pre><code>(np.float64(12.0), np.float64(144.0))</code></pre>
</div>
</div>
<div id="fea997d9" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2022-01-19T10:41:41.843358Z&quot;,&quot;start_time&quot;:&quot;2022-01-19T10:41:41.837835Z&quot;}" data-execution_count="114">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb217"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb217-1"><a href="#cb217-1" aria-hidden="true" tabindex="-1"></a>A[:,<span class="dv">3</span>].<span class="bu">min</span>(), A[:,<span class="dv">3</span>].<span class="bu">max</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="114">
<pre><code>(np.int64(3), np.int64(39))</code></pre>
</div>
</div>
<div id="d5fd1b73" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2022-01-19T10:42:19.023192Z&quot;,&quot;start_time&quot;:&quot;2022-01-19T10:42:19.017379Z&quot;}" data-execution_count="115">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb219"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb219-1"><a href="#cb219-1" aria-hidden="true" tabindex="-1"></a>A.cumsum(axis<span class="op">=</span><span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="115">
<pre><code>array([[  0,   1,   2,   3,   4,   5],
       [  6,   8,  10,  12,  14,  16],
       [ 18,  21,  24,  27,  30,  33],
       [ 36,  40,  44,  48,  52,  56],
       [ 60,  65,  70,  75,  80,  85],
       [ 90,  96, 102, 108, 114, 120],
       [126, 133, 140, 147, 154, 161]])</code></pre>
</div>
</div>
<div id="71238858" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2022-01-19T10:41:49.658126Z&quot;,&quot;start_time&quot;:&quot;2022-01-19T10:41:49.652337Z&quot;}" data-execution_count="116">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb221"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb221-1"><a href="#cb221-1" aria-hidden="true" tabindex="-1"></a>A</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="116">
<pre><code>array([[ 0,  1,  2,  3,  4,  5],
       [ 6,  7,  8,  9, 10, 11],
       [12, 13, 14, 15, 16, 17],
       [18, 19, 20, 21, 22, 23],
       [24, 25, 26, 27, 28, 29],
       [30, 31, 32, 33, 34, 35],
       [36, 37, 38, 39, 40, 41]])</code></pre>
</div>
</div>
<div id="d30829f4" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2022-01-19T10:42:28.725423Z&quot;,&quot;start_time&quot;:&quot;2022-01-19T10:42:28.720388Z&quot;}" data-execution_count="117">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb223"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb223-1"><a href="#cb223-1" aria-hidden="true" tabindex="-1"></a><span class="co"># sum of diagonal</span></span>
<span id="cb223-2"><a href="#cb223-2" aria-hidden="true" tabindex="-1"></a>A.trace()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="117">
<pre><code>np.int64(105)</code></pre>
</div>
</div>
</section>
<section id="linear-algebra" class="level1">
<h1>Linear Algebra</h1>
<div id="fe74fe3a" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2022-01-19T10:43:28.663538Z&quot;,&quot;start_time&quot;:&quot;2022-01-19T10:43:28.659546Z&quot;}" data-slideshow="{&quot;slide_type&quot;:&quot;subslide&quot;}" data-execution_count="118">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb225"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb225-1"><a href="#cb225-1" aria-hidden="true" tabindex="-1"></a>A <span class="op">=</span> np.arange(<span class="dv">30</span>).reshape(<span class="dv">6</span>, <span class="dv">5</span>)</span>
<span id="cb225-2"><a href="#cb225-2" aria-hidden="true" tabindex="-1"></a>v1 <span class="op">=</span> np.arange(<span class="dv">0</span>, <span class="dv">5</span>)</span>
<span id="cb225-3"><a href="#cb225-3" aria-hidden="true" tabindex="-1"></a>v2 <span class="op">=</span> np.arange(<span class="dv">5</span>, <span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div id="7973c918" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2022-01-19T10:43:28.871370Z&quot;,&quot;start_time&quot;:&quot;2022-01-19T10:43:28.866058Z&quot;}" data-execution_count="119">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb226"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb226-1"><a href="#cb226-1" aria-hidden="true" tabindex="-1"></a>A</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="119">
<pre><code>array([[ 0,  1,  2,  3,  4],
       [ 5,  6,  7,  8,  9],
       [10, 11, 12, 13, 14],
       [15, 16, 17, 18, 19],
       [20, 21, 22, 23, 24],
       [25, 26, 27, 28, 29]])</code></pre>
</div>
</div>
<div id="0a43a477" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2022-01-19T10:43:29.041390Z&quot;,&quot;start_time&quot;:&quot;2022-01-19T10:43:29.035397Z&quot;}" data-execution_count="120">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb228"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb228-1"><a href="#cb228-1" aria-hidden="true" tabindex="-1"></a>v1, v2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="120">
<pre><code>(array([0, 1, 2, 3, 4]), array([5, 6, 7, 8, 9]))</code></pre>
</div>
</div>
<div id="6b497bd5" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2022-01-19T10:43:30.302802Z&quot;,&quot;start_time&quot;:&quot;2022-01-19T10:43:30.297408Z&quot;}" data-slideshow="{&quot;slide_type&quot;:&quot;-&quot;}" data-execution_count="121">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb230"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb230-1"><a href="#cb230-1" aria-hidden="true" tabindex="-1"></a>v1 <span class="op">*</span> v2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="121">
<pre><code>array([ 0,  6, 14, 24, 36])</code></pre>
</div>
</div>
<div id="344aeaeb" class="cell" data-execution_count="122">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb232"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb232-1"><a href="#cb232-1" aria-hidden="true" tabindex="-1"></a>v1.dot(v2), np.<span class="bu">sum</span>(v1<span class="op">*</span> v2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="122">
<pre><code>(np.int64(80), np.int64(80))</code></pre>
</div>
</div>
<div id="75c24dfe" class="cell" data-execution_count="123">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb234"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb234-1"><a href="#cb234-1" aria-hidden="true" tabindex="-1"></a>v1.reshape(<span class="dv">5</span>,<span class="dv">1</span>) <span class="op">@</span> v2.reshape(<span class="dv">1</span>,<span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="123">
<pre><code>array([[ 0,  0,  0,  0,  0],
       [ 5,  6,  7,  8,  9],
       [10, 12, 14, 16, 18],
       [15, 18, 21, 24, 27],
       [20, 24, 28, 32, 36]])</code></pre>
</div>
</div>
<section id="inner-products" class="level2">
<h2 class="anchored" data-anchor-id="inner-products">Inner products</h2>
<div id="06384790" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2022-01-19T10:43:39.940939Z&quot;,&quot;start_time&quot;:&quot;2022-01-19T10:43:39.935975Z&quot;}" data-slideshow="{&quot;slide_type&quot;:&quot;-&quot;}" data-execution_count="124">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb236"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb236-1"><a href="#cb236-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Inner product between vectors</span></span>
<span id="cb236-2"><a href="#cb236-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(v1.dot(v2))</span>
<span id="cb236-3"><a href="#cb236-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb236-4"><a href="#cb236-4" aria-hidden="true" tabindex="-1"></a><span class="co"># You can use also (but first solution is better)</span></span>
<span id="cb236-5"><a href="#cb236-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(np.dot(v1, v2))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>80
80</code></pre>
</div>
</div>
<div id="197878a3" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2022-01-19T10:43:41.034492Z&quot;,&quot;start_time&quot;:&quot;2022-01-19T10:43:41.028651Z&quot;}" data-slideshow="{&quot;slide_type&quot;:&quot;-&quot;}" data-execution_count="125">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb238"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb238-1"><a href="#cb238-1" aria-hidden="true" tabindex="-1"></a>A, v1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="125">
<pre><code>(array([[ 0,  1,  2,  3,  4],
        [ 5,  6,  7,  8,  9],
        [10, 11, 12, 13, 14],
        [15, 16, 17, 18, 19],
        [20, 21, 22, 23, 24],
        [25, 26, 27, 28, 29]]),
 array([0, 1, 2, 3, 4]))</code></pre>
</div>
</div>
<div id="f52825ce" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2022-01-19T10:43:45.633853Z&quot;,&quot;start_time&quot;:&quot;2022-01-19T10:43:45.628678Z&quot;}" data-execution_count="126">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb240"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb240-1"><a href="#cb240-1" aria-hidden="true" tabindex="-1"></a>A.shape, v1.shape</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="126">
<pre><code>((6, 5), (5,))</code></pre>
</div>
</div>
<div id="cec536bb" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2022-01-19T10:43:55.770813Z&quot;,&quot;start_time&quot;:&quot;2022-01-19T10:43:55.766693Z&quot;}" data-execution_count="127">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb242"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb242-1"><a href="#cb242-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Matrix-vector inner product</span></span>
<span id="cb242-2"><a href="#cb242-2" aria-hidden="true" tabindex="-1"></a>A.dot(v1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="127">
<pre><code>array([ 30,  80, 130, 180, 230, 280])</code></pre>
</div>
</div>
<div id="63f6f5f2" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2022-01-19T10:44:01.146695Z&quot;,&quot;start_time&quot;:&quot;2022-01-19T10:44:01.138719Z&quot;}" data-slideshow="{&quot;slide_type&quot;:&quot;subslide&quot;}" data-execution_count="128">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb244"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb244-1"><a href="#cb244-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Transpose</span></span>
<span id="cb244-2"><a href="#cb244-2" aria-hidden="true" tabindex="-1"></a>A.T</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="128">
<pre><code>array([[ 0,  5, 10, 15, 20, 25],
       [ 1,  6, 11, 16, 21, 26],
       [ 2,  7, 12, 17, 22, 27],
       [ 3,  8, 13, 18, 23, 28],
       [ 4,  9, 14, 19, 24, 29]])</code></pre>
</div>
</div>
<div id="4688be51" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2022-01-19T10:44:05.408599Z&quot;,&quot;start_time&quot;:&quot;2022-01-19T10:44:05.403379Z&quot;}" data-slideshow="{&quot;slide_type&quot;:&quot;-&quot;}" data-execution_count="129">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb246"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb246-1"><a href="#cb246-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(v1)</span>
<span id="cb246-2"><a href="#cb246-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Inline operations (same for *=, /=, -=)</span></span>
<span id="cb246-3"><a href="#cb246-3" aria-hidden="true" tabindex="-1"></a>v1 <span class="op">+=</span> <span class="dv">2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[0 1 2 3 4]</code></pre>
</div>
</div>
</section>
<section id="linear-systems" class="level2">
<h2 class="anchored" data-anchor-id="linear-systems">Linear systems</h2>
<div id="a8c56e62" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2022-01-19T10:44:47.947222Z&quot;,&quot;start_time&quot;:&quot;2022-01-19T10:44:47.942465Z&quot;}" data-slideshow="{&quot;slide_type&quot;:&quot;-&quot;}" data-execution_count="130">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb248"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb248-1"><a href="#cb248-1" aria-hidden="true" tabindex="-1"></a>A <span class="op">=</span> np.array([[<span class="dv">42</span>,<span class="dv">2</span>,<span class="dv">3</span>], [<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">6</span>], [<span class="dv">7</span>,<span class="dv">8</span>,<span class="dv">9</span>]])</span>
<span id="cb248-2"><a href="#cb248-2" aria-hidden="true" tabindex="-1"></a>b <span class="op">=</span> np.array([<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>])</span>
<span id="cb248-3"><a href="#cb248-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(A, b, sep<span class="op">=</span><span class="dv">2</span> <span class="op">*</span> <span class="st">'</span><span class="ch">\n</span><span class="st">'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[[42  2  3]
 [ 4  5  6]
 [ 7  8  9]]

[1 2 3]</code></pre>
</div>
</div>
<div id="e40668f9" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2022-01-19T10:44:48.103750Z&quot;,&quot;start_time&quot;:&quot;2022-01-19T10:44:48.096615Z&quot;}" data-execution_count="131">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb250"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb250-1"><a href="#cb250-1" aria-hidden="true" tabindex="-1"></a><span class="co"># solve a system of linear equations</span></span>
<span id="cb250-2"><a href="#cb250-2" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.linalg.solve(A, b)</span>
<span id="cb250-3"><a href="#cb250-3" aria-hidden="true" tabindex="-1"></a>x</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="131">
<pre><code>array([2.18366847e-18, 2.31698718e-16, 3.33333333e-01])</code></pre>
</div>
</div>
<div id="8a7f2bb7" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2022-01-19T10:44:49.896958Z&quot;,&quot;start_time&quot;:&quot;2022-01-19T10:44:49.890609Z&quot;}" data-slideshow="{&quot;slide_type&quot;:&quot;-&quot;}" data-execution_count="132">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb252"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb252-1"><a href="#cb252-1" aria-hidden="true" tabindex="-1"></a>A.dot(x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="132">
<pre><code>array([1., 2., 3.])</code></pre>
</div>
</div>
</section>
<section id="eigenvalues-and-eigenvectors" class="level2">
<h2 class="anchored" data-anchor-id="eigenvalues-and-eigenvectors">Eigenvalues and eigenvectors</h2>
<div id="7144dc4c" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2022-01-19T10:45:14.757150Z&quot;,&quot;start_time&quot;:&quot;2022-01-19T10:45:14.750149Z&quot;}" data-slideshow="{&quot;slide_type&quot;:&quot;-&quot;}" data-execution_count="133">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb254"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb254-1"><a href="#cb254-1" aria-hidden="true" tabindex="-1"></a>A <span class="op">=</span> np.random.rand(<span class="dv">3</span>,<span class="dv">3</span>)</span>
<span id="cb254-2"><a href="#cb254-2" aria-hidden="true" tabindex="-1"></a>B <span class="op">=</span> np.random.rand(<span class="dv">3</span>,<span class="dv">3</span>)</span>
<span id="cb254-3"><a href="#cb254-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb254-4"><a href="#cb254-4" aria-hidden="true" tabindex="-1"></a>evals, evecs <span class="op">=</span> np.linalg.eig(A)</span>
<span id="cb254-5"><a href="#cb254-5" aria-hidden="true" tabindex="-1"></a>evals</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="133">
<pre><code>array([ 1.70949739, -0.59712886, -0.23704844])</code></pre>
</div>
</div>
<div id="6130acce" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2022-01-19T10:45:16.164688Z&quot;,&quot;start_time&quot;:&quot;2022-01-19T10:45:16.159112Z&quot;}" data-execution_count="134">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb256"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb256-1"><a href="#cb256-1" aria-hidden="true" tabindex="-1"></a>evecs</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="134">
<pre><code>array([[-0.67211104, -0.47074745,  0.26588469],
       [-0.50132133, -0.15775954, -0.82213875],
       [-0.54492539,  0.86804882,  0.50338178]])</code></pre>
</div>
</div>
</section>
<section id="singular-value-decomposition-svd" class="level2">
<h2 class="anchored" data-anchor-id="singular-value-decomposition-svd">Singular value decomposition (SVD)</h2>
<p>Decomposes any matrix <span class="math inline">\(A \in \mathbb R^{m \times n}\)</span> as follows: <span class="math display">\[
A = U \times S \times V^\top
\]</span> where - <span class="math inline">\(U\)</span> and <span class="math inline">\(V\)</span> are orthonormal matrices (meaning that <span class="math inline">\(U^\top \times U = I\)</span> and <span class="math inline">\(V^\top \times V = I\)</span>) - <span class="math inline">\(S\)</span> is a diagonal matrix that contains the <em>singular</em> values in non-increasing order</p>
<div id="bd5547d5" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2022-01-19T10:47:54.504658Z&quot;,&quot;start_time&quot;:&quot;2022-01-19T10:47:54.500097Z&quot;}" data-execution_count="135">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb258"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb258-1"><a href="#cb258-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(A)</span>
<span id="cb258-2"><a href="#cb258-2" aria-hidden="true" tabindex="-1"></a>U, S, V <span class="op">=</span> np.linalg.svd(A)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[[0.55784428 0.7207817  0.75734318]
 [0.64741652 0.28551913 0.51151019]
 [0.99678968 0.48707519 0.03195668]]</code></pre>
</div>
</div>
<div id="1b4bd2fd" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2022-01-19T10:48:52.598626Z&quot;,&quot;start_time&quot;:&quot;2022-01-19T10:48:52.592465Z&quot;}" data-execution_count="136">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb260"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb260-1"><a href="#cb260-1" aria-hidden="true" tabindex="-1"></a>U.dot(np.diag(S)).dot(V)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="136">
<pre><code>array([[0.55784428, 0.7207817 , 0.75734318],
       [0.64741652, 0.28551913, 0.51151019],
       [0.99678968, 0.48707519, 0.03195668]])</code></pre>
</div>
</div>
<div id="b689c54e" class="cell" data-execution_count="137">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb262"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb262-1"><a href="#cb262-1" aria-hidden="true" tabindex="-1"></a>A <span class="op">-</span> U <span class="op">@</span> np.diag(S) <span class="op">@</span> V</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="137">
<pre><code>array([[ 0.00000000e+00, -3.33066907e-16, -2.22044605e-16],
       [-1.11022302e-16,  0.00000000e+00,  1.11022302e-16],
       [-3.33066907e-16, -1.66533454e-16,  1.38777878e-17]])</code></pre>
</div>
</div>
<div id="e63341b3" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2022-01-19T10:49:07.814713Z&quot;,&quot;start_time&quot;:&quot;2022-01-19T10:49:07.809269Z&quot;}" data-slideshow="{&quot;slide_type&quot;:&quot;subslide&quot;}" data-execution_count="138">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb264"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb264-1"><a href="#cb264-1" aria-hidden="true" tabindex="-1"></a><span class="co"># U and V are indeed orthonormal</span></span>
<span id="cb264-2"><a href="#cb264-2" aria-hidden="true" tabindex="-1"></a>np.set_printoptions(precision<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb264-3"><a href="#cb264-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(U.T.dot(U), V.T.dot(V), sep<span class="op">=</span><span class="dv">2</span> <span class="op">*</span> <span class="st">'</span><span class="ch">\n</span><span class="st">'</span>)</span>
<span id="cb264-4"><a href="#cb264-4" aria-hidden="true" tabindex="-1"></a>np.set_printoptions(precision<span class="op">=</span><span class="dv">8</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[[ 1.00e+00 -3.87e-17 -1.43e-16]
 [-3.87e-17  1.00e+00  2.77e-16]
 [-1.43e-16  2.77e-16  1.00e+00]]

[[ 1.00e+00 -1.01e-17 -6.45e-17]
 [-1.01e-17  1.00e+00  1.14e-16]
 [-6.45e-17  1.14e-16  1.00e+00]]</code></pre>
</div>
</div>
</section>
<section id="exercice-the-racoon-svd" class="level2">
<h2 class="anchored" data-anchor-id="exercice-the-racoon-svd">Exercice: the racoon SVD</h2>
<ul>
<li>Load the racoon face picture using <code>scipy.misc.face()</code></li>
<li>Visualize the picture</li>
<li>Write a function which reshapes the picture into a 2D array, and computes the best rank-r approximation of it (the prototype of the function is <code>compute_approx(X, r)</code></li>
<li>Display the different approximations for r between 5 and 100</li>
</ul>
<div id="1731fa43" class="cell" data-execution_count="139">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb266"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb266-1"><a href="#cb266-1" aria-hidden="true" tabindex="-1"></a><span class="op">!</span>pip3 install pooch</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Requirement already satisfied: pooch in /home/boucheron/Documents/IFEBY310/.venv/lib/python3.12/site-packages (1.8.2)
Requirement already satisfied: platformdirs&gt;=2.5.0 in /home/boucheron/Documents/IFEBY310/.venv/lib/python3.12/site-packages (from pooch) (4.3.6)
Requirement already satisfied: packaging&gt;=20.0 in /home/boucheron/Documents/IFEBY310/.venv/lib/python3.12/site-packages (from pooch) (24.2)
Requirement already satisfied: requests&gt;=2.19.0 in /home/boucheron/Documents/IFEBY310/.venv/lib/python3.12/site-packages (from pooch) (2.32.3)
Requirement already satisfied: charset-normalizer&lt;4,&gt;=2 in /home/boucheron/Documents/IFEBY310/.venv/lib/python3.12/site-packages (from requests&gt;=2.19.0-&gt;pooch) (3.4.1)
Requirement already satisfied: idna&lt;4,&gt;=2.5 in /home/boucheron/Documents/IFEBY310/.venv/lib/python3.12/site-packages (from requests&gt;=2.19.0-&gt;pooch) (3.10)
Requirement already satisfied: urllib3&lt;3,&gt;=1.21.1 in /home/boucheron/Documents/IFEBY310/.venv/lib/python3.12/site-packages (from requests&gt;=2.19.0-&gt;pooch) (2.3.0)
Requirement already satisfied: certifi&gt;=2017.4.17 in /home/boucheron/Documents/IFEBY310/.venv/lib/python3.12/site-packages (from requests&gt;=2.19.0-&gt;pooch) (2024.12.14)

[notice] A new release of pip is available: 25.0 -&gt; 25.0.1
[notice] To update, run: pip install --upgrade pip</code></pre>
</div>
</div>
<div id="70b1843e" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2022-01-19T10:49:33.476362Z&quot;,&quot;start_time&quot;:&quot;2022-01-19T10:49:33.198685Z&quot;}" data-slideshow="{&quot;slide_type&quot;:&quot;subslide&quot;}" data-execution_count="140">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb268"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb268-1"><a href="#cb268-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb268-2"><a href="#cb268-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.datasets <span class="im">import</span> face</span>
<span id="cb268-3"><a href="#cb268-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb268-4"><a href="#cb268-4" aria-hidden="true" tabindex="-1"></a><span class="op">%</span>matplotlib inline</span>
<span id="cb268-5"><a href="#cb268-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb268-6"><a href="#cb268-6" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> face()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div id="f2b9662a" class="cell" data-execution_count="141">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb269"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb269-1"><a href="#cb269-1" aria-hidden="true" tabindex="-1"></a><span class="bu">type</span>(X)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="141">
<pre><code>numpy.ndarray</code></pre>
</div>
</div>
<div id="1c80d6f2" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2022-01-19T10:49:33.476362Z&quot;,&quot;start_time&quot;:&quot;2022-01-19T10:49:33.198685Z&quot;}" data-slideshow="{&quot;slide_type&quot;:&quot;subslide&quot;}" data-execution_count="142">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb271"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb271-1"><a href="#cb271-1" aria-hidden="true" tabindex="-1"></a>plt.imshow(X)</span>
<span id="cb271-2"><a href="#cb271-2" aria-hidden="true" tabindex="-1"></a>_ <span class="op">=</span> plt.axis(<span class="st">'off'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="notebook02_numpy_files/figure-html/cell-143-output-1.png" width="512" height="389" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="4f31f733" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2022-01-19T10:53:29.332090Z&quot;,&quot;start_time&quot;:&quot;2022-01-19T10:53:28.069519Z&quot;}" data-execution_count="143">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb272"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb272-1"><a href="#cb272-1" aria-hidden="true" tabindex="-1"></a>n_rows, n_cols, n_channels <span class="op">=</span> X.shape</span>
<span id="cb272-2"><a href="#cb272-2" aria-hidden="true" tabindex="-1"></a>X_reshaped <span class="op">=</span> X.reshape(n_rows, n_cols <span class="op">*</span> n_channels)</span>
<span id="cb272-3"><a href="#cb272-3" aria-hidden="true" tabindex="-1"></a>U, S, V <span class="op">=</span> np.linalg.svd(X_reshaped, full_matrices<span class="op">=</span><span class="va">False</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div id="859cd167" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2022-01-19T10:54:28.825206Z&quot;,&quot;start_time&quot;:&quot;2022-01-19T10:54:28.819913Z&quot;}" data-execution_count="144">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb273"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb273-1"><a href="#cb273-1" aria-hidden="true" tabindex="-1"></a>X_reshaped.shape</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="144">
<pre><code>(768, 3072)</code></pre>
</div>
</div>
<div id="7476a419" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2022-01-19T10:53:58.531955Z&quot;,&quot;start_time&quot;:&quot;2022-01-19T10:53:58.526383Z&quot;}" data-execution_count="145">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb275"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb275-1"><a href="#cb275-1" aria-hidden="true" tabindex="-1"></a>X.shape</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="145">
<pre><code>(768, 1024, 3)</code></pre>
</div>
</div>
<div id="3e497bf4" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2022-01-19T10:53:43.697818Z&quot;,&quot;start_time&quot;:&quot;2022-01-19T10:53:43.259439Z&quot;}" data-execution_count="146">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb277"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb277-1"><a href="#cb277-1" aria-hidden="true" tabindex="-1"></a>plt.plot(S<span class="op">**</span><span class="dv">2</span>)  <span class="co">## a kind of screeplot</span></span>
<span id="cb277-2"><a href="#cb277-2" aria-hidden="true" tabindex="-1"></a>plt.yscale(<span class="st">"log"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="notebook02_numpy_files/figure-html/cell-147-output-1.png" width="588" height="411" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="24a5a87d" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2022-01-19T10:56:57.594009Z&quot;,&quot;start_time&quot;:&quot;2022-01-19T10:56:57.588737Z&quot;}" data-slideshow="{&quot;slide_type&quot;:&quot;subslide&quot;}" data-execution_count="147">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb278"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb278-1"><a href="#cb278-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> compute_approx(X: np.ndarray, r: <span class="bu">int</span>):</span>
<span id="cb278-2"><a href="#cb278-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Computes the best rank-r approximation of X using SVD.</span></span>
<span id="cb278-3"><a href="#cb278-3" aria-hidden="true" tabindex="-1"></a><span class="co">    We expect X to the 3D array corresponding to a color image, that we </span></span>
<span id="cb278-4"><a href="#cb278-4" aria-hidden="true" tabindex="-1"></a><span class="co">    reduce to a 2D one to apply SVD (no broadcasting).</span></span>
<span id="cb278-5"><a href="#cb278-5" aria-hidden="true" tabindex="-1"></a><span class="co">    </span></span>
<span id="cb278-6"><a href="#cb278-6" aria-hidden="true" tabindex="-1"></a><span class="co">    Parameters</span></span>
<span id="cb278-7"><a href="#cb278-7" aria-hidden="true" tabindex="-1"></a><span class="co">    ----------</span></span>
<span id="cb278-8"><a href="#cb278-8" aria-hidden="true" tabindex="-1"></a><span class="co">    X : `np.ndarray`, shape=(n_rows, n_cols, 3)</span></span>
<span id="cb278-9"><a href="#cb278-9" aria-hidden="true" tabindex="-1"></a><span class="co">        The input 3D ndarray</span></span>
<span id="cb278-10"><a href="#cb278-10" aria-hidden="true" tabindex="-1"></a><span class="co">    </span></span>
<span id="cb278-11"><a href="#cb278-11" aria-hidden="true" tabindex="-1"></a><span class="co">    r : `int`</span></span>
<span id="cb278-12"><a href="#cb278-12" aria-hidden="true" tabindex="-1"></a><span class="co">        The desired rank</span></span>
<span id="cb278-13"><a href="#cb278-13" aria-hidden="true" tabindex="-1"></a><span class="co">        </span></span>
<span id="cb278-14"><a href="#cb278-14" aria-hidden="true" tabindex="-1"></a><span class="co">    Return</span></span>
<span id="cb278-15"><a href="#cb278-15" aria-hidden="true" tabindex="-1"></a><span class="co">    ------</span></span>
<span id="cb278-16"><a href="#cb278-16" aria-hidden="true" tabindex="-1"></a><span class="co">    output : `np.ndarray`, shape=(n_rows, n_cols, 3)</span></span>
<span id="cb278-17"><a href="#cb278-17" aria-hidden="true" tabindex="-1"></a><span class="co">        The best rank-r approximation of X</span></span>
<span id="cb278-18"><a href="#cb278-18" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb278-19"><a href="#cb278-19" aria-hidden="true" tabindex="-1"></a>    n_rows, n_cols, n_channels <span class="op">=</span> X.shape</span>
<span id="cb278-20"><a href="#cb278-20" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Reshape X to a 2D array</span></span>
<span id="cb278-21"><a href="#cb278-21" aria-hidden="true" tabindex="-1"></a>    X_reshape <span class="op">=</span> X.reshape(n_rows, n_cols <span class="op">*</span> n_channels)</span>
<span id="cb278-22"><a href="#cb278-22" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Compute SVD</span></span>
<span id="cb278-23"><a href="#cb278-23" aria-hidden="true" tabindex="-1"></a>    U, S, V <span class="op">=</span> np.linalg.svd(X_reshape, full_matrices<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb278-24"><a href="#cb278-24" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Keep only the top r first singular values</span></span>
<span id="cb278-25"><a href="#cb278-25" aria-hidden="true" tabindex="-1"></a>    S[r:] <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb278-26"><a href="#cb278-26" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Compute the approximation</span></span>
<span id="cb278-27"><a href="#cb278-27" aria-hidden="true" tabindex="-1"></a>    X_reshape_r <span class="op">=</span> U.dot(np.diag(S)).dot(V)</span>
<span id="cb278-28"><a href="#cb278-28" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Put it between 0 and 255 again and cast to integer type</span></span>
<span id="cb278-29"><a href="#cb278-29" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> X_reshape_r.clip(<span class="bu">min</span><span class="op">=</span><span class="dv">0</span>, <span class="bu">max</span><span class="op">=</span><span class="dv">255</span>).astype(<span class="st">'int'</span>)<span class="op">\</span></span>
<span id="cb278-30"><a href="#cb278-30" aria-hidden="true" tabindex="-1"></a>        .reshape(n_rows, n_cols, n_channels)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div id="b451719e" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2022-01-19T10:57:57.381214Z&quot;,&quot;start_time&quot;:&quot;2022-01-19T10:57:52.533636Z&quot;}" data-slideshow="{&quot;slide_type&quot;:&quot;subslide&quot;}" data-execution_count="148">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb279"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb279-1"><a href="#cb279-1" aria-hidden="true" tabindex="-1"></a>ranks <span class="op">=</span> [<span class="dv">100</span>, <span class="dv">70</span>, <span class="dv">50</span>, <span class="dv">30</span>, <span class="dv">10</span>, <span class="dv">5</span>]</span>
<span id="cb279-2"><a href="#cb279-2" aria-hidden="true" tabindex="-1"></a>n_ranks <span class="op">=</span> <span class="bu">len</span>(ranks)</span>
<span id="cb279-3"><a href="#cb279-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i, r <span class="kw">in</span> <span class="bu">enumerate</span>(ranks):</span>
<span id="cb279-4"><a href="#cb279-4" aria-hidden="true" tabindex="-1"></a>    X_r <span class="op">=</span> compute_approx(X, r)</span>
<span id="cb279-5"><a href="#cb279-5" aria-hidden="true" tabindex="-1"></a>    <span class="co"># plt.subplot(n_ranks, 1, i + 1)</span></span>
<span id="cb279-6"><a href="#cb279-6" aria-hidden="true" tabindex="-1"></a>    plt.figure(figsize<span class="op">=</span>(<span class="dv">5</span>, <span class="dv">5</span>))</span>
<span id="cb279-7"><a href="#cb279-7" aria-hidden="true" tabindex="-1"></a>    plt.imshow(X_r)</span>
<span id="cb279-8"><a href="#cb279-8" aria-hidden="true" tabindex="-1"></a>    _ <span class="op">=</span> plt.axis(<span class="st">'off'</span>)</span>
<span id="cb279-9"><a href="#cb279-9" aria-hidden="true" tabindex="-1"></a>    <span class="co"># plt.title(f'Rank {r} approximation of the racoon' % r, fontsize=16)</span></span>
<span id="cb279-10"><a href="#cb279-10" aria-hidden="true" tabindex="-1"></a>    plt.tight_layout()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="notebook02_numpy_files/figure-html/cell-149-output-1.png" width="470" height="358" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="notebook02_numpy_files/figure-html/cell-149-output-2.png" width="470" height="358" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="notebook02_numpy_files/figure-html/cell-149-output-3.png" width="470" height="358" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="notebook02_numpy_files/figure-html/cell-149-output-4.png" width="470" height="358" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="notebook02_numpy_files/figure-html/cell-149-output-5.png" width="470" height="358" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="notebook02_numpy_files/figure-html/cell-149-output-6.png" width="470" height="358" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Variations
</div>
</div>
<div class="callout-body-container callout-body">
<p>In the code above, we recompute the SVD of <code>X</code> for every element in list <code>rank</code>.<br>
In the next chunk, we compute the SVD once, and define a <em>generator</em> to generate the low rank approximations of matrix <code>X</code>. We take advantage of the fact that the SVD defines an orthonormal basis for the space of matrices. In this adapted orthonormal basis the optimal low rank approximations of <span class="math inline">\(X\)</span> have a sparse expansion.</p>
</div>
</div>
<div id="85e1e4bc" class="cell" data-execution_count="149">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb280"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb280-1"><a href="#cb280-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> gen_rank_k_approx(X):</span>
<span id="cb280-2"><a href="#cb280-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Generator for low rank </span></span>
<span id="cb280-3"><a href="#cb280-3" aria-hidden="true" tabindex="-1"></a><span class="co">    approximation of a matrix X using truncated SVD.</span></span>
<span id="cb280-4"><a href="#cb280-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb280-5"><a href="#cb280-5" aria-hidden="true" tabindex="-1"></a><span class="co">    Args:</span></span>
<span id="cb280-6"><a href="#cb280-6" aria-hidden="true" tabindex="-1"></a><span class="co">        X (numpy.ndarray): a numerical matrix</span></span>
<span id="cb280-7"><a href="#cb280-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb280-8"><a href="#cb280-8" aria-hidden="true" tabindex="-1"></a><span class="co">    Yields:</span></span>
<span id="cb280-9"><a href="#cb280-9" aria-hidden="true" tabindex="-1"></a><span class="co">        (int,numpy.ndarray): rank k and best rank-k approximation of X using truncated SVD(according to Eckart-Young theorem).</span></span>
<span id="cb280-10"><a href="#cb280-10" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span>  </span>
<span id="cb280-11"><a href="#cb280-11" aria-hidden="true" tabindex="-1"></a>    U, S, V <span class="op">=</span> np.linalg.svd(X, full_matrices<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb280-12"><a href="#cb280-12" aria-hidden="true" tabindex="-1"></a>    r <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb280-13"><a href="#cb280-13" aria-hidden="true" tabindex="-1"></a>    Y <span class="op">=</span> np.zeros_like(X, dtype<span class="op">=</span><span class="st">'float64'</span>)</span>
<span id="cb280-14"><a href="#cb280-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> (r<span class="op">&lt;</span><span class="bu">len</span>(S)):</span>
<span id="cb280-15"><a href="#cb280-15" aria-hidden="true" tabindex="-1"></a>      Y <span class="op">=</span> Y <span class="op">+</span> S[r] <span class="op">*</span> (U[:,r,np.newaxis] <span class="op">@</span> V[r,:, np.newaxis].T)</span>
<span id="cb280-16"><a href="#cb280-16" aria-hidden="true" tabindex="-1"></a>      r <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb280-17"><a href="#cb280-17" aria-hidden="true" tabindex="-1"></a>      <span class="cf">yield</span> r, Y</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div id="ea93c0e9" class="cell" data-execution_count="150">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb281"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb281-1"><a href="#cb281-1" aria-hidden="true" tabindex="-1"></a>g <span class="op">=</span> gen_rank_k_approx(X_reshaped) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div id="335449d9" class="cell" data-execution_count="151">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb282"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb282-1"><a href="#cb282-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">100</span>):</span>
<span id="cb282-2"><a href="#cb282-2" aria-hidden="true" tabindex="-1"></a>    _, Xr <span class="op">=</span> <span class="bu">next</span>(g)</span>
<span id="cb282-3"><a href="#cb282-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> i <span class="op">%</span> <span class="dv">10</span> <span class="op">==</span><span class="dv">0</span>:  </span>
<span id="cb282-4"><a href="#cb282-4" aria-hidden="true" tabindex="-1"></a>      plt.figure(figsize<span class="op">=</span>(<span class="dv">5</span>, <span class="dv">5</span>))</span>
<span id="cb282-5"><a href="#cb282-5" aria-hidden="true" tabindex="-1"></a>      plt.imshow(</span>
<span id="cb282-6"><a href="#cb282-6" aria-hidden="true" tabindex="-1"></a>          Xr</span>
<span id="cb282-7"><a href="#cb282-7" aria-hidden="true" tabindex="-1"></a>          .clip(<span class="bu">min</span><span class="op">=</span><span class="dv">0</span>, <span class="bu">max</span><span class="op">=</span><span class="dv">255</span>)</span>
<span id="cb282-8"><a href="#cb282-8" aria-hidden="true" tabindex="-1"></a>          .astype(<span class="st">'int'</span>)</span>
<span id="cb282-9"><a href="#cb282-9" aria-hidden="true" tabindex="-1"></a>          .reshape(n_rows, n_cols, n_channels)</span>
<span id="cb282-10"><a href="#cb282-10" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb282-11"><a href="#cb282-11" aria-hidden="true" tabindex="-1"></a>      _ <span class="op">=</span> plt.axis(<span class="st">'off'</span>)</span>
<span id="cb282-12"><a href="#cb282-12" aria-hidden="true" tabindex="-1"></a>      plt.tight_layout()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="notebook02_numpy_files/figure-html/cell-152-output-1.png" width="470" height="358" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="notebook02_numpy_files/figure-html/cell-152-output-2.png" width="470" height="358" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="notebook02_numpy_files/figure-html/cell-152-output-3.png" width="470" height="358" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="notebook02_numpy_files/figure-html/cell-152-output-4.png" width="470" height="358" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="notebook02_numpy_files/figure-html/cell-152-output-5.png" width="470" height="358" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="notebook02_numpy_files/figure-html/cell-152-output-6.png" width="470" height="358" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="notebook02_numpy_files/figure-html/cell-152-output-7.png" width="470" height="358" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="notebook02_numpy_files/figure-html/cell-152-output-8.png" width="470" height="358" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="notebook02_numpy_files/figure-html/cell-152-output-9.png" width="470" height="358" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="notebook02_numpy_files/figure-html/cell-152-output-10.png" width="470" height="358" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Visit <a href="https://numpy.org/numpy-tutorials/content/tutorial-svd.html" class="uri">https://numpy.org/numpy-tutorials/content/tutorial-svd.html</a></p>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/s-v-b\.github\.io\/IFEBY310\/");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
          // target, if specified
          link.setAttribute("target", "_blank");
          if (link.getAttribute("rel") === null) {
            link.setAttribute("rel", "noopener");
          }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p>© Copyright 2024, Stéphane Boucheron</p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    <div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/s-v-b/IFEBY310/edit/main/core/notebooks/notebook02_numpy.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/s-v-b/IFEBY310/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></div>
    <div class="nav-footer-right">
<p>This page is built with blood, sweat, tears, and <a href="https://quarto.org/">Quarto</a>.</p>
</div>
  </div>
</footer>




</body></html>