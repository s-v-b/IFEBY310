<!DOCTYPE html>
<html lang="en-US"><head>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-html/tabby.min.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/light-border.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-e2182856f2c32102dd26b05a5ef16cb5.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/quarto-contrib/reveal-header-1.0.0/add_header.js" defer="true"></script>
<link href="../../site_libs/quarto-contrib/reveal-header-1.0.0/add_header.css" rel="stylesheet">
<link href="../../site_libs/quarto-contrib/grid-no-htext-1.0.0/grid_no_htext.css" rel="stylesheet">
<script src="../../site_libs/quarto-contrib/pseudocode-2.4.1/pseudocode.min.js"></script>
<link href="../../site_libs/quarto-contrib/pseudocode-2.4.1/pseudocode.min.css" rel="stylesheet">
<link href="../../site_libs/quarto-contrib/fontawesome6-1.2.0/all.min.css" rel="stylesheet">
<link href="../../site_libs/quarto-contrib/fontawesome6-1.2.0/latex-fontsize.css" rel="stylesheet"><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.30">
<meta name="author" content="Équipe de Statistique">
<meta name="dcterms.date" content="2025-01-17">
<title>IFEBY310 - Spring 2025 – Spark Presentation</title>
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
<link rel="stylesheet" href="../../site_libs/revealjs/dist/reset.css">
<link rel="stylesheet" href="../../site_libs/revealjs/dist/reveal.css">
<style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
    /* CSS for syntax highlighting */
    html { -webkit-text-size-adjust: 100%; }
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
      }
    pre.numberSource { margin-left: 3em;  padding-left: 4px; }
    div.sourceCode
      { color: #e1e4e8; background-color: #24292e; }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #e1e4e8; } /* Normal */
    code span.al { color: #ff5555; font-weight: bold; } /* Alert */
    code span.an { color: #6a737d; } /* Annotation */
    code span.at { color: #f97583; } /* Attribute */
    code span.bn { color: #79b8ff; } /* BaseN */
    code span.bu { color: #f97583; } /* BuiltIn */
    code span.cf { color: #f97583; } /* ControlFlow */
    code span.ch { color: #9ecbff; } /* Char */
    code span.cn { color: #79b8ff; } /* Constant */
    code span.co { color: #6a737d; } /* Comment */
    code span.cv { color: #6a737d; } /* CommentVar */
    code span.do { color: #6a737d; } /* Documentation */
    code span.dt { color: #f97583; } /* DataType */
    code span.dv { color: #79b8ff; } /* DecVal */
    code span.er { color: #ff5555; text-decoration: underline; } /* Error */
    code span.ex { color: #f97583; font-weight: bold; } /* Extension */
    code span.fl { color: #79b8ff; } /* Float */
    code span.fu { color: #b392f0; } /* Function */
    code span.im { color: #9ecbff; } /* Import */
    code span.in { color: #6a737d; } /* Information */
    code span.kw { color: #f97583; } /* Keyword */
    code span.op { color: #e1e4e8; } /* Operator */
    code span.ot { color: #b392f0; } /* Other */
    code span.pp { color: #f97583; } /* Preprocessor */
    code span.re { color: #6a737d; } /* RegionMarker */
    code span.sc { color: #79b8ff; } /* SpecialChar */
    code span.ss { color: #9ecbff; } /* SpecialString */
    code span.st { color: #9ecbff; } /* String */
    code span.va { color: #ffab70; } /* Variable */
    code span.vs { color: #9ecbff; } /* VerbatimString */
    code span.wa { color: #ff5555; } /* Warning */
  </style>
<link rel="stylesheet" href="../../site_libs/revealjs/dist/theme/quarto-cea8bd4d0ffd43e334db3cf8b0e9d7b6.css">
<link href="../../site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
<link href="../../site_libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
<link href="../../site_libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
<link href="../../site_libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
<style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
<script>
  MathJax = {
    loader: {
      load: ['[tex]/boldsymbol']
    },
    tex: {
      tags: "all",
      inlineMath: [['$','$'], ['\\(','\\)']],
      displayMath: [['$$','$$'], ['\\[','\\]']],
      processEscapes: true,
      processEnvironments: true,
      packages: {
        '[+]': ['boldsymbol']
      }
    }
  };
  </script><script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>
<meta property="og:title" content="Spark Presentation – IFEBY310 - Spring 2025">
<meta property="og:description" content="Technologies Big Data Master MIDS/MFA/LOGOIS">
<meta property="og:site_name" content="IFEBY310 - Spring 2025">
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" data-background-color="#1c191c" class="quarto-title-block center"><h1 class="title">Spark Presentation</h1>
  <p class="subtitle"><a href="https://s-v-b.github.io/IFEBY030/">Technologies Big Data Master MIDS/MFA/LOGOIS</a></p>

<div class="quarto-title-authors">
<div class="quarto-title-author">
<div class="quarto-title-author-name">
Équipe de Statistique 
</div>
        <p class="quarto-title-affiliation">
            <a href="https://u-paris.fr">LPSM Université Paris-Cité</a>
          </p>
    </div>
</div>

  <p class="date">2025-01-17</p>
</section><section id="TOC"><nav role="doc-toc"><h2 id="toc-title">Roadmap</h2>
<ul>
<li><a href="#/spark-in-perspective" id="/toc-spark-in-perspective">Spark in perspective</a></li>
<li><a href="#/spark-organization" id="/toc-spark-organization">Spark organization</a></li>
<li><a href="#/spark-sql-and-dataframes" id="/toc-spark-sql-and-dataframes">Spark SQL and Dataframes</a></li>
<li><a href="#/spark-apis-for-r" id="/toc-spark-apis-for-r">Spark APIs for <code>R</code></a></li>
<li><a href="#/pandas-spark-api" id="/toc-pandas-spark-api">Pandas Spark API</a></li>
</ul></nav></section><section><section id="spark-in-perspective" class="title-slide slide level1 center" data-background-color="#1c191c"><h1>Spark in perspective</h1>

</section><section id="from-the-archive" class="slide level2 center"><h2>From the archive</h2>
<dl>
<dt>Spark project</dt>
<dd>
<p>launched in 2010 by M. Zaharia (UC Berkeley) et al.</p>
</dd>
</dl>
<div class="fragment">
<dl>
<dt>Spark 1.0.0 released (May 30, 2014):</dt>
<dd>
<p>… This release expands Spark’s standard libraries, introducing a new SQL package (Spark SQL) that lets users integrate SQL queries into existing Spark workflows. MLlib, Spark’s machine learning library, is expanded with sparse vector support and several new algorithms. The GraphX and Streaming libraries also introduce new features and optimizations. Spark’s core engine adds support for secured YARN clusters, a unified tool for submitting Spark applications, and several performance and stability improvements.</p>
</dd>
</dl>
</div>
<div class="fragment">
<dl>
<dt>Spark 2.0.0 released (July 26, 2016)</dt>
<dd>
<p>The major updates are API usability, SQL 2003 support, performance improvements, structured streaming, R UDF support, as well as operational improvements.</p>
</dd>
</dl>
</div>
</section><section id="from-the-archive-continued" class="slide level2 center"><h2>From the archive (continued)</h2>
<dl>
<dt>Spark 3.0.0 released (June 18, 2020)</dt>
<dd>
<p>… This year is Spark’s 10-year anniversary as an open source project. Since its initial release in 2010, Spark has grown to be one of the most active open source projects. Nowadays, Spark is the de facto unified engine for big data processing, data science, machine learning and data analytics workloads.</p>
</dd>
</dl>
<div class="fragment">
<p>Spark SQL is the top active component in this release. 46% of the resolved tickets are for Spark SQL. These enhancements benefit all the higher-level libraries, including structured streaming and MLlib, and higher level APIs, including SQL and DataFrames. Various related optimizations are added in this release. In TPC-DS 30TB benchmark, Spark 3.0 is roughly two times faster than Spark 2.4.</p>
<aside class="notes"><p>Python is now the most widely used language on Spark. PySpark has more than 5 million monthly downloads on PyPI, the Python Package Index. This release improves its functionalities and usability, including the pandas UDF API redesign with Python type hints, new pandas UDF types, and more Pythonic error handling.</p>
<p>Here are the feature highlights in Spark 3.0: adaptive query execution; dynamic partition pruning; ANSI SQL compliance; significant improvements in pandas APIs; new UI for structured streaming; up to 40x speedups for calling R user-defined functions; accelerator-aware scheduler; and SQL reference documentation.</p>
<p>From <a href="https://spark.apache.org/releases/spark-release-3-0-0.html" class="uri">https://spark.apache.org/releases/spark-release-3-0-0.html</a></p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside><aside class="notes"><blockquote>
<p>“Présentation de l’outil SPARK. Cette séance offrira tout d’abord un aperçu général et théorique du développement de cette technologie, un rappel historique et des solutions existantes, la scalabilité, entre autres. Un second volet de la présentation se concentrera sur l’application de cette technologie dans la recherche, avec une démonstration pratique illustrant son utilisation.”</p>
</blockquote>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</div>
</section><section id="why-spark" class="slide level2 center"><h2>Why Spark?</h2>
<div class="columns">
<div class="column" style="width:60%;">
<ul>
<li class="fragment"><p>Scalability</p></li>
<li class="fragment"><p>Beyond OLTP: OLAP (and BI)</p></li>
<li class="fragment"><p>From Data Mining to Big Data</p></li>
<li class="fragment"><p>From Datawarehouses to Datalakes</p></li>
</ul>
<div class="fragment fade-in">
<ul>
<li>MapReduce <i class="fa-brands fa-google" aria-label="google"></i>
</li>
</ul>
</div>
<div class="fragment fade-in">
<ul>
<li>Apache Hadoop</li>
</ul>
</div>
<div class="fragment fade-in">
<ul>
<li>Hive <i class="fa-brands fa-hive" aria-label="hive"></i> <i class="fa-brands fa-facebook" aria-label="facebook"></i>
<ul>
<li>Before 2010, de facto big data SQL API</li>
<li>Helped propel <code>Hadoop</code> to industry</li>
</ul>
</li>
</ul>
</div>
</div><div class="column" style="width:40%;">
<div class="fragment fade-in">
<div class="quarto-figure quarto-figure-center">
<figure><p><img data-src="IMG/harrison_next_gen_database.jpg"></p>
<figcaption>1995-2005 Beyond ACID SQL</figcaption></figure>
</div>
</div>
</div></div>
</section></section><section><section id="spark-organization" class="title-slide slide level1 center" data-background-color="#1c191c"><h1>Spark organization</h1>

</section><section class="slide level2 center"><div class="columns">
<div class="column">
<div class="quarto-figure quarto-figure-center">
<figure><p><img data-src="IMG/cluster-overview.png"></p>
<figcaption>Cluster overview from Spark official documentation</figcaption></figure>
</div>
</div><div class="column">
<div class="fragment fade-in-out">
<div class="callout callout-note callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Note</strong></p>
</div>
<div class="callout-content">
<ul>
<li>There is one master per cluster.</li>
<li>The cluster manager/master is launched by <code>start-master.sh</code>.</li>
<li>There are as many workers per machine on the cluster.</li>
<li>A worker process is launched by <code>start-worker.sh</code> (standalone mode)</li>
<li>Spark applications (interactive or not) exchange informations using a driver process.</li>
<li>Master is per cluster, and driver is per application.</li>
</ul>
</div>
</div>
</div>
</div>
</div></div>
</section><section id="section" class="slide level2 center"><h2></h2>

<img data-src="./IMG/spark_archi.png" class="r-stretch"></section><section id="sparksession" class="slide level2 center"><h2>Sparksession</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a></a><span class="im">from</span> pyspark.sql <span class="im">import</span> SparkSession</span>
<span id="cb1-2"><a></a></span>
<span id="cb1-3"><a></a>spark <span class="op">=</span> (</span>
<span id="cb1-4"><a></a>    SparkSession </span>
<span id="cb1-5"><a></a>        .builder </span>
<span id="cb1-6"><a></a>        .appName(<span class="st">"Presentation"</span>) </span>
<span id="cb1-7"><a></a>        .getOrCreate()</span>
<span id="cb1-8"><a></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell fragment">

</div>
</section></section><section><section id="spark-sql-and-dataframes" class="title-slide slide level1 center" data-background-color="#1c191c"><h1>Spark SQL and Dataframes</h1>

</section><section class="slide level2 center"><div class="middle">
<div class="center">
<p><img data-src="./IMG/pyspark-apis.png"></p>
</div>
</div>
</section><section id="spark-core" class="slide level2 center"><h2>Spark core</h2>
<ul>
<li>Implements the <code>RDD</code> (Resilient Distributed Datasets)</li>
</ul>
<div class="fragment">
<ul>
<li>Spark project was launched to implement the RDD concept presented by Zaharia et al at the end of the 2000’</li>
</ul>
</div>
<div class="fragment">
<ul>
<li>In words, RDDs behave like distributed, fault-tolerant, Python collections (list or dict)</li>
</ul>
</div>
<div class="fragment">
<ul>
<li>RDDs areo <em>immutable</em>, they can be <em>transformed</em> using <code>map</code> like operations, transformed RDDs can be <em>reduced</em>, and the result can be <code>collected</code> to the driver process</li>
</ul>
</div>
</section><section id="spark-sql-and-hive-hadoop-interactive" class="slide level2 center"><h2>Spark SQL and <code>HIVE</code> (Hadoop InteractiVE)</h2>
<p>Spark SQL relies on Hive SQL’s conventions and functions</p>
<p>Since release 2.0, Spark offers a native SQL parser that supports ANSI-SQL and HiveQL</p>
<p>Works for analysts, data engineers, data scientists</p>
<div class="fragment">
<div class="callout callout-caution callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Spark-SQL is geared towards OLAP not OLTP</strong></p>
</div>
<div class="callout-content">

</div>
</div>
</div>
</div>
</section><section id="rows" class="slide level2 center"><h2>Rows</h2>
<p>Spark dataframes are RDDs (collections of <code>Row</code>s)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2" data-code-line-numbers="3-5|12|14"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a></a><span class="im">from</span> pyspark.sql <span class="im">import</span> Row</span>
<span id="cb2-2"><a></a></span>
<span id="cb2-3"><a></a>row1 <span class="op">=</span> Row(name<span class="op">=</span><span class="st">"John"</span>, age<span class="op">=</span><span class="dv">21</span>)</span>
<span id="cb2-4"><a></a>row2 <span class="op">=</span> Row(name<span class="op">=</span><span class="st">"James"</span>, age<span class="op">=</span><span class="dv">32</span>)</span>
<span id="cb2-5"><a></a>row3 <span class="op">=</span> Row(name<span class="op">=</span><span class="st">"Jane"</span>, age<span class="op">=</span><span class="dv">18</span>)</span>
<span id="cb2-6"><a></a></span>
<span id="cb2-7"><a></a>row1[<span class="st">'name'</span>]</span>
<span id="cb2-8"><a></a></span>
<span id="cb2-9"><a></a>rows <span class="op">=</span> [row1, row2, row3]</span>
<span id="cb2-10"><a></a>column_names <span class="op">=</span> [<span class="st">"Name"</span>, <span class="st">"Age"</span>]</span>
<span id="cb2-11"><a></a></span>
<span id="cb2-12"><a></a>df <span class="op">=</span> spark.createDataFrame(rows, column_names)</span>
<span id="cb2-13"><a></a></span>
<span id="cb2-14"><a></a>df.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell fragment">

</div>
</section><section id="schema" class="slide level2 center"><h2>Schema</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a></a>df.printSchema()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell fragment">

</div>
</section><section id="from-dataframes-to-rdds" class="slide level2 center"><h2>From dataframes to <code>RDDs</code>
</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a></a><span class="bu">print</span>(df.rdd.toDebugString().decode(<span class="st">"utf-8"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell fragment">

</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a></a>df.rdd.getNumPartitions()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell fragment">

</div>
</section><section id="spark-dataframe-api" class="slide level2 center"><h2>Spark dataframe API</h2>
<p>The Spark dataframe API offers a developper-friendly API for implementing</p>
<ul>
<li>Relational algebra <span class="math inline">\(\sigma, \pi, \bowtie, \cup, \cap, \setminus\)</span>
</li>
<li>Partitionning <code>GROUP BY</code>
</li>
<li>Aggregation and Window functions</li>
</ul>
<div class="fragment">
<p>Compare the Spark <code>Dataframe</code> API with:</p>
<p><i class="fa-brands fa-r-project" aria-label="r-project"></i> <code>dplyr</code>, <code>dtplyr</code>, <code>dbplyr</code> in <code>R</code> <code>Tidyverse</code></p>
<p><i class="fa-brands fa-python" aria-label="python"></i> <code>Pandas</code></p>
<p><i class="fa-brands fa-python" aria-label="python"></i> <code>Pandas on Spark</code></p>
<p>Chaining and/or piping enable modular query construction</p>
</div>
</section><section id="basic-single-tables-operations-methodsverbs" class="slide level2 center"><h2>Basic Single Tables Operations (methods/verbs)</h2>
<table class="caption-top">
<colgroup>
<col style="width: 44%">
<col style="width: 55%">
</colgroup>
<thead><tr class="header">
<th style="text-align: left;">Operation</th>
<th style="text-align: left;">Description</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><code>select</code></td>
<td style="text-align: left;">Chooses columns from the table <span class="math inline">\(\pi\)</span>
</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>selectExpr</code></td>
<td style="text-align: left;">Chooses columns and expressions from table <span class="math inline">\(\pi\)</span>
</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>where</code></td>
<td style="text-align: left;">Filters rows based on a boolean rule <span class="math inline">\(\sigma\)</span>
</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>limit</code></td>
<td style="text-align: left;">Limits the number of rows <code>LIMIT ...</code>
</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>orderBy</code></td>
<td style="text-align: left;">Sorts the DataFrame based on one or more columns <code>ORDER BY ...</code>
</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>alias</code></td>
<td style="text-align: left;">Changes the name of a column <code>AS ...</code>
</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>cast</code></td>
<td style="text-align: left;">Changes the type of a column</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>withColumn</code></td>
<td style="text-align: left;">Adds a new column</td>
</tr>
</tbody>
</table></section><section id="toy-example" class="slide level2 center"><h2>Toy example</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a></a>column_names <span class="op">=</span> [<span class="st">"name"</span>, <span class="st">"age"</span>, <span class="st">"gender"</span>]</span>
<span id="cb6-2"><a></a>rows <span class="op">=</span> [</span>
<span id="cb6-3"><a></a>        [<span class="st">"John"</span>, <span class="dv">21</span>, <span class="st">"male"</span>],</span>
<span id="cb6-4"><a></a>        [<span class="st">"Jane"</span>, <span class="dv">25</span>, <span class="st">"female"</span>]</span>
<span id="cb6-5"><a></a>    ]</span>
<span id="cb6-6"><a></a>df <span class="op">=</span> spark.createDataFrame(rows, column_names)</span>
<span id="cb6-7"><a></a></span>
<span id="cb6-8"><a></a>df.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell fragment">

</div>
</section><section id="querying-sql-style" class="slide level2 center"><h2>Querying SQL style</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a></a><span class="co">## Create a temporary view from the DataFrame</span></span>
<span id="cb7-2"><a></a>df.createOrReplaceTempView(<span class="st">"new_view"</span>)</span>
<span id="cb7-3"><a></a></span>
<span id="cb7-4"><a></a><span class="co">## Define the query</span></span>
<span id="cb7-5"><a></a>query <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb7-6"><a></a><span class="st">  SELECT name, age </span></span>
<span id="cb7-7"><a></a><span class="st">  FROM new_view </span></span>
<span id="cb7-8"><a></a><span class="st">  WHERE gender='male'</span></span>
<span id="cb7-9"><a></a><span class="st">"""</span></span>
<span id="cb7-10"><a></a></span>
<span id="cb7-11"><a></a>men_df <span class="op">=</span> spark.sql(query)</span>
<span id="cb7-12"><a></a>men_df.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell fragment">

</div>
</section><section id="select" class="slide level2 center"><h2>Select</h2>
<p>The argument of <code>select()</code> is <code>*cols</code> where <code>cols</code> can be built from column names (strings), column expressions like <code>df.age + 10</code>, lists</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a></a>df.select(df.name.alias(<span class="st">"nom"</span>), df.age<span class="op">+</span><span class="dv">10</span> ).show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell fragment">

</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a></a>df.select([c <span class="cf">for</span> c <span class="kw">in</span> df.columns <span class="cf">if</span> <span class="st">"a"</span> <span class="kw">in</span> c]).show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell fragment">

</div>
</section><section id="adding-new-columns" class="slide level2 center"><h2>Adding new columns</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a></a><span class="co">## In a SQL query:</span></span>
<span id="cb10-2"><a></a>query <span class="op">=</span> <span class="st">"SELECT *, 12*age AS age_months FROM table"</span></span>
<span id="cb10-3"><a></a></span>
<span id="cb10-4"><a></a><span class="co">## Using Spark SQL API:</span></span>
<span id="cb10-5"><a></a>df.withColumn(<span class="st">"age_months"</span>, df.age <span class="op">*</span> <span class="dv">12</span>).show()</span>
<span id="cb10-6"><a></a></span>
<span id="cb10-7"><a></a><span class="co">## Or</span></span>
<span id="cb10-8"><a></a>df.select(<span class="st">"*"</span>, </span>
<span id="cb10-9"><a></a>          (df.age <span class="op">*</span> <span class="dv">12</span>).alias(<span class="st">"age_months"</span>)</span>
<span id="cb10-10"><a></a>  ).show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell fragment">

</div>
</section><section id="basic-operations" class="slide level2 center"><h2>Basic operations</h2>
<ul>
<li><p>The <em>full list of operations</em> that can be applied to a <code>DataFrame</code> can be found in the <a href="http://spark.apache.org/docs/latest/api/python/pyspark.sql.html#pyspark.sql.DataFrame">[DataFrame doc]</a></p></li>
<li><p>The <em>list of operations on columns</em> can be found in the <a href="http://spark.apache.org/docs/latest/api/python/pyspark.sql.html#pyspark.sql.Column">[Column docs]</a></p></li>
</ul></section></section><section><section id="spark-apis-for-r" class="title-slide slide level1 center" data-background-color="#1c191c"><h1>Spark APIs for <code>R</code>
</h1>

</section><section id="sparkr-and-sparklyr" class="slide level2 center"><h2>
<code>sparkR</code> and <code>sparklyr</code>
</h2>
<div class="fragment fade-in-then-semi-out">
<ul>
<li>
<code>sparkR</code> is the official Spark API for <code>R</code> users</li>
</ul>
</div>
<div class="fragment fade-in">
<ul>
<li>
<code>sparklyr</code> (released 2016) is the de facto Spark API for <code>tidyverse</code>
</li>
</ul>
</div>
</section><section id="a-glimpse-at-sparklyr" class="slide level2 center"><h2>A glimpse at Sparklyr</h2>
<div class="fragment fade-in">
<p>Spark dataframes can be handled through <code>dplyr</code> pipelines</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a></a><span class="co">#| code-line-numbers: |4|5|6|7</span></span>
<span id="cb11-2"><a></a>sc <span class="ot">&lt;-</span> <span class="fu">spark_connect</span>(<span class="at">master=</span><span class="st">"local"</span>, <span class="at">version=</span><span class="st">"3.5"</span>)</span>
<span id="cb11-3"><a></a>wh <span class="ot">&lt;-</span> <span class="fu">copy_to</span>(sc, whiteside)</span>
<span id="cb11-4"><a></a></span>
<span id="cb11-5"><a></a>wh <span class="sc">|&gt;</span> </span>
<span id="cb11-6"><a></a>    <span class="fu">group_by</span>(Insul) <span class="sc">|&gt;</span> </span>
<span id="cb11-7"><a></a>    <span class="fu">mutate</span>(<span class="at">Fn=</span>(<span class="dv">1</span><span class="sc">+</span><span class="fu">n</span>()<span class="sc">-</span><span class="fu">min_rank</span>(<span class="fu">desc</span>(Temp)))<span class="sc">/</span><span class="fu">n</span>()) <span class="sc">|&gt;</span> </span>
<span id="cb11-8"><a></a>    <span class="fu">arrange</span>(Insul, Temp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="fragment fade-in">
<pre><code># Source:     spark&lt;?&gt; [?? x 4]
# Groups:     Insul
# Ordered by: Insul, Temp
   Insul  Temp   Gas     Fn
   &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;
 1 After  -0.7   4.8 0.0333
 2 After   0.8   4.6 0.0667
 3 After   1     4.7 0.1   
 4 After   1.4   4   0.133 
 5 After   1.5   4.2 0.167 
 6 After   1.6   4.2 0.2   
 7 After   2.3   4.1 0.233 
 8 After   2.5   4   0.3   
 9 After   2.5   3.5 0.3   
10 After   3.1   3.2 0.333 
# ℹ more rows
# ℹ Use `print(n = ...)` to see more rows</code></pre>
</div>
</section><section id="under-the-hood" class="slide level2 center"><h2>Under the hood</h2>
<div class="sourceCode" id="cb13"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a></a><span class="sc">&gt;</span> wh <span class="sc">|&gt;</span>  </span>
<span id="cb13-2"><a></a>    <span class="fu">summarise</span>(<span class="at">x=</span><span class="fu">quantile</span>(Temp,.<span class="dv">25</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb13-3"><a></a>    <span class="fu">show_query</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="fragment fade-in">
<pre><code>&lt;SQL&gt;
SELECT PERCENTILE_CONT(0.25) WITHIN GROUP (ORDER BY `Temp`) AS `x`
FROM `whiteside`</code></pre>
</div>
<div class="fragment fade-in">
<p><code>dplyr</code> queries are translated into <code>Spark/Hive SQL</code></p>
<p><i class="fa-solid fa-hand-point-right" aria-label="hand-point-right"></i> <code><a href="https://rdrr.io/r/stats/quantile.html">quantile()</a></code> is a <code>base R</code> function, it is matched to the <code>Spark/Hive</code> <code>percentile()</code> function</p>
<p><code>sparklyr</code> aims at avoiding sending <code>R</code> functions/objects across the cluster</p>
</div>
</section><section id="in-words" class="slide level2 center"><h2>In words</h2>
<blockquote>
<p>… <code>sparklyr</code> translates <code>dplyr</code> functions such as <code>arrange</code> into a SQL query plan that is used by SparkSQL. This is not the case with <code>SparkR</code>, which has functions for SparkSQL tables and Spark DataFrames.</p>
</blockquote>
<div class="fragment">
<blockquote>
<p>… Databricks does not recommended combining <code>SparkR</code> and <code>sparklyr</code> APIs in the same script, notebook, or job.</p>
</blockquote>
</div>
</section><section id="section-1" class="slide level2 center" data-background-iframe="https://therinspark.com"><h2></h2>
</section></section><section><section id="pandas-spark-api" class="title-slide slide level1 center" data-background-color="#1c191c"><h1>Pandas Spark API</h1>

</section><section class="slide level2 center"><blockquote>
<p>Apache Spark includes Arrow-optimized execution of Python logic in the form of <code>pandas</code> function APIs, which allow users to apply <code>pandas</code> transformations directly to PySpark DataFrames. Apache Spark also supports <code>pandas</code> UDFs, which use similar Arrow-optimizations for arbitrary user functions defined in Python.</p>
</blockquote>
</section><section id="section-2" class="slide level2 center" data-background-iframe="https://spark.apache.org/docs/latest/api/python/getting_started/quickstart_ps.html"><h2></h2>


<div class="reveal-header">
<div class="header-logo" data-header-logo-link="https://u-paris.fr">
<img data-src="../../images/logo.png">
</div>
<div class="sc-title">
<p> </p>
</div>
<div class="header-text">
<p> </p>
</div>
<div class="sb-title">
<p> </p>
</div>
</div>
</section></section>
</div>
  <div class="quarto-auto-generated-content" style="display: none;">
<div class="footer footer-default">
<p><a href="http://s-v-b.github.io/IFEBY310">IFEBY030</a> – Technos Big Data – M1 MIDS/MFA/LOGOS – UParis Cité</p>
</div>
</div></div>

  <script>window.backupDefine = window.define; window.define = undefined;</script><script src="../../site_libs/revealjs/dist/reveal.js"></script><!-- reveal.js plugins --><script src="../../site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script><script src="../../site_libs/revealjs/plugin/pdf-export/pdfexport.js"></script><script src="../../site_libs/revealjs/plugin/reveal-menu/menu.js"></script><script src="../../site_libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script><script src="../../site_libs/revealjs/plugin/quarto-support/support.js"></script><script src="../../site_libs/revealjs/plugin/notes/notes.js"></script><script src="../../site_libs/revealjs/plugin/search/search.js"></script><script src="../../site_libs/revealjs/plugin/zoom/zoom.js"></script><script src="../../site_libs/revealjs/plugin/math/math.js"></script><script>window.define = window.backupDefine; window.backupDefine = undefined;</script><script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': false,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'jumpToSlide': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleScrollView(event)\"><kbd>r</kbd> Scroll View Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"5\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: true,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'bottom-right',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: 'c/t',

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: true,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'default',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: true,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'none',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1050,

        height: 700,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/MathJax.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script><script>
      // htmlwidgets need to know to resize themselves when slides are shown/hidden.
      // Fire the "slideenter" event (handled by htmlwidgets.js) when the current
      // slide changes (different for each slide format).
      (function () {
        // dispatch for htmlwidgets
        function fireSlideEnter() {
          const event = window.document.createEvent("Event");
          event.initEvent("slideenter", true, true);
          window.document.dispatchEvent(event);
        }

        function fireSlideChanged(previousSlide, currentSlide) {
          fireSlideEnter();

          // dispatch for shiny
          if (window.jQuery) {
            if (previousSlide) {
              window.jQuery(previousSlide).trigger("hidden");
            }
            if (currentSlide) {
              window.jQuery(currentSlide).trigger("shown");
            }
          }
        }

        // hookup for slidy
        if (window.w3c_slidy) {
          window.w3c_slidy.add_observer(function (slide_num) {
            // slide_num starts at position 1
            fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);
          });
        }

      })();
    </script><script id="quarto-html-after-body" type="application/javascript">
      window.document.addEventListener("DOMContentLoaded", function (event) {
        const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
        tabsets.forEach(function(tabset) {
          const tabby = new Tabby('#' + tabset.id);
        });
        const isCodeAnnotation = (el) => {
          for (const clz of el.classList) {
            if (clz.startsWith('code-annotation-')) {                     
              return true;
            }
          }
          return false;
        }
        const onCopySuccess = function(e) {
          // button target
          const button = e.trigger;
          // don't keep focus
          button.blur();
          // flash "checked"
          button.classList.add('code-copy-button-checked');
          var currentTitle = button.getAttribute("title");
          button.setAttribute("title", "Copied!");
          let tooltip;
          if (window.bootstrap) {
            button.setAttribute("data-bs-toggle", "tooltip");
            button.setAttribute("data-bs-placement", "left");
            button.setAttribute("data-bs-title", "Copied!");
            tooltip = new bootstrap.Tooltip(button, 
              { trigger: "manual", 
                customClass: "code-copy-button-tooltip",
                offset: [0, -8]});
            tooltip.show();    
          }
          setTimeout(function() {
            if (tooltip) {
              tooltip.hide();
              button.removeAttribute("data-bs-title");
              button.removeAttribute("data-bs-toggle");
              button.removeAttribute("data-bs-placement");
            }
            button.setAttribute("title", currentTitle);
            button.classList.remove('code-copy-button-checked');
          }, 1000);
          // clear code selection
          e.clearSelection();
        }
        const getTextToCopy = function(trigger) {
            const codeEl = trigger.previousElementSibling.cloneNode(true);
            for (const childEl of codeEl.children) {
              if (isCodeAnnotation(childEl)) {
                childEl.remove();
              }
            }
            return codeEl.innerText;
        }
        const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
          text: getTextToCopy
        });
        clipboard.on('success', onCopySuccess);
        if (window.document.getElementById('quarto-embedded-source-code-modal')) {
          const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
            text: getTextToCopy,
            container: window.document.getElementById('quarto-embedded-source-code-modal')
          });
          clipboardModal.on('success', onCopySuccess);
        }
          var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
          var mailtoRegex = new RegExp(/^mailto:/);
            var filterRegex = new RegExp("https:\/\/s-v-b\.github\.io\/IFEBY310\/");
          var isInternal = (href) => {
              return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
          }
          // Inspect non-navigation links and adorn them if external
         var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
          for (var i=0; i<links.length; i++) {
            const link = links[i];
            if (!isInternal(link.href)) {
              // undo the damage that might have been done by quarto-nav.js in the case of
              // links that we want to consider external
              if (link.dataset.originalHref !== undefined) {
                link.href = link.dataset.originalHref;
              }
                // target, if specified
                link.setAttribute("target", "_blank");
                if (link.getAttribute("rel") === null) {
                  link.setAttribute("rel", "noopener");
                }
                // default icon
                link.classList.add("external");
            }
          }
        function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
          const config = {
            allowHTML: true,
            maxWidth: 500,
            delay: 100,
            arrow: false,
            appendTo: function(el) {
                return el.closest('section.slide') || el.parentElement;
            },
            interactive: true,
            interactiveBorder: 10,
            theme: 'light-border',
            placement: 'bottom-start',
          };
          if (contentFn) {
            config.content = contentFn;
          }
          if (onTriggerFn) {
            config.onTrigger = onTriggerFn;
          }
          if (onUntriggerFn) {
            config.onUntrigger = onUntriggerFn;
          }
            config['offset'] = [0,0];
            config['maxWidth'] = 700;
          window.tippy(el, config); 
        }
        const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
        for (var i=0; i<noterefs.length; i++) {
          const ref = noterefs[i];
          tippyHover(ref, function() {
            // use id or data attribute instead here
            let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
            try { href = new URL(href).hash; } catch {}
            const id = href.replace(/^#\/?/, "");
            const note = window.document.getElementById(id);
            if (note) {
              return note.innerHTML;
            } else {
              return "";
            }
          });
        }
            let selectedAnnoteEl;
            const selectorForAnnotation = ( cell, annotation) => {
              let cellAttr = 'data-code-cell="' + cell + '"';
              let lineAttr = 'data-code-annotation="' +  annotation + '"';
              const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
              return selector;
            }
            const selectCodeLines = (annoteEl) => {
              const doc = window.document;
              const targetCell = annoteEl.getAttribute("data-target-cell");
              const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
              const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
              const lines = annoteSpan.getAttribute("data-code-lines").split(",");
              const lineIds = lines.map((line) => {
                return targetCell + "-" + line;
              })
              let top = null;
              let height = null;
              let parent = null;
              if (lineIds.length > 0) {
                  //compute the position of the single el (top and bottom and make a div)
                  const el = window.document.getElementById(lineIds[0]);
                  top = el.offsetTop;
                  height = el.offsetHeight;
                  parent = el.parentElement.parentElement;
                if (lineIds.length > 1) {
                  const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
                  const bottom = lastEl.offsetTop + lastEl.offsetHeight;
                  height = bottom - top;
                }
                if (top !== null && height !== null && parent !== null) {
                  // cook up a div (if necessary) and position it 
                  let div = window.document.getElementById("code-annotation-line-highlight");
                  if (div === null) {
                    div = window.document.createElement("div");
                    div.setAttribute("id", "code-annotation-line-highlight");
                    div.style.position = 'absolute';
                    parent.appendChild(div);
                  }
                  div.style.top = top - 2 + "px";
                  div.style.height = height + 4 + "px";
                  div.style.left = 0;
                  let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
                  if (gutterDiv === null) {
                    gutterDiv = window.document.createElement("div");
                    gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                    gutterDiv.style.position = 'absolute';
                    const codeCell = window.document.getElementById(targetCell);
                    const gutter = codeCell.querySelector('.code-annotation-gutter');
                    gutter.appendChild(gutterDiv);
                  }
                  gutterDiv.style.top = top - 2 + "px";
                  gutterDiv.style.height = height + 4 + "px";
                }
                selectedAnnoteEl = annoteEl;
              }
            };
            const unselectCodeLines = () => {
              const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
              elementsIds.forEach((elId) => {
                const div = window.document.getElementById(elId);
                if (div) {
                  div.remove();
                }
              });
              selectedAnnoteEl = undefined;
            };
              // Handle positioning of the toggle
          window.addEventListener(
            "resize",
            throttle(() => {
              elRect = undefined;
              if (selectedAnnoteEl) {
                selectCodeLines(selectedAnnoteEl);
              }
            }, 10)
          );
          function throttle(fn, ms) {
          let throttle = false;
          let timer;
            return (...args) => {
              if(!throttle) { // first call gets through
                  fn.apply(this, args);
                  throttle = true;
              } else { // all the others get throttled
                  if(timer) clearTimeout(timer); // cancel #2
                  timer = setTimeout(() => {
                    fn.apply(this, args);
                    timer = throttle = false;
                  }, ms);
              }
            };
          }
            const annoteTargets = window.document.querySelectorAll('.code-annotation-anchor');
            for (let i=0; i<annoteTargets.length; i++) {
              const annoteTarget = annoteTargets[i];
              const targetCell = annoteTarget.getAttribute("data-target-cell");
              const targetAnnotation = annoteTarget.getAttribute("data-target-annotation");
              const contentFn = () => {
                const content = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
                if (content) {
                  const tipContent = content.cloneNode(true);
                  tipContent.classList.add("code-annotation-tip-content");
                  return tipContent.outerHTML;
                }
              }
              const config = {
                allowHTML: true,
                content: contentFn,
                onShow: (instance) => {
                  selectCodeLines(instance.reference);
                  instance.reference.classList.add('code-annotation-active');
                  window.tippy.hideAll();
                },
                onHide: (instance) => {
                  unselectCodeLines();
                  instance.reference.classList.remove('code-annotation-active');
                },
                maxWidth: 300,
                delay: [50, 0],
                duration: [200, 0],
                offset: [5, 10],
                arrow: true,
                appendTo: function(el) {
                  return el.parentElement.parentElement.parentElement;
                },
                interactive: true,
                interactiveBorder: 10,
                theme: 'light-border',
                placement: 'right',
                popperOptions: {
                  modifiers: [
                  {
                    name: 'flip',
                    options: {
                      flipVariations: false, // true by default
                      allowedAutoPlacements: ['right'],
                      fallbackPlacements: ['right', 'top', 'top-start', 'top-end', 'bottom', 'bottom-start', 'bottom-end', 'left'],
                    },
                  },
                  {
                    name: 'preventOverflow',
                    options: {
                      mainAxis: false,
                      altAxis: false
                    }
                  }
                  ]        
                }      
              };
              window.tippy(annoteTarget, config); 
            }
        const findCites = (el) => {
          const parentEl = el.parentElement;
          if (parentEl) {
            const cites = parentEl.dataset.cites;
            if (cites) {
              return {
                el,
                cites: cites.split(' ')
              };
            } else {
              return findCites(el.parentElement)
            }
          } else {
            return undefined;
          }
        };
        var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
        for (var i=0; i<bibliorefs.length; i++) {
          const ref = bibliorefs[i];
          const citeInfo = findCites(ref);
          if (citeInfo) {
            tippyHover(citeInfo.el, function() {
              var popup = window.document.createElement('div');
              citeInfo.cites.forEach(function(cite) {
                var citeDiv = window.document.createElement('div');
                citeDiv.classList.add('hanging-indent');
                citeDiv.classList.add('csl-entry');
                var biblioDiv = window.document.getElementById('ref-' + cite);
                if (biblioDiv) {
                  citeDiv.innerHTML = biblioDiv.innerHTML;
                }
                popup.appendChild(citeDiv);
              });
              return popup.innerHTML;
            });
          }
        }
      });
      </script><script type="text/javascript">
        (function(d) {
          d.querySelectorAll(".pseudocode-container").forEach(function(el) {
            let pseudocodeOptions = {
              indentSize: el.dataset.indentSize || "1.2em",
              commentDelimiter: el.dataset.commentDelimiter || "//",
              lineNumber: el.dataset.lineNumber === "true" ? true : false,
              lineNumberPunc: el.dataset.lineNumberPunc || ":",
              noEnd: el.dataset.noEnd === "true" ? true : false,
              titlePrefix: el.dataset.captionPrefix || "Algorithm"
            };
            pseudocode.renderElement(el.querySelector(".pseudocode"), pseudocodeOptions);
          });
        })(document);
        (function(d) {
          d.querySelectorAll(".pseudocode-container").forEach(function(el) {
            let captionSpan = el.querySelector(".ps-root > .ps-algorithm > .ps-line > .ps-keyword")
            if (captionSpan !== null) {
              let captionPrefix = el.dataset.captionPrefix + " ";
              let captionNumber = "";
              if (el.dataset.pseudocodeNumber) {
                captionNumber = el.dataset.pseudocodeNumber + " ";
                if (el.dataset.chapterLevel) {
                  captionNumber = el.dataset.chapterLevel + "." + captionNumber;
                }
              }
              captionSpan.innerHTML = captionPrefix + captionNumber;
            }
          });
        })(document);
        </script>


</body></html>